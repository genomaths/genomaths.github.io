<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Estimate cutpoints to distinguish the treatment methylation...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="/media/sf_D/<a href='https://genomaths.github.io/MethylIT_HTML_Manual/MethylIT_Manual.html'>MethylIT</a>_HTML_Manual/R.css" />
</head><body>

<table width="100%" summary="page for estimateCutPoint {<a href='https://genomaths.github.io/MethylIT_HTML_Manual/MethylIT_Manual.html'>MethylIT</a>}"><tr><td>estimateCutPoint {<a href='https://genomaths.github.io/MethylIT_HTML_Manual/MethylIT_Manual.html'>MethylIT</a>}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Estimate cutpoints to distinguish the treatment methylation signal
from the control</h2>

<h3>Description</h3>

<p>Given a list of two GRanges objects, control and treatment,
carrying the potential signals (prior classification) from controls and
treatments in terms of an information divergence
(given the metacolumns), the function estimates the cutpoints of the
control group versus treatment group.
</p>


<h3>Usage</h3>

<pre>
estimateCutPoint(LR, control.names, treatment.names, simple = TRUE,
  column = c(hdiv = TRUE, TV = TRUE, bay.TV = FALSE, wprob = TRUE, pos =
  TRUE), classifier1 = c("logistic", "pca.logistic", "lda", "qda",
  "pca.lda", "pca.qda"), classifier2 = NULL, tv.cut = 0.25,
  div.col = NULL, clas.perf = FALSE, post.cut = 0.5, prop = 0.6,
  n.pc = 1, interaction = NULL, cut.values = NULL, stat = 1,
  num.cores = 1L, tasks = 0L, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>LR</code></td>
<td>
<p>An object from 'pDMP' class. This object is previously obtained
with function <code>getPotentialDIMP</code>.</p>
</td></tr>
<tr valign="top"><td><code>control.names, treatment.names</code></td>
<td>
<p>Names/IDs of the control and
treatment samples, which must be include in the variable LR.</p>
</td></tr>
<tr valign="top"><td><code>simple</code></td>
<td>
<p>Logic (default, TRUE). If TRUE, then Youden Index is used to
estimate the cutpoint. If FALSE, the minimum information divergence value
with posterior classification probability greater than <em>post.cut</em>
(usually <em>post.cut</em> = 0.5) as estimated by <em>classifier1</em> will
be the reported cutpoint, except if a better cutpoint is found in the set
of values provided by the user in the parameter <em>cut.values</em>.</p>
</td></tr>
<tr valign="top"><td><code>column</code></td>
<td>
<p>a logical vector for column names for the predictor variables
to be used: Hellinger divergence &quot;hdiv&quot;, total variation &quot;TV&quot;,
probability of potential DMP &quot;wprob&quot;, and the relative cytosine site
position &quot;pos&quot; in respect to the chromosome where it is located. The
relative position is estimated as (x - x.min)/(x.max - x), where x.min
and x.max are the maximum and minimum for the corresponding chromosome,
repectively. If &quot;wprob = TRUE&quot;, then Logarithm base-10 of &quot;wprob&quot; will
be used as predictor in place of &quot;wprob&quot;.</p>
</td></tr>
<tr valign="top"><td><code>classifier1, classifier2</code></td>
<td>
<p>Classification model to use. Option &quot;logistic&quot;
applies a logistic regression model; option &quot;lda&quot; applies a Linear
Discriminant Analysis (LDA); &quot;qda&quot; applies a Quadratic Discriminant
Analysis (QDA), &quot;pca.logistic&quot; applies logistic regression model using
the Principal Component (PCs) estimated with Principal Component Analysis
(PCA) as predictor variables. pca.lda&quot; applies LDA using PCs as predictor
variables, and the option &quot;pca.qda&quot; applies a Quadratic Discriminant
Analysis (QDA) using PCs as predictor variables. If classifier2 is not
NULL, then it will be used to evaluate the classification performance,
and the corresponding best fitted model will be returned.</p>
</td></tr>
<tr valign="top"><td><code>tv.cut</code></td>
<td>
<p>A cutoff for the total variation distance to be applied to each
site/range. Only sites/ranges <em>k</em> with <i>TVD_{k} &gt; tv.cut</i> are
are used in the analysis. Its value must be a number.
<i>0 &lt; tv.cut &lt; 1</i>. Default is <i>tv.cut = 0.25</i>.</p>
</td></tr>
<tr valign="top"><td><code>div.col</code></td>
<td>
<p>Column number for divergence variable for which the estimation
of the cutpoint will be performed.</p>
</td></tr>
<tr valign="top"><td><code>clas.perf</code></td>
<td>
<p>Logic. Whether to evaluate the classification performance
for the estimated cutpoint using a model classifier when 'simple=TRUE'.
Default, FALSE.</p>
</td></tr>
<tr valign="top"><td><code>post.cut</code></td>
<td>
<p>If 'simple=FALSE', this is posterior probability to dicide
whether a DMPs belong to treatment group. Default <em>post.cut</em> = 0.5.</p>
</td></tr>
<tr valign="top"><td><code>prop</code></td>
<td>
<p>Proportion to split the dataset used in the logistic regression:
group versus divergence (at DMPs) into two subsets, training and
testing.</p>
</td></tr>
<tr valign="top"><td><code>n.pc</code></td>
<td>
<p>Number of principal components (PCs) to use if the classifier is
not 'logistic'. In the current case, the maximun number of PCs is 4.</p>
</td></tr>
<tr valign="top"><td><code>interaction</code></td>
<td>
<p>If a logistic classifier is used. Variable interactions to
consider in a logistic regression model. Any pairwise combination of the
variable &quot;hdiv&quot;, &quot;TV&quot;, &quot;wprob&quot;, and &quot;pos&quot; can be provided. For example:
&quot;hdiv:TV&quot;, &quot;wprob:pos&quot;, &quot;wprob:TV&quot;, etc.</p>
</td></tr>
<tr valign="top"><td><code>cut.values</code></td>
<td>
<p>Cut values of the information divergence (ID) specified  in
<em>div.col</em> where to check the classification performance
(0 &lt; <em>cut.interval</em> &lt; max ID). If provided, the search for a
cutpoint will include these values.</p>
</td></tr>
<tr valign="top"><td><code>stat</code></td>
<td>
<p>An integer number indicating the statistic to be used in the
testing when <em>simple</em> = FALSE The mapping for statistic names are:
</p>

<ul>
<li><p> 0 = &quot;Accuracy&quot;
</p>
</li>
<li><p> 1 = &quot;Sensitivity&quot;
</p>
</li>
<li><p> 2 = &quot;Specificity&quot;
</p>
</li>
<li><p> 3 = &quot;Pos Pred Value&quot;
</p>
</li>
<li><p> 4 = &quot;Neg Pred Value&quot;
</p>
</li>
<li><p> 5 = &quot;Precision&quot;
</p>
</li>
<li><p> 6 = &quot;Recall&quot;
</p>
</li>
<li><p> 7 = &quot;F1&quot;
</p>
</li>
<li><p> 8 = &quot;Prevalence&quot;
</p>
</li>
<li><p> 9 = &quot;Detection Rate&quot;
</p>
</li>
<li><p> 10 = &quot;Detection Prevalence&quot;
</p>
</li>
<li><p> 11 = &quot;Balanced Accuracy&quot;
</p>
</li>
<li><p> 12 = FDR
</p>
</li></ul>
</td></tr>
<tr valign="top"><td><code>num.cores, tasks</code></td>
<td>
<p>Paramaters for parallele computation using package
<code>BiocParallel-package</code>: the number of cores to
use, i.e. at most how many child processes will be run simultaneously
(see <code>bplapply</code> and the number of tasks per job
(only for Linux OS).</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function performs an estimation of the optimal cutpoint for the
classification of the differentially methylated (cytosines) positions
into two classes: DMPs from control and DMPs from treatment. The simplest
approach to estimate the cutpoint  is based on the application of Youden
Index. More complexes approach based in several machine learning model
are provided as well.
</p>
<p>Results of the classification performance resulting from the estimated
cutpoint are normally given, with the exception of those extreme
situations where the statistics to evaluate performance cannot be
estimated. More than one classifier model can be applied. For example,
one classifier (logistic model) can be used to estimate the posterior
classification probabilities of DMP into those from control and those
from treatment. These probabilities are then used to estimate the
cutpoint in range of values from, say, 0.5 to 0.8. Next, a different
classifier can be used to evaluate the classification performance.
Different classifier models would yield different performances. Models
are returned and can be used in further prediction with new datasets from
the same batch experiment. This is a machine learning approach to
discriminate the biological regulatory signal naturally generated in the
control from that one induced by the treatment.
</p>


<h3>Value</h3>

<p>Depending the parameter setting will return the following list with
elements:
</p>

<ol>
<li><p> cutpoint: Cutpoint estimated.
</p>
</li>
<li><p> testSetPerformance: Performance evaluation on the test set.
</p>
</li>
<li><p> testSetModel.FDR: False discovery rate on the test set.
</p>
</li>
<li><p> model: Model used in the performance evaluation.
</p>
</li>
<li><p> modelConfMatrix: Confusion matrix for the whole dataset derived
applying the model classifier used in the performance
evaluation.
</p>
</li>
<li><p> initModel: Initial classifier model applied to estimate
posterior classifications used in the cutpoint estimation.
</p>
</li>
<li><p> postProbCut: Posterior probability used to estimate the
cutpoint
</p>
</li>
<li><p> classifier: Name of the model classifier used in the
performance evaluation.
</p>
</li>
<li><p> statistic: Name of the performance statistic used to find the
cutpoint when <em>simple</em> =  FALSE
</p>
</li>
<li><p> optStatVal: Value of the performance statistic at the cutpoint.
</p>
</li></ol>



<h3>See Also</h3>

<p><code>evaluateDIMPclass</code>
</p>


<h3>Examples</h3>

<pre>
## Get a dataset of potential signals and the estimated cutpoint from the
## package and performs cutpoint estimation
data(PS, package = "<a href='https://genomaths.github.io/MethylIT_HTML_Manual/MethylIT_Manual.html'>MethylIT</a>")
cutpoint = estimateCutPoint(LR = PS, simple = FALSE,
                            column = c(hdiv = TRUE, TV = TRUE,
                                        wprob = TRUE, pos = TRUE),
                            classifier1 = "qda",
                            control.names = c("C1", "C2", "C3"),
                            treatment.names = c("T1", "T2", "T3"),
                            tv.cut = 0.92, clas.perf = TRUE, prop = 0.6,
                            div.col = 9L)
</pre>

<hr /><div style="text-align: center;">[Package <em><a href='https://genomaths.github.io/MethylIT_HTML_Manual/MethylIT_Manual.html'>MethylIT</a></em> version 0.3.1 ]</div>
</body></html>
