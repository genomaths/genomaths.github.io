<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fisher's exact test failure can lead to biased results • usefr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Fisher's exact test failure can lead to biased results">
<meta property="og:description" content="usefr">
<meta property="og:image" content="https://genomaths.github.io/usefr/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">usefr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/usefr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Package functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/usefr.html">usefr</a>
    </li>
    <li class="divider">
    </li>
<li>
      <a href="../articles/Nonlinear_Fit_of_Mixture_Distributions.html">Nonlinear Fit of Mixture Distributions</a>
    </li>
    <li class="divider">
    </li>
<li>
      <a href="../articles/fisher-exact-test-failure-can-lead-to-biassed-results.html">Fisher's exact test failure can lead to biased results</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/genomaths/usefr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Fisher’s exact test failure can lead to biased
results</h1>
                        <h4 data-toc-skip class="author">Robersy
Sanchez</h4>
            <address class="author_afil">
      Department of Biology. Pennsylvania State University, University
Park, PA 16802<br><a class="author_email" href="mailto:#"></a><a href="mailto:rus547@psu.edu" class="email">rus547@psu.edu</a>
      </address>
                  
            <h4 data-toc-skip class="date">12 February 2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/genomaths/usefr/blob/HEAD/vignettes/fisher-exact-test-failure-can-lead-to-biassed-results.Rmd" class="external-link"><code>vignettes/fisher-exact-test-failure-can-lead-to-biassed-results.Rmd</code></a></small>
      <div class="hidden name"><code>fisher-exact-test-failure-can-lead-to-biassed-results.Rmd</code></div>

    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>Fisher’s exact test is a statistical significance test used in
      the analysis of contingency tables. Although this test is
      routinely used even though, it has been full of with controversy
      for over 80 years.Herein, the case of its application analyzed is
      scrutinized with specific examples.</p>
    </div>
    
<div class="section level2">
<h2 id="overwiew">Overwiew<a class="anchor" aria-label="anchor" href="#overwiew"></a>
</h2>
<p>The statistical significance of the difference between two bisulfite
sequence from control and treatment groups at each CG site can be
evaluated with Fisher’s exact test. This is a statistical test used to
determine if there are nonrandom associations between two categorical
variables.</p>
<p>Let there exist two such (categorical) variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, where <span class="math inline">\(X\)</span> stands for two groups of individuals:
control and treatment, and <span class="math inline">\(Y\)</span> be a
two states variable denoting the methylation status, carrying the number
of times that a cytosine site is found methylated (<span class="math inline">\(^{m}CG\)</span>) and non-methylated (<span class="math inline">\(CG\)</span>), respectively.</p>
<p>This information can be summarized in a <span class="math inline">\(2
\times 2\)</span> table, a <span class="math inline">\(2 \times
2\)</span> matrix in which the entries <span class="math inline">\(a_{ij}\)</span> represent the number of
observations in which <span class="math inline">\(x=i\)</span> and <span class="math inline">\(y=j\)</span>. Calculate the row and column sums
<span class="math inline">\(R_i\)</span> and <span class="math inline">\(C_j\)</span>, respectively, and the total sum:</p>
<p><span class="math display">\[N=\sum_iR_i=\sum_jC_j\]</span><br>
of the matrix:</p>
<table class="table">
<colgroup>
<col width="16%">
<col width="27%">
<col width="27%">
<col width="27%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left"><span class="math inline">\(Y = ^mCG\)</span></th>
<th align="left"><span class="math inline">\(Y = CG\)</span></th>
<th align="left"><span class="math inline">\(R_i\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Control</td>
<td align="left"><span class="math inline">\(a_{11}\)</span></td>
<td align="left"><span class="math inline">\(a_12\)</span></td>
<td align="left"><span class="math inline">\(a_{11}+a_{12}\)</span></td>
</tr>
<tr class="even">
<td align="left">Treatment</td>
<td align="left"><span class="math inline">\(a_{21}\)</span></td>
<td align="left"><span class="math inline">\(a_22\)</span></td>
<td align="left"><span class="math inline">\(a_{21}+a_{22}\)</span></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(C_i\)</span></td>
<td align="left"><span class="math inline">\(a_{11}+a_{21}\)</span></td>
<td align="left"><span class="math inline">\(a_{12}+a_{22}\)</span></td>
<td align="left"><span class="math inline">\(a_{11}+a_{12}+a_{21}+a_{22}
= N\)</span></td>
</tr>
</tbody>
</table>
<p>Then the conditional probability of getting the actual matrix, given
the particular row and column sums, is given by the formula:</p>
<p><span class="math display">\[P_{cutoff}=\frac{R_1!R_2!}{N!\prod_{i,j}a_{ij}!}C_1!C_2!\]</span></p>
</div>
<div class="section level2">
<h2 id="example-1">Example 1<a class="anchor" aria-label="anchor" href="#example-1"></a>
</h2>
<p>Let’s consider the following hypthetical case of methylation at a
given cytosine site found in the comparison of control and treatment
groups:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">case1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">12</span><span class="op">)</span>,  nrow <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                     dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ctrl"</span>, <span class="st">"Treat"</span><span class="op">)</span>,</span>
<span>                                     Meth.status <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mCG"</span>, <span class="st">"CG"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">case1</span></span></code></pre></div>
<pre><code><span><span class="co">##        Meth.status</span></span>
<span><span class="co">## Group   mCG CG</span></span>
<span><span class="co">##   Ctrl    5 15</span></span>
<span><span class="co">##   Treat  14 12</span></span></code></pre>
<p>That is, the cytosine site was found methylated 5 times from 20
counts in the control group and 14 out of 26 in the treatment. This
accounts for methylation levels about 0.28 and 0.53 in the control and
and the treatment groups, respectively, which correspond to a value of
0.25 (50%) of methylation levels difference.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Proportions</span></span>
<span><span class="va">case1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">case1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        Meth.status</span></span>
<span><span class="co">## Group         mCG        CG</span></span>
<span><span class="co">##   Ctrl  0.2500000 0.7500000</span></span>
<span><span class="co">##   Treat 0.5384615 0.4615385</span></span></code></pre>
<p>Fisher’s exact test found not difference between these group!</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test</a></span><span class="op">(</span><span class="va">case1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Fisher's Exact Test for Count Data</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  case1</span></span>
<span><span class="co">## p-value = 0.07158</span></span>
<span><span class="co">## alternative hypothesis: true odds ratio is not equal to 1</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  0.06352714 1.18168682</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## odds ratio </span></span>
<span><span class="co">##   0.293905</span></span></code></pre>
<p>Considering the direction of the changes seems to be more sensitive
to the magnitude of methylation changes, statistically significant at a
significance level of <span class="math inline">\(\alpha =
0.05\)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test</a></span><span class="op">(</span><span class="va">case1</span>, alternative <span class="op">=</span> <span class="st">"less"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Fisher's Exact Test for Count Data</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  case1</span></span>
<span><span class="co">## p-value = 0.04666</span></span>
<span><span class="co">## alternative hypothesis: true odds ratio is less than 1</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  0.0000000 0.9804613</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## odds ratio </span></span>
<span><span class="co">##   0.293905</span></span></code></pre>
<p>To realize how difficult would be the interpretation of this result
in a real concrete scenario, let’s consider a basketball team where a
top player finished a game scoring 14 field-goal out of 26 shooting.
Base on Fisher’s exact test, does it make sense to say that another
player who made 6 out of 15 field-goals performed as well as the best
player?</p>
<div class="section level4">
<h4 id="bootstraps-tests-for-2-times-2">Bootstrap’s tests for <span class="math inline">\(2 \times
2\)</span><a class="anchor" aria-label="anchor" href="#bootstraps-tests-for-2-times-2"></a>
</h4>
<p>Alternative testings are possible by means of bootstrap re-sampling
from the set (population) of all the matrices with the same row and
column sums <span class="math inline">\(R_i\)</span> and <span class="math inline">\(C_j\)</span>. The analyses will be accomplished
with function <a href="https://rdrr.io/github/genomaths/usefr/man/tableBoots.html" class="external-link">tableBoots</a>
from the R packge named <a href="https://github.com/genomaths/usefr" class="external-link">usefr</a>.</p>
<p>Hellinger test statistic has been proposed to compare discrete
probability distributions (<a href="#id_1">1</a>). Basu et all have
shown that the Hellinger divergence, as reported in <a href="#id_1">1</a>, has asymptotically has a chi-square distribution
with one degree of freedom under the null hypothesis. This a good
property that makes this statistic Hellinger statistic suitable for
bootstrap’s test of two discrete populations.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/genomaths/usefr" class="external-link">usefr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/tableBoots.html">tableBoots</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">case1</span>, stat <span class="op">=</span> <span class="st">"hd"</span>, num.permut <span class="op">=</span> <span class="fl">1999</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.0435</span></span></code></pre>
<p>The Root-Mean-Square statistic has been also proposed to test
differences between two discrete probability distributions (<a href="#id_2">2</a>)</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/genomaths/usefr" class="external-link">usefr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/tableBoots.html">tableBoots</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">case1</span>, stat <span class="op">=</span> <span class="st">"rmst"</span>, num.permut <span class="op">=</span> <span class="fl">1999</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.0375</span></span></code></pre>
<p>The <span class="math inline">\(\chi^2\)</span> statistic fails</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/genomaths/usefr" class="external-link">usefr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/tableBoots.html">tableBoots</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">case1</span>, stat <span class="op">=</span> <span class="st">"chisq"</span>, num.permut <span class="op">=</span> <span class="fl">1999</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.0525</span></span></code></pre>
<p>Assuming that expected discrete probability distribution (DPD)
are:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">case1</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">case1</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<pre><code><span><span class="co">##  mCG   CG </span></span>
<span><span class="co">## 0.25 0.75</span></span></code></pre>
<p>Then, we can test whether the treatment departs from the expected
DPD:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">chisq.test</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">case1</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span>, p <span class="op">=</span> <span class="va">p</span>, </span>
<span>           simulate.p.value <span class="op">=</span> <span class="cn">TRUE</span>, B <span class="op">=</span> <span class="fl">2e3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Chi-squared test for given probabilities with simulated p-value (based</span></span>
<span><span class="co">##  on 2000 replicates)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  case1[2, ]</span></span>
<span><span class="co">## X-squared = 11.538, df = NA, p-value = 0.0009995</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="the-example-1-is-not-unique">The example 1 is not unique<a class="anchor" aria-label="anchor" href="#the-example-1-is-not-unique"></a>
</h3>
<p>The failure of Fisher’s exact test is evident in the comparisons
given below:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">78</span>,<span class="fl">1</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="va">k</span><span class="op">+</span><span class="fl">1</span>, <span class="fl">15</span>, <span class="va">k</span><span class="op">)</span>,  nrow <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                    dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ctrl"</span>, <span class="st">"Treat"</span><span class="op">)</span>,</span>
<span>                                    Meth.status <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mCG"</span>, <span class="st">"CG"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">datos</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">datos</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">datos</span><span class="op">)</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="va">ft</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test</a></span><span class="op">(</span><span class="va">datos</span><span class="op">)</span></span>
<span>    <span class="va">hd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tableBoots.html">tableBoots</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">datos</span>, stat <span class="op">=</span> <span class="st">"hd"</span>, num.permut <span class="op">=</span> <span class="fl">1999</span><span class="op">)</span></span>
<span>    <span class="va">rmst</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tableBoots.html">tableBoots</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">datos</span>, stat <span class="op">=</span> <span class="st">"rmst"</span>, num.permut <span class="op">=</span> <span class="fl">1999</span><span class="op">)</span></span>
<span>    <span class="va">chisq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tableBoots.html">tableBoots</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">datos</span>, stat <span class="op">=</span> <span class="st">"chisq"</span>, num.permut <span class="op">=</span> <span class="fl">1999</span><span class="op">)</span></span>
<span></span>
<span>    </span>
<span>    <span class="va">chisq.p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">chisq.test</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">datos</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span>, p <span class="op">=</span> <span class="va">datos</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">datos</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span>, </span>
<span>                        simulate.p.value <span class="op">=</span> <span class="cn">TRUE</span>, B <span class="op">=</span> <span class="fl">2e3</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>meth.diff <span class="op">=</span> <span class="va">x</span>, </span>
<span>      FT.p.value <span class="op">=</span> <span class="va">ft</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      HD.p.value <span class="op">=</span> <span class="va">hd</span>,</span>
<span>      RMST <span class="op">=</span> <span class="va">rmst</span>,</span>
<span>      chisq <span class="op">=</span> <span class="va">chisq</span>,</span>
<span>      chisq.p <span class="op">=</span> <span class="va">chisq.p</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">res</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       meth.diff FT.p.value HD.p.value   RMST  chisq      chisq.p</span></span>
<span><span class="co">##  [1,] 0.4166667 0.20948617     0.0705 0.1175 0.1280 0.1634182909</span></span>
<span><span class="co">##  [2,] 0.3500000 0.28326746     0.1165 0.1055 0.1370 0.0919540230</span></span>
<span><span class="co">##  [3,] 0.3214286 0.17506841     0.1115 0.1010 0.1265 0.0739630185</span></span>
<span><span class="co">##  [4,] 0.3055556 0.20467538     0.1155 0.0955 0.1090 0.0589705147</span></span>
<span><span class="co">##  [5,] 0.2954545 0.13181103     0.1090 0.0950 0.1010 0.0394802599</span></span>
<span><span class="co">##  [6,] 0.2884615 0.14213458     0.1100 0.0880 0.0890 0.0234882559</span></span>
<span><span class="co">##  [7,] 0.2833333 0.15672314     0.0880 0.0790 0.0885 0.0194902549</span></span>
<span><span class="co">##  [8,] 0.2794118 0.10138414     0.0940 0.0700 0.0795 0.0134932534</span></span>
<span><span class="co">##  [9,] 0.2763158 0.10534027     0.0780 0.0615 0.0910 0.0064967516</span></span>
<span><span class="co">## [10,] 0.2738095 0.11089814     0.0670 0.0575 0.0815 0.0109945027</span></span>
<span><span class="co">## [11,] 0.2717391 0.11750154     0.0680 0.0695 0.0690 0.0049975012</span></span>
<span><span class="co">## [12,] 0.2700000 0.07769381     0.0685 0.0660 0.0635 0.0059970015</span></span>
<span><span class="co">## [13,] 0.2685185 0.07887317     0.0600 0.0590 0.0660 0.0014992504</span></span>
<span><span class="co">## [14,] 0.2672414 0.08061039     0.0605 0.0585 0.0595 0.0014992504</span></span>
<span><span class="co">## [15,] 0.2661290 0.08276810     0.0575 0.0580 0.0625 0.0009995002</span></span>
<span><span class="co">## [16,] 0.2651515 0.08523730     0.0555 0.0545 0.0480 0.0014992504</span></span>
<span><span class="co">## [17,] 0.2642857 0.08793188     0.0580 0.0570 0.0570 0.0019990005</span></span>
<span><span class="co">## [18,] 0.2635135 0.09078398     0.0490 0.0565 0.0600 0.0004997501</span></span>
<span><span class="co">## [19,] 0.2628205 0.09374027     0.0475 0.0445 0.0490 0.0009995002</span></span>
<span><span class="co">## [20,] 0.2621951 0.06031279     0.0540 0.0540 0.0595 0.0009995002</span></span>
<span><span class="co">## [21,] 0.2616279 0.06080833     0.0575 0.0500 0.0530 0.0004997501</span></span>
<span><span class="co">## [22,] 0.2611111 0.06141565     0.0430 0.0510 0.0470 0.0004997501</span></span>
<span><span class="co">## [23,] 0.2606383 0.06211375     0.0485 0.0470 0.0480 0.0004997501</span></span>
<span><span class="co">## [24,] 0.2602041 0.06288506     0.0480 0.0415 0.0455 0.0004997501</span></span>
<span><span class="co">## [25,] 0.2598039 0.06371480     0.0460 0.0520 0.0420 0.0004997501</span></span>
<span><span class="co">## [26,] 0.2594340 0.06459058     0.0395 0.0485 0.0515 0.0004997501</span></span>
<span><span class="co">## [27,] 0.2590909 0.06550200     0.0490 0.0495 0.0525 0.0004997501</span></span>
<span><span class="co">## [28,] 0.2587719 0.06644033     0.0530 0.0415 0.0480 0.0004997501</span></span>
<span><span class="co">## [29,] 0.2584746 0.06739822     0.0430 0.0445 0.0410 0.0004997501</span></span>
<span><span class="co">## [30,] 0.2581967 0.06836952     0.0380 0.0395 0.0535 0.0004997501</span></span>
<span><span class="co">## [31,] 0.2579365 0.06934906     0.0470 0.0435 0.0405 0.0004997501</span></span>
<span><span class="co">## [32,] 0.2576923 0.07033254     0.0360 0.0440 0.0485 0.0004997501</span></span>
<span><span class="co">## [33,] 0.2574627 0.07131633     0.0445 0.0445 0.0420 0.0004997501</span></span>
<span><span class="co">## [34,] 0.2572464 0.07229742     0.0375 0.0445 0.0420 0.0004997501</span></span>
<span><span class="co">## [35,] 0.2570423 0.04633836     0.0335 0.0440 0.0430 0.0004997501</span></span>
<span><span class="co">## [36,] 0.2568493 0.04646593     0.0375 0.0355 0.0445 0.0004997501</span></span>
<span><span class="co">## [37,] 0.2566667 0.04660925     0.0435 0.0390 0.0390 0.0004997501</span></span>
<span><span class="co">## [38,] 0.2564935 0.04676622     0.0380 0.0360 0.0430 0.0004997501</span></span>
<span><span class="co">## [39,] 0.2563291 0.04693498     0.0340 0.0415 0.0370 0.0004997501</span></span>
<span><span class="co">## [40,] 0.2561728 0.04711391     0.0410 0.0415 0.0410 0.0004997501</span></span>
<span><span class="co">## [41,] 0.2560241 0.04730155     0.0365 0.0400 0.0420 0.0004997501</span></span>
<span><span class="co">## [42,] 0.2558824 0.04749662     0.0310 0.0440 0.0380 0.0004997501</span></span>
<span><span class="co">## [43,] 0.2557471 0.04769797     0.0320 0.0320 0.0420 0.0004997501</span></span>
<span><span class="co">## [44,] 0.2556180 0.04790460     0.0350 0.0385 0.0390 0.0004997501</span></span>
<span><span class="co">## [45,] 0.2554945 0.04811561     0.0350 0.0295 0.0420 0.0004997501</span></span>
<span><span class="co">## [46,] 0.2553763 0.04833021     0.0390 0.0310 0.0365 0.0004997501</span></span>
<span><span class="co">## [47,] 0.2552632 0.04854768     0.0345 0.0395 0.0400 0.0004997501</span></span>
<span><span class="co">## [48,] 0.2551546 0.04876741     0.0355 0.0325 0.0345 0.0004997501</span></span>
<span><span class="co">## [49,] 0.2550505 0.04898884     0.0365 0.0375 0.0445 0.0004997501</span></span>
<span><span class="co">## [50,] 0.2549505 0.04921147     0.0290 0.0385 0.0350 0.0004997501</span></span>
<span><span class="co">## [51,] 0.2548544 0.04943486     0.0375 0.0395 0.0380 0.0004997501</span></span>
<span><span class="co">## [52,] 0.2547619 0.04965863     0.0430 0.0365 0.0350 0.0004997501</span></span>
<span><span class="co">## [53,] 0.2546729 0.04988242     0.0385 0.0420 0.0410 0.0004997501</span></span>
<span><span class="co">## [54,] 0.2545872 0.05010595     0.0380 0.0345 0.0335 0.0004997501</span></span>
<span><span class="co">## [55,] 0.2545045 0.05032893     0.0460 0.0435 0.0355 0.0004997501</span></span>
<span><span class="co">## [56,] 0.2544248 0.05055114     0.0330 0.0360 0.0320 0.0004997501</span></span>
<span><span class="co">## [57,] 0.2543478 0.05077235     0.0290 0.0380 0.0355 0.0004997501</span></span>
<span><span class="co">## [58,] 0.2542735 0.05099239     0.0300 0.0370 0.0395 0.0004997501</span></span>
<span><span class="co">## [59,] 0.2542017 0.05121109     0.0300 0.0375 0.0390 0.0004997501</span></span>
<span><span class="co">## [60,] 0.2541322 0.05142831     0.0350 0.0295 0.0465 0.0004997501</span></span>
<span><span class="co">## [61,] 0.2540650 0.05164393     0.0390 0.0335 0.0385 0.0004997501</span></span>
<span><span class="co">## [62,] 0.2540000 0.05185784     0.0365 0.0315 0.0360 0.0004997501</span></span>
<span><span class="co">## [63,] 0.2539370 0.05206995     0.0335 0.0370 0.0310 0.0004997501</span></span>
<span><span class="co">## [64,] 0.2538760 0.05228018     0.0365 0.0335 0.0365 0.0004997501</span></span>
<span><span class="co">## [65,] 0.2538168 0.05248845     0.0280 0.0380 0.0375 0.0004997501</span></span>
<span><span class="co">## [66,] 0.2537594 0.05269472     0.0350 0.0345 0.0390 0.0004997501</span></span>
<span><span class="co">## [67,] 0.2537037 0.05289893     0.0340 0.0355 0.0315 0.0004997501</span></span>
<span><span class="co">## [68,] 0.2536496 0.05310105     0.0305 0.0280 0.0335 0.0004997501</span></span>
<span><span class="co">## [69,] 0.2535971 0.05330104     0.0345 0.0310 0.0385 0.0004997501</span></span>
<span><span class="co">## [70,] 0.2535461 0.05349888     0.0355 0.0300 0.0335 0.0004997501</span></span>
<span><span class="co">## [71,] 0.2534965 0.05369454     0.0390 0.0335 0.0335 0.0004997501</span></span>
<span><span class="co">## [72,] 0.2534483 0.05388802     0.0335 0.0310 0.0280 0.0004997501</span></span>
<span><span class="co">## [73,] 0.2534014 0.05407930     0.0310 0.0300 0.0325 0.0004997501</span></span>
<span><span class="co">## [74,] 0.2533557 0.05426839     0.0255 0.0285 0.0275 0.0004997501</span></span>
<span><span class="co">## [75,] 0.2533113 0.05445527     0.0300 0.0395 0.0310 0.0004997501</span></span>
<span><span class="co">## [76,] 0.2532680 0.05463995     0.0310 0.0350 0.0300 0.0004997501</span></span>
<span><span class="co">## [77,] 0.2532258 0.05482244     0.0315 0.0285 0.0355 0.0004997501</span></span>
<span><span class="co">## [78,] 0.2531847 0.03529458     0.0320 0.0360 0.0355 0.0004997501</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="extreme-situations-found-in-methylation-data-sets">Extreme situations found in methylation data sets<a class="anchor" aria-label="anchor" href="#extreme-situations-found-in-methylation-data-sets"></a>
</h2>
<p>Unfortunate situations like that one shown below are not rare in
methylation data. The minimum coverage (total counts) in the example
below is 5.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">case2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">90</span>, <span class="fl">2</span>, <span class="fl">10</span><span class="op">)</span>,  nrow <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                     dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ctrl"</span>, <span class="st">"Treat"</span><span class="op">)</span>,</span>
<span>                                     Meth.status <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mCG"</span>, <span class="st">"CG"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">case2</span></span></code></pre></div>
<pre><code><span><span class="co">##        Meth.status</span></span>
<span><span class="co">## Group   mCG CG</span></span>
<span><span class="co">##   Ctrl    3  2</span></span>
<span><span class="co">##   Treat  90 10</span></span></code></pre>
<p>The small numbers of count in the control sample yields a bias
estimation of the methylation level:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Proportions</span></span>
<span><span class="va">case2</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">case2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        Meth.status</span></span>
<span><span class="co">## Group   mCG  CG</span></span>
<span><span class="co">##   Ctrl  0.6 0.4</span></span>
<span><span class="co">##   Treat 0.9 0.1</span></span></code></pre>
<p>There is not enough experimental data to ensure that 3/(3+2) = 0.6 is
an unbiased estimated value of the methylation levels at the given
cytosine site. Fisher’s exact test is insensitive to this experimental
fact.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test</a></span><span class="op">(</span><span class="va">case2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Fisher's Exact Test for Count Data</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  case2</span></span>
<span><span class="co">## p-value = 0.09893</span></span>
<span><span class="co">## alternative hypothesis: true odds ratio is not equal to 1</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  0.01735485 2.28134136</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## odds ratio </span></span>
<span><span class="co">##  0.1716671</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">st</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tableBoots.html">tableBoots</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">case2</span>, stat <span class="op">=</span> <span class="st">"hd"</span>, num.permut <span class="op">=</span> <span class="fl">1999</span><span class="op">)</span></span>
<span><span class="va">st</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.0355</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ol style="list-style-type: decimal">
<li>
<a name="1"></a> Basu A, Mandal A, Pardo L. Hypothesis testing for
two discrete populations based on the Hellinger distance. Stat Probab
Lett. Elsevier B.V.; 2010;80: 206–214. <a href="doi:10.1016/j.spl.2009.10.008" class="uri">doi:10.1016/j.spl.2009.10.008</a>.</li>
<li>
<a name="2"></a> Perkins W, Tygert M, Ward R. Some deficiencies of
χ2 and classical exact tests of significance. Appl Comput Harmon Anal.
Elsevier Inc.; 2014;36: 361–386. <a href="doi:10.1016/j.acha.2013.06.002" class="uri">doi:10.1016/j.acha.2013.06.002</a>
</li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Robersy Sanchez.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
