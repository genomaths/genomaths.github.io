<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Bootstrap test for Goodness of fit (GoF) — mcgoftest • usefr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Bootstrap test for Goodness of fit (GoF) — mcgoftest"><meta property="og:description" content="To accomplish the nonlinear fit of a probability distribution
function (PDF), different optimization algorithms can be used. Each
algorithm will return a different set of estimated parameter values. AIC and
BIC are not useful (in this case) to decide which parameter set of values is
the best. The goodness-of-fit tests (GOF) can help in this case.
Please, see below the examples on how to use this function."><meta property="og:image" content="https://genomaths.github.io/usefr/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">usefr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/usefr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Package functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/usefr.html">usefr</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/Nonlinear_Fit_of_Mixture_Distributions.html">Nonlinear Fit of Mixture Distributions</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/fisher-exact-test-failure-can-lead-to-biassed-results.html">Fisher's exact test failure can lead to biased results</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/genomaths/usefr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bootstrap test for Goodness of fit (GoF)</h1>
    <small class="dont-index">Source: <a href="https://github.com/genomaths/usefr/blob/HEAD/R/mcgoftest.R" class="external-link"><code>R/mcgoftest.R</code></a></small>
    <div class="hidden name"><code>mcgoftest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>To accomplish the nonlinear fit of a probability distribution
function <em>(PDF)</em>, different optimization algorithms can be used. Each
algorithm will return a different set of estimated parameter values. AIC and
BIC are not useful (in this case) to decide which parameter set of values is
the best. The goodness-of-fit tests <em>(GOF)</em> can help in this case.
Please, see below the examples on how to use this function.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mcgoftest</span><span class="op">(</span><span class="va">varobj</span>, <span class="va">model</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for numeric_OR_matrix,missing</span></span>
<span><span class="fu">mcgoftest</span><span class="op">(</span></span>
<span>  <span class="va">varobj</span>,</span>
<span>  model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  distr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  num.sampl <span class="op">=</span> <span class="fl">999</span>,</span>
<span>  sample.size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ks"</span>, <span class="st">"ad"</span>, <span class="st">"sw"</span>, <span class="st">"rmse"</span>, <span class="st">"chisq"</span>, <span class="st">"hd"</span><span class="op">)</span>,</span>
<span>  min.val <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  breaks <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  par.names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  num.cores <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  tasks <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for numeric,CDFmodel</span></span>
<span><span class="fu">mcgoftest</span><span class="op">(</span></span>
<span>  <span class="va">varobj</span>,</span>
<span>  <span class="va">model</span>,</span>
<span>  num.sampl <span class="op">=</span> <span class="fl">999</span>,</span>
<span>  sample.size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ks"</span>, <span class="st">"ad"</span>, <span class="st">"sw"</span>, <span class="st">"rmse"</span>, <span class="st">"chisq"</span>, <span class="st">"hd"</span><span class="op">)</span>,</span>
<span>  min.val <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  breaks <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  par.names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  num.cores <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  tasks <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for numeric_OR_matrix,CDFmodelList</span></span>
<span><span class="fu">mcgoftest</span><span class="op">(</span></span>
<span>  <span class="va">varobj</span>,</span>
<span>  <span class="va">model</span>,</span>
<span>  num.sampl <span class="op">=</span> <span class="fl">999</span>,</span>
<span>  sample.size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ks"</span>, <span class="st">"ad"</span>, <span class="st">"sw"</span>, <span class="st">"rmse"</span>, <span class="st">"chisq"</span>, <span class="st">"hd"</span><span class="op">)</span>,</span>
<span>  min.val <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  breaks <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  par.names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  num.cores <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  tasks <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for ANY,nls</span></span>
<span><span class="fu">mcgoftest</span><span class="op">(</span></span>
<span>  <span class="va">varobj</span>,</span>
<span>  <span class="va">model</span>,</span>
<span>  num.sampl <span class="op">=</span> <span class="fl">999</span>,</span>
<span>  sample.size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ks"</span>, <span class="st">"ad"</span>, <span class="st">"sw"</span>, <span class="st">"rmse"</span>, <span class="st">"chisq"</span>, <span class="st">"hd"</span><span class="op">)</span>,</span>
<span>  min.val <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  breaks <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  par.names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  num.cores <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  tasks <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for ANY,nlsModel</span></span>
<span><span class="fu">mcgoftest</span><span class="op">(</span></span>
<span>  <span class="va">varobj</span>,</span>
<span>  <span class="va">model</span>,</span>
<span>  num.sampl <span class="op">=</span> <span class="fl">999</span>,</span>
<span>  sample.size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ks"</span>, <span class="st">"ad"</span>, <span class="st">"sw"</span>, <span class="st">"rmse"</span>, <span class="st">"chisq"</span>, <span class="st">"hd"</span><span class="op">)</span>,</span>
<span>  min.val <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  breaks <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  par.names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  num.cores <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  tasks <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for ANY,nls.lm</span></span>
<span><span class="fu">mcgoftest</span><span class="op">(</span></span>
<span>  <span class="va">varobj</span>,</span>
<span>  <span class="va">model</span>,</span>
<span>  <span class="va">distr</span>,</span>
<span>  num.sampl <span class="op">=</span> <span class="fl">999</span>,</span>
<span>  sample.size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ks"</span>, <span class="st">"ad"</span>, <span class="st">"sw"</span>, <span class="st">"rmse"</span>, <span class="st">"chisq"</span>, <span class="st">"hd"</span><span class="op">)</span>,</span>
<span>  min.val <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  breaks <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  par.names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  num.cores <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  tasks <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>varobj</dt>
<dd><p>A a vector containing observations, the variable for which the
CDF parameters was estimated or the discrete absolute frequencies of each
observation category.</p></dd>


<dt>model</dt>
<dd><p>A nonlinear regression model from one of the following classes:
"CDFmodel", "CDFmodelList", "NLM", and "nls.lm".</p></dd>


<dt>distr</dt>
<dd><p>The possible options are:</p><ol><li><p>The name of the cumulative distribution function (CDF).</p></li>
<li><p>A concrete CDF, defined by the user,
         from where to estimate the cumulative probabilities.</p></li>
<li><p>A numerical vector carrying discrete absolute frequencies for the
         same categories provided in <strong><em>varobj</em></strong>.</p></li>
<li><p>NULL value (default). In this cases the Shapiro-Wilk test of
         normality is applied. The jackknife estimator of a parameter of
         Shapiro-Wilk statistic is accomplished.</p></li>
</ol></dd>


<dt>pars</dt>
<dd><p>CDF model parameters. A list of parameters to evaluate the CDF.</p></dd>


<dt>num.sampl</dt>
<dd><p>Number of resamplings.</p></dd>


<dt>sample.size</dt>
<dd><p>Size of the samples used for each sampling.</p></dd>


<dt>stat</dt>
<dd><p>One string denoting the statistic to used in the testing:</p><ol><li><p>"ks": Kolmogorov–Smirnov.</p></li>
<li><p>"ad": Anderson–Darling statistic.</p></li>
<li><p>"sw": Shapiro-Wilk test of normality.</p></li>
<li><p>"chisq: Pearson's Chi-squared.</p></li>
<li><p>"rmse": Root Mean Square of the error.</p></li>
<li><p>"hd": Hellinger Divergence statistics.</p></li>
</ol></dd>


<dt>min.val</dt>
<dd><p>A number denoting the lower bound of the domain where CDF
is defined.</p></dd>


<dt>breaks</dt>
<dd><p>Default is NULL. Basically, the it is same as in function
<code><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></code>. If <em>breaks</em> = NULL, then function
'nclass.FD' (see <code>nclass</code> is applied to estimate
the breaks.</p></dd>


<dt>par.names</dt>
<dd><p>(Optional) The names of the parameters from
<strong><em>distr</em></strong> function. Some distribution functions would require to
provide the names of their parameters.</p></dd>


<dt>seed</dt>
<dd><p>An integer used to set a 'seed' for random number generation.</p></dd>


<dt>num.cores, tasks</dt>
<dd><p>Parameters for parallel computation using package
<code><a href="https://rdrr.io/pkg/BiocParallel/man/BiocParallel-package.html" class="external-link">BiocParallel-package</a></code>: the number of cores to use,
i.e. at most how many child processes will be run simultaneously (see
<code><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></code> and the number of tasks per job (only
for Linux OS).</p></dd>


<dt>verbose</dt>
<dd><p>if verbose, comments and progress bar will be printed.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A numeric vector with the following data:</p>
<p></p>
<ol><li><p>Statistic value.</p></li>
<li><p>mc_p.value: the probability of finding the observed, or more
              extreme, results when the null hypothesis \(H_0\) of a study
              question is true obtained Monte Carlo resampling approach.</p></li>
</ol></div>
    <div id="details">
    <h2>Details</h2>
    <p>The test is intended mostly for continuous distributions. Basically,
given the set of parameter values <strong><em>pars</em></strong> from distribution
<strong><em>distr</em></strong>, <strong><em>num.sampl</em></strong> sets of random samples will
be generated, each one of them with <strong><em>sample.size</em></strong> element. The
selected statistic <strong><em>pars</em></strong> will be computed for each randomly
generated set (<em>b_stats</em>) and for sample <strong><em>varobj</em></strong>
(<em>s_stat</em>). Next, the bootstrap <em>p-value</em> will be computed as:
\(mean(c(s_stat, b_stats) &gt;= s_stat)\).</p>
<p>If both variables, <strong><em>varobj</em></strong> and <strong><em>distr</em></strong>, are
numerical vectors, then <code><a href="tableBoots.html">tableBoots</a></code> function is applied. That
is, the problem is confronted as a \(n x m\) contingency independence test,
since there is no way to prove that two arbitrary sequences of integer
numbers would follow the same probability distribution without provide
additional information/knowledge.</p>
<p>If sampling size is lesser the size of the sample, then the test becomes a
Monte Carlo test. The test is based on the use of measures of goodness of
fit, statistics. The following statistics are available (and some
limitations for their application to continuous variables are given):</p>
<p></p><ul><li><p>Kolmogorov- Smirnov statistic ('ks'). Limitations: sensitive to
              ties [1]. Only the parametric Monte Carlo resampling
              (provided that there is not ties in the data) can be used.</p></li>
<li><p>Anderson–Darling statistic ('ad') [2]. Limitation: by
              construction, it depends on the sample size. So, the size of
              the sampling must be close to the sample size if Monte Carlo
              resampling is used, which could be a limitation if the sample
              size is too large [2]. In particular, could be an issue in some
              genomic applications. It is worth highlighting that, for the
              current application, the Anderson–Darling statistic is not
              standardized as typically done in testing GoF for normal
              distribution with Anderson–Darling test. It is not required
              since, the statistic is not compared with a corresponding
              theoretical value. In addition, since the computation of this
              statistic requires for the data to be put in order [2], it does
              not make sense to perform a permutation test. That is, the
              maximum sampling size is the sample size less 1.</p></li>
<li><p>Shapiro-Wilk statistic ('sw') [5]. A Jackknife resampling is
             applied, instead of a Monte Carlo resampling. Simulation studies
             suggest that Shapiro-Wilk test is the most powerful normality
             test, followed by Anderson-Darling test, Lillie/ors test and
             Kolmogorov-Smirnov test [6]. In this case, a jackknife
             resampling is applied (leave-one-out) and the
             <em><strong>p-value</strong></em> for the mean of Shapiro-Wilk statistic
             is returned.</p></li>
<li><p>Pearson's Chi-squared statistic ('chisq'). Limitation: the
              sample must be discretized (partitioned into bins), which is
              could be a source of bias that leads to the rejection of the
              null hypothesis. Here, the discretization is done using
              function the resources from function
              <code><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></code>.</p></li>
<li><p>Root Mean Square statistic ('rmse'). Limitation: the same
              as 'chisq'.</p></li>
<li><p>Hellinger Divergence statistic ('hd'). Limitation: the same
              as 'chisq'.</p></li>
</ul><p>If the argument <strong><em>distr</em></strong> must be defined in
environment-namespace from any package or the environment defined by the
user. if  \(missing( sample.size )\), then
\(sample.size &lt;- length(varobj) - 1\).</p>
<p>Notice that 'chisq', 'rmse', and 'hd' tests can be applied to testing two
discrete probability distributions as well. However, here,
<strong><em>mcgoftest</em></strong> function is limited to continuous probability
distributions.</p>
<p>Additionally, the only supported n-dimensional probability distribution is
Dirichlet Distribution (<em>Dir</em>). The GOF for Dir is based on the fact
that if a variable \(x = (x_1, x_2, ...x_n)\) follows Dirichlet
Distribution with parameters \(\alpha = \alpha_1, ... , \alpha_n\) (all
positive reals), in short, \(x ~ Dir(\alpha)\), then \(x_i ~
Beta(\alpha_i, \alpha_0 - \alpha_i)\), where Beta(.) stands for the Beta
distribution and \(\alpha_0 = \sum \alpha_i\) (see Detail section,
<code><a href="dirichlet.html">dirichlet</a></code> function, and example 5).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    
<ol><li><p>Feller, W. On the Kolmogorov-Smirnov Limit Theorems for
            Empirical Distributions. Ann. Math. Stat. 19, 177–189 (1948).</p></li>
<li><p>Anderson, T. . &amp; Darling, D. A. A Test Of Goodness Of Fit. J.
            Am. Stat. Assoc. 49, 765–769 (1954).</p></li>
<li><p>Watson, G. S. On Chi-Square Goodness-Of-Fit Tests for
            Continuous Distributions. J. R. Stat. Soc. Ser. B Stat.
            Methodol. 20, 44–72 (1958).</p></li>
<li><p>A. Basu, A. Mandal, L. Pardo, Hypothesis testing for two
            discrete populations based on the Hellinger distance. Stat.
            Probab. Lett. 80, 206–214 (2010).</p></li>
<li><p>Patrick Royston (1982). An extension of Shapiro and Wilk's W
            test for normality to large samples. Applied Statistics, 31,
            115–124. doi: 10.2307/2347973.</p></li>
<li><p>Y. Bee Wah, N. Mohd Razali, Power comparisons of Shapiro-Wilk,
            Kolmogorov-Smirnov, Lilliefors and Anderson-Darling tests.
            J. Stat. Model. Anal. 2, 21–33 (2011).</p></li>
</ol></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Distribution fitting: <code><a href="fitMixDist.html">fitMixDist</a></code>,
    <code><a href="https://rdrr.io/pkg/MASS/man/fitdistr.html" class="external-link">fitdistr</a></code>, <code><a href="fitCDF.html">fitCDF</a></code>, and
    <code><a href="bicopulaGOF.html">bicopulaGOF</a></code>.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Robersy Sanchez (<a href="https://genomaths.com" class="external-link">https://genomaths.com</a>).</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## ======== Example 1 =======</span></span></span>
<span class="r-in"><span><span class="co"># Let us generate a random sample a from a specified Weibull distribution:</span></span></span>
<span class="r-in"><span><span class="co"># Set a seed</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Random sample from Weibull( x | shape = 0.5, scale = 1.2 )</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">rweibull</a></span><span class="op">(</span><span class="fl">10000</span>, shape <span class="op">=</span> <span class="fl">0.5</span>, scale <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># MC KS test accept the null hypothesis that variable x comes</span></span></span>
<span class="r-in"><span><span class="co"># from Weibull(x | shape = 0.5, scale = 1.2), while the standard</span></span></span>
<span class="r-in"><span><span class="co"># Kolmogorov-Smirnov test reject the Null Hypothesis.</span></span></span>
<span class="r-in"><span><span class="fu">mcgoftest</span><span class="op">(</span><span class="va">x</span>,</span></span>
<span class="r-in"><span>    distr <span class="op">=</span> <span class="st">"weibull"</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1.2</span><span class="op">)</span>, num.sampl <span class="op">=</span> <span class="fl">500</span>,</span></span>
<span class="r-in"><span>    sample.size <span class="op">=</span> <span class="fl">1000</span>, num.cores <span class="op">=</span> <span class="fl">4</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Permutation GoF testing based on Kolmogorov-Smirnov statistic ( parametric approach )  ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================================                  |  75%  |                                                                              |======================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       KS.stat.D      mc_p.value KS.stat.p.value     sample.size       num.sampl </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    9.030005e-03    1.000000e+00    3.886046e-01    1.000000e+03    5.000000e+02 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ========= Example 2 ======</span></span></span>
<span class="r-in"><span><span class="co"># Let us generate a random sample a random sample from a specified Normal</span></span></span>
<span class="r-in"><span><span class="co"># distribution:</span></span></span>
<span class="r-in"><span><span class="co"># Set a seed</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10000</span>, mean <span class="op">=</span> <span class="fl">1.5</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># MC KS test accept the null hypothesis that variable x comes</span></span></span>
<span class="r-in"><span><span class="co"># from N(x | mean = 0.5, sd = 1.2), while the standard</span></span></span>
<span class="r-in"><span><span class="co"># Kolmogorov-Smirnov test reject the Null Hypothesis. This an old KS issue,</span></span></span>
<span class="r-in"><span><span class="co"># well known by statisticians since the 1970s.</span></span></span>
<span class="r-in"><span><span class="fu">mcgoftest</span><span class="op">(</span><span class="va">x</span>,</span></span>
<span class="r-in"><span>    distr <span class="op">=</span> <span class="st">"norm"</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">2</span><span class="op">)</span>, num.sampl <span class="op">=</span> <span class="fl">500</span>,</span></span>
<span class="r-in"><span>    sample.size <span class="op">=</span> <span class="fl">1000</span>, num.cores <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Permutation GoF testing based on Kolmogorov-Smirnov statistic ( parametric approach )  ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       KS.stat.D      mc_p.value KS.stat.p.value     sample.size       num.sampl </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    8.022461e-03    1.000000e+00    5.404925e-01    1.000000e+03    5.000000e+02 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ========= Example 3 ======</span></span></span>
<span class="r-in"><span><span class="co">## Define a Weibull 3-parameter distribution function.</span></span></span>
<span class="r-in"><span><span class="co">## Functions must be defined out of the example section.</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">pwdist</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">pars</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">pweibull</a></span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">pars</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>        shape <span class="op">=</span> <span class="va">pars</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>        scale <span class="op">=</span> <span class="va">pars</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">rwdist</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">pars</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">rweibull</a></span><span class="op">(</span><span class="va">n</span>,</span></span>
<span class="r-in"><span>        shape <span class="op">=</span> <span class="va">pars</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>        scale <span class="op">=</span> <span class="va">pars</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="op">)</span> <span class="op">+</span> <span class="va">pars</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## A random generation from Weibull-3P</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">0.9</span>, shape <span class="op">=</span> <span class="fl">1.4</span>, scale <span class="op">=</span> <span class="fl">3.7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu">rwdist</span><span class="op">(</span><span class="fl">200</span>, pars <span class="op">=</span> <span class="va">pars</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Testing GoF</span></span></span>
<span class="r-in"><span><span class="fu">mcgoftest</span><span class="op">(</span></span></span>
<span class="r-in"><span>    varobj <span class="op">=</span> <span class="va">w</span>, distr <span class="op">=</span> <span class="st">"wdist"</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">pars</span><span class="op">)</span>, num.sampl <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>    sample.size <span class="op">=</span> <span class="fl">199</span>, stat <span class="op">=</span> <span class="st">"chisq"</span>, num.cores <span class="op">=</span> <span class="fl">4</span>, breaks <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>    seed <span class="op">=</span> <span class="fl">123</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ========= Example 4 ======</span></span></span>
<span class="r-in"><span><span class="co">## ----- Testing GoF of a mixture distribution. ----</span></span></span>
<span class="r-in"><span><span class="co">## Define a mixture distribution to be evaluated with functions 'mixtdistr'</span></span></span>
<span class="r-in"><span><span class="co">## (see ?mixtdistr). In the current case, it will be mixture of a Log-Normal</span></span></span>
<span class="r-in"><span><span class="co">## and a Weibull distributions:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">phi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.37</span>, <span class="fl">0.63</span><span class="op">)</span> <span class="co"># Mixture proportions</span></span></span>
<span class="r-in"><span><span class="va">args</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    lnorm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>meanlog <span class="op">=</span> <span class="fl">0.837</span>, sdlog <span class="op">=</span> <span class="fl">0.385</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    weibull <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">2.7</span>, scale <span class="op">=</span> <span class="fl">5.8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##  Sampling from the specified mixture distribution</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="mixtdistr.html">rmixtdistr</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1e5</span>, phi <span class="op">=</span> <span class="va">phi</span>, arg <span class="op">=</span> <span class="va">args</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">100</span>, freq <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x1</span>, <span class="fu"><a href="mixtdistr.html">dmixtdistr</a></span><span class="op">(</span><span class="va">x1</span>, phi <span class="op">=</span> <span class="va">phi</span>, arg <span class="op">=</span> <span class="va">args</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mcgoftest-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The GoF for the simulated sample</span></span></span>
<span class="r-in"><span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>phi <span class="op">=</span> <span class="va">phi</span><span class="op">)</span>, arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">args</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">mcgoftest</span><span class="op">(</span></span></span>
<span class="r-in"><span>    varobj <span class="op">=</span> <span class="va">x</span>, distr <span class="op">=</span> <span class="st">"mixtdistr"</span>, pars <span class="op">=</span> <span class="va">pars</span>, num.sampl <span class="op">=</span> <span class="fl">999</span>,</span></span>
<span class="r-in"><span>    sample.size <span class="op">=</span> <span class="fl">999</span>, stat <span class="op">=</span> <span class="st">"chisq"</span>, num.cores <span class="op">=</span> <span class="fl">4</span>, breaks <span class="op">=</span> <span class="fl">200</span>,</span></span>
<span class="r-in"><span>    seed <span class="op">=</span> <span class="fl">123</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Permutation GoF testing based on Pearson's Chi-squared statistic ( parametric approach )  ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================================                  |  75%  |                                                                              |======================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Chisq  mc_p.value sample.size   num.sampl </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    135.5693      0.9930    999.0000    999.0000 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#' ## ========= Example 5 ======</span></span></span>
<span class="r-in"><span><span class="co">## Shapiro-Wilk test of normality.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">151</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">21</span>, mean <span class="op">=</span> <span class="fl">5</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="co"># Classical test</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Shapiro-Wilk normality test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> W = 0.92578, p-value = 0.1133</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">mcgoftest</span><span class="op">(</span><span class="va">r</span>, stat <span class="op">=</span> <span class="st">"sw"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Monte Carlo GoF testing based on Shapiro-Wilk statistic ( parametric approach )  ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   SW.stat.p.value jackknife_p.value       sample.size         num.sampl </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         0.1132638         0.1353460        20.0000000        21.0000000 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ========= Example 6 ======</span></span></span>
<span class="r-in"><span><span class="co">## GoF for Dirichlet Distribution (these examples can be run,</span></span></span>
<span class="r-in"><span><span class="co">## the 'do not-run' is only to prevent time consuming in R checking)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.1</span>, <span class="fl">3.2</span>, <span class="fl">3.3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="dirichlet.html">rdirichlet</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, alpha <span class="op">=</span> <span class="va">alpha</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">mcgoftest</span><span class="op">(</span></span></span>
<span class="r-in"><span>    varobj <span class="op">=</span> <span class="va">x</span>, distr <span class="op">=</span> <span class="st">"dirichlet"</span>,</span></span>
<span class="r-in"><span>    pars <span class="op">=</span> <span class="va">alpha</span>, num.sampl <span class="op">=</span> <span class="fl">999</span>,</span></span>
<span class="r-in"><span>    sample.size <span class="op">=</span> <span class="fl">100</span>, stat <span class="op">=</span> <span class="st">"chisq"</span>,</span></span>
<span class="r-in"><span>    par.names <span class="op">=</span> <span class="st">"alpha"</span>,</span></span>
<span class="r-in"><span>    num.cores <span class="op">=</span> <span class="fl">4</span>, breaks <span class="op">=</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span>    seed <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Now, adding some noise to the sample</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">100</span>, max <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">mcgoftest</span><span class="op">(</span></span></span>
<span class="r-in"><span>    varobj <span class="op">=</span> <span class="va">x</span>, distr <span class="op">=</span> <span class="st">"dirichlet"</span>,</span></span>
<span class="r-in"><span>    pars <span class="op">=</span> <span class="va">alpha</span>, num.sampl <span class="op">=</span> <span class="fl">999</span>,</span></span>
<span class="r-in"><span>    sample.size <span class="op">=</span> <span class="fl">100</span>, stat <span class="op">=</span> <span class="st">"chisq"</span>,</span></span>
<span class="r-in"><span>    par.names <span class="op">=</span> <span class="st">"alpha"</span>,</span></span>
<span class="r-in"><span>    num.cores <span class="op">=</span> <span class="fl">4</span>, breaks <span class="op">=</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span>    seed <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ========= Example 7 ======</span></span></span>
<span class="r-in"><span><span class="co">## Testing multinomially distributed vectors</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## A vector of probability parameters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">12</span>, min <span class="op">=</span> <span class="fl">0.1</span>, max <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">prob</span> <span class="op">&lt;-</span> <span class="va">prob</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">prob</span><span class="op">)</span> <span class="co"># To normalize the probability vector</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Generate multinomially distributed random numeric vectors</span></span></span>
<span class="r-in"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Multinom.html" class="external-link">rmultinom</a></span><span class="op">(</span><span class="fl">12</span>, size <span class="op">=</span> <span class="fl">120</span>, prob <span class="op">=</span> <span class="va">prob</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## A list the parameter values must be provided</span></span></span>
<span class="r-in"><span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">120</span>, prob <span class="op">=</span> <span class="va">prob</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">mcgoftest</span><span class="op">(</span><span class="va">r</span>,</span></span>
<span class="r-in"><span>    distr <span class="op">=</span> <span class="st">"multinom"</span>, stat <span class="op">=</span> <span class="st">"chisq"</span>,</span></span>
<span class="r-in"><span>    pars <span class="op">=</span> <span class="va">pars</span>, sample.size <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>    num.sampl <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Monte Carlo GoF testing based on Pearson's Chi-squared statistic ( parametric approach )  ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Chisq  mc_p.value sample.size   num.sampl </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     240.685       1.000      20.000      50.000 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ========= Example 8 ======</span></span></span>
<span class="r-in"><span><span class="co">##  Testing whether two discrete probabilities vectors</span></span></span>
<span class="r-in"><span><span class="co">##  would come from different probability distributions.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Vector of absolute frequencies</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">12</span></span></span>
<span class="r-in"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, min <span class="op">=</span> <span class="fl">0.1</span>, max <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Add some little noise</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="va">x1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, min <span class="op">=</span> <span class="fl">0.1</span>, max <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">mcgoftest</span><span class="op">(</span></span></span>
<span class="r-in"><span>    varobj <span class="op">=</span> <span class="va">x1</span>, distr <span class="op">=</span> <span class="va">x2</span>,</span></span>
<span class="r-in"><span>    num.sampl <span class="op">=</span> <span class="fl">999</span>,</span></span>
<span class="r-in"><span>    stat <span class="op">=</span> <span class="st">"chisq"</span>,</span></span>
<span class="r-in"><span>    seed <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Monte Carlo GoF testing based on Pearson's Chi-squared statistic ( non-parametric approach )  ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Compare it with Chi-square test from R package 'stat'</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">chisq.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span>, simulate.p.value <span class="op">=</span> <span class="cn">TRUE</span>, B <span class="op">=</span> <span class="fl">2e3</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Add bigger noise to 'x1'</span></span></span>
<span class="r-in"><span><span class="va">x3</span> <span class="op">&lt;-</span> <span class="va">x1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">5</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">mcgoftest</span><span class="op">(</span></span></span>
<span class="r-in"><span>    varobj <span class="op">=</span> <span class="va">x1</span>, distr <span class="op">=</span> <span class="va">x3</span>,</span></span>
<span class="r-in"><span>    num.sampl <span class="op">=</span> <span class="fl">999</span>,</span></span>
<span class="r-in"><span>    stat <span class="op">=</span> <span class="st">"chisq"</span>,</span></span>
<span class="r-in"><span>    seed <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Monte Carlo GoF testing based on Pearson's Chi-squared statistic ( non-parametric approach )  ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.001</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Chi-square test from R package 'stat' is consistent with 'mcgoftest'</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">chisq.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x3</span><span class="op">)</span>, simulate.p.value <span class="op">=</span> <span class="cn">TRUE</span>, B <span class="op">=</span> <span class="fl">2e3</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.00149925</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We will always fail in to detect differences between 'crude' probability</span></span></span>
<span class="r-in"><span><span class="co">## vectors without additional information.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">chisq.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">x3</span>, simulate.p.value <span class="op">=</span> <span class="cn">TRUE</span>, B <span class="op">=</span> <span class="fl">2e3</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Robersy Sanchez.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

