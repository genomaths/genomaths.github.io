<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>P-P plot of Two-dimensional Copulas — ppCplot • usefr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="P-P plot of Two-dimensional Copulas — ppCplot"><meta property="og:description" content="The function build the P-P plot of Two-dimensional Copulas upon
    the knowledge of the margin distribution provided by the user. The
    empirical probabilities are computed using function
    empCopula from package
    [copula-package]{copula}."><meta property="og:image" content="https://genomaths.github.io/usefr/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">usefr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/usefr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Package functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/usefr.html">usefr</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/fisher-exact-test-failure-can-lead-to-biassed-results.html">Fisher's exact test failure can lead to biased results</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>P-P plot of Two-dimensional Copulas</h1>
    
    <div class="hidden name"><code>ppCplot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function build the P-P plot of Two-dimensional Copulas upon
    the knowledge of the margin distribution provided by the user. The
    empirical probabilities are computed using function
    <code><a href="https://rdrr.io/pkg/copula/man/empCopula.html" class="external-link">empCopula</a></code> from package
    <code>[copula-package]{copula}</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ppCplot</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">Y</span>,</span>
<span>  copula <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  margins <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  paramMargins <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  npoints <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"ml"</span>,</span>
<span>  smoothing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"beta"</span>, <span class="st">"checkerboard"</span><span class="op">)</span>,</span>
<span>  ties.method <span class="op">=</span> <span class="st">"max"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Empirical probabilities"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Theoretical probabilities"</span>,</span>
<span>  glwd <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>  bgcol <span class="op">=</span> <span class="st">"grey94"</span>,</span>
<span>  gcol <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>  dcol <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  dlwd <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  tck <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  tcl <span class="op">=</span> <span class="op">-</span><span class="fl">0.3</span>,</span>
<span>  xlwd <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  ylwd <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  xcol <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  ycol <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  cex.xtitle <span class="op">=</span> <span class="fl">1.3</span>,</span>
<span>  cex.ytitle <span class="op">=</span> <span class="fl">1.3</span>,</span>
<span>  padj <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>  hadj <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  xcex <span class="op">=</span> <span class="fl">1.3</span>,</span>
<span>  ycex <span class="op">=</span> <span class="fl">1.3</span>,</span>
<span>  xline <span class="op">=</span> <span class="fl">1.6</span>,</span>
<span>  yline <span class="op">=</span> <span class="fl">2.1</span>,</span>
<span>  xfont <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  yfont <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"serif"</span>,</span>
<span>  lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  bty <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  las <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  font <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">132</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>X</dt>
<dd><p>Numerical vector with the observations from the first margin
distribution.</p></dd>


<dt>Y</dt>
<dd><p>Numerical vector with the observations from the second margin
distribution.</p></dd>


<dt>copula</dt>
<dd><p>A copula object from class <code><a href="https://rdrr.io/pkg/copula/man/Mvdc.html" class="external-link">Mvdc</a></code> or
string specifying all the name for a copula from package
<code><a href="https://rdrr.io/pkg/copula/man/copula-package.html" class="external-link">copula-package</a></code>.</p></dd>


<dt>margins</dt>
<dd><p>A character vector specifying all the parametric marginal
distributions. See details below.</p></dd>


<dt>paramMargins</dt>
<dd><p>A list whose each component is a list (or numeric
vectors) of named components, giving the parameter values of the marginal
distributions. See details below.</p></dd>


<dt>npoints</dt>
<dd><p>Number of points used to build the P-P plot. The</p></dd>


<dt>method</dt>
<dd><p>A character string specifying the estimation method to be used
to estimate the dependence parameter(s) (if the copula needs to be
estimated) see <code><a href="https://rdrr.io/pkg/copula/man/fitCopula.html" class="external-link">fitCopula</a></code>.</p></dd>


<dt>smoothing</dt>
<dd><p>character string specifying whether the empirical
distribution function (for F.n()) or copula (for C.n()) is computed (if
smoothing = "none"), or whether the empirical beta copula (smoothing =
"beta") or the empirical checkerboard copula (smoothing = "checkerboard")
is computed (see <code><a href="https://rdrr.io/pkg/copula/man/empCopula.html" class="external-link">empCopula</a></code>.</p></dd>


<dt>ties.method</dt>
<dd><p>character string specifying how ranks should be computed
if there are ties in any of the coordinate samples of x; passed to
<code><a href="https://rdrr.io/pkg/copula/man/pobs.html" class="external-link">pobs</a></code> (see <code><a href="https://rdrr.io/pkg/copula/man/empCopula.html" class="external-link">empCopula</a></code>.</p></dd>


<dt>xlab</dt>
<dd><p>A label for the x axis, defaults to a description of x.</p></dd>


<dt>ylab</dt>
<dd><p>A label for the y axis, defaults to a description of y.</p></dd>


<dt>glwd</dt>
<dd><p>Grid line width.</p></dd>


<dt>bgcol</dt>
<dd><p>Grid background color.</p></dd>


<dt>gcol</dt>
<dd><p>Grid line color</p></dd>


<dt>dcol</dt>
<dd><p>Diagonal line color.</p></dd>


<dt>dlwd</dt>
<dd><p>Diagonal line color.</p></dd>


<dt>tck</dt>
<dd><p>The length of tick marks as a fraction of the smaller of the width
or height of the plotting region. If tck &gt;= 0.5 it is interpreted as a
fraction of the relevant side, so if tck = 1 grid lines are drawn. The
default setting (tck = NA) is to use tcl = -0.5.</p></dd>


<dt>tcl</dt>
<dd><p>The length of tick marks as a fraction of the height of a line of
text. The default value is -0.5; setting tcl = NA sets tck = -0.01 which
is S' default.</p></dd>


<dt>xlwd</dt>
<dd><p>X-axis line width.</p></dd>


<dt>ylwd</dt>
<dd><p>Y-axis line width.</p></dd>


<dt>xcol</dt>
<dd><p>X-axis line color.</p></dd>


<dt>ycol</dt>
<dd><p>Y-axis line color.</p></dd>


<dt>cex.xtitle</dt>
<dd><p>Cex for x-axis title.</p></dd>


<dt>cex.ytitle</dt>
<dd><p>Cex for y-axis title.</p></dd>


<dt>padj</dt>
<dd><p>adjustment for each tick label perpendicular to the reading
direction. For labels parallel to the axes, padj = 0 means right or top
alignment, and padj = 1 means left or bottom alignment. This can be a
vector given a value for each string, and will be recycled as necessary.</p></dd>


<dt>hadj</dt>
<dd><p>adjustment (see par("adj")) for all labels parallel
(‘horizontal’) to the reading direction. If this is not a finite value,
the default is used (centring for strings parallel to the axis,
justification of the end nearest the axis otherwise).</p></dd>


<dt>xcex, ycex</dt>
<dd><p>A numerical value giving the amount by which axis labels
should be magnified relative to the default.</p></dd>


<dt>xline, yline</dt>
<dd><p>On which margin line of the plot the x &amp; y labels must be
placed, starting at 0 counting outwards
(see <code><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></code>).</p></dd>


<dt>xfont, yfont</dt>
<dd><p>An integer which specifies which font to use for x &amp; y
axes titles (see <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>).</p></dd>


<dt>family, lty, bty, col, xlim, ylim, pch, las, mar, font</dt>
<dd><p>Graphical parameters
(see <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>).</p></dd>


<dt>cex</dt>
<dd><p>A numerical value giving the amount by which plotting text and
symbols should be magnified relative to the default. This starts as 1
when a device is opened, and is reset when the layout is changed, e.g.
by setting mfrow.</p></dd>


<dt>seed</dt>
<dd><p>An integer used to set a 'seed' for random number generation.</p></dd>


<dt>...</dt>
<dd><p>Other graphical parameters to pass to functions:
<code><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></code>, <code><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></code> and
<code><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The P-P plot and invisible temporary object with the
    information to build the graphic which can be assigned to a variable
    to use in further plots or analyses.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Empirical and theoretical probabilities are estimated using the
    quantiles generated with the margin quantile functions. Nonlinear fit of
    margin distributions can be previously accomplished using any of the
    functions <code><a href="fitCDF.html">fitCDF</a></code>, <code><a href="https://rdrr.io/pkg/MASS/man/fitdistr.html" class="external-link">fitdistr</a></code>, or function
    <code><a href="fitMixDist.html">fitMixDist</a></code> for the case where the margins are mixture of
    distributions. <em>npoints</em> random uniform and iid numbers from the
    interval [0, 1] are generated and used to evaluate the quantile margin
    distribution functions. Next, the quantiles are used to compute the
    empirical and theoretical copulas, which will be used to estimate the
    corresponding probabilities.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="fitCDF.html">fitCDF</a></code>, <code><a href="https://rdrr.io/pkg/MASS/man/fitdistr.html" class="external-link">fitdistr</a></code>,
    <code><a href="fitMixDist.html">fitMixDist</a></code>, <code><a href="mutualinf.html">mutualinf</a></code>, and
    <code><a href="bicopulaGOF.html">bicopulaGOF</a></code>.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Robersy Sanchez (<a href="https://genomaths.com" class="external-link">https://genomaths.com</a>).</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">margins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lnorm"</span>, <span class="st">"norm"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Random variates from normal distributions</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">200</span>, meanlog <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>, sdlog <span class="op">=</span> <span class="fl">3.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">200</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span><span class="op">)</span> <span class="co">## Correlation between X and Y</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.0126086</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">parMargins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>meanlog <span class="op">=</span> <span class="fl">0.5</span>, sdlog <span class="op">=</span> <span class="fl">3.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">copula</span> <span class="op">&lt;-</span> <span class="st">"normalCopula"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The information to build the graphic is stored in object 'g'.</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">ppCplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    X <span class="op">=</span> <span class="va">X</span>, Y <span class="op">=</span> <span class="va">Y</span>, copula <span class="op">=</span> <span class="st">"normalCopula"</span>, margins <span class="op">=</span> <span class="va">margins</span>,</span></span>
<span class="r-in"><span>    paramMargins <span class="op">=</span> <span class="va">parMargins</span>, npoints <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ppCplot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Robersy Sanchez.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

