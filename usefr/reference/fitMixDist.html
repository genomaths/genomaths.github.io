<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Nonlinear fit of Mixture distributions — fitMixDist • usefr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Nonlinear fit of Mixture distributions — fitMixDist"><meta property="og:description" content="This function performs the nonlinear fit of mixture
    distributions exploiting a firth approach on parameterized finite
    Gaussian mixture models obtained through the function
    Mclust from package mclust."><meta property="og:image" content="https://genomaths.github.io/usefr/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">usefr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/usefr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Package functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/usefr.html">usefr</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/Nonlinear_Fit_of_Mixture_Distributions.html">Nonlinear Fit of Mixture Distributions</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/fisher-exact-test-failure-can-lead-to-biassed-results.html">Fisher's exact test failure can lead to biased results</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/genomaths/usefr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Nonlinear fit of Mixture distributions</h1>
    <small class="dont-index">Source: <a href="https://github.com/genomaths/usefr/blob/HEAD/R/fitMixDist.R" class="external-link"><code>R/fitMixDist.R</code></a></small>
    <div class="hidden name"><code>fitMixDist.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function performs the nonlinear fit of mixture
    distributions exploiting a firth approach on parameterized finite
    Gaussian mixture models obtained through the function
    <code><a href="https://mclust-org.github.io/mclust/reference/Mclust.html" class="external-link">Mclust</a></code> from package <em>mclust</em>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fitMixDist</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>norm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="cn">NA</span>, sd <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>, weibull <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="cn">NA</span>, scale <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  dens <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  npoints <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  kmean <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  maxiter <span class="op">=</span> <span class="fl">1024</span>,</span>
<span>  prior <span class="op">=</span> <span class="fu">priorControl</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  ftol <span class="op">=</span> <span class="fl">1e-14</span>,</span>
<span>  ptol <span class="op">=</span> <span class="fl">1e-14</span>,</span>
<span>  maxfev <span class="op">=</span> <span class="fl">1e+05</span>,</span>
<span>  equalPro <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  eps <span class="op">=</span> <span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span>,</span>
<span>  tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1e-05</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="va">usepoints</span>,</span>
<span>  iter.max <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  nstart <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  algorithm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hartigan-Wong"</span>, <span class="st">"Lloyd"</span>, <span class="st">"Forgy"</span>, <span class="st">"MacQueen"</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>X</dt>
<dd><p>numerical vector. It is user responsability to provide `X` values
that belong the definition domain of the functions from mixture
distribution.</p></dd>


<dt>dens</dt>
<dd><p>Logic. Whether to use fit the 'PDF' or 'CDF'. Default is TRUE.</p></dd>


<dt>npoints</dt>
<dd><p>number of points used in the fit of the density function or
NULL. These are used as histogram break points to estimate the empirical
density values. If <em>npoints</em> = NULL and <em>dens</em> = TRUE, then.
Kernel Density Estimation function <code><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></code> from
<em>stats</em> package is used to estimate the empirical density. Default
value is 100.</p></dd>


<dt>kmean</dt>
<dd><p>Logic. Whether to use <code><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans</a></code> algorithm to
perform the estimation in place of <code><a href="https://mclust-org.github.io/mclust/reference/Mclust.html" class="external-link">Mclust</a></code>. Deafult
is FALSE.</p></dd>


<dt>maxiter</dt>
<dd><p>positive integer. Termination occurs when the number of
iterations reaches maxiter. Default value: 1024.</p></dd>


<dt>prior</dt>
<dd><p>Same as in <code><a href="https://mclust-org.github.io/mclust/reference/Mclust.html" class="external-link">Mclust</a></code> function.</p></dd>


<dt>ftol</dt>
<dd><p>non-negative numeric. Termination occurs when both the actual
and predicted relative reductions in the sum of squares are at most ftol.
Therefore, ftol measures the relative error desired in the sum of
squares. Default value: 1e-12</p></dd>


<dt>ptol</dt>
<dd><p>non-negative numeric. Termination occurs when the relative error
between two consecutive iterates is at most ptol. Therefore, ptol
measures the relative error desired in the approximate solution.
Default value: 1e-12.</p></dd>


<dt>maxfev</dt>
<dd><p>Integer; termination occurs when the number of calls to fn has
reached maxfev. Note that nls.lm sets the value of maxfev to
100*(length(par) + 1) if maxfev = integer(), where par is the list or
vector of parameters to be optimized.</p></dd>


<dt>equalPro</dt>
<dd><p>An argument to pass to <code><a href="https://mclust-org.github.io/mclust/reference/emControl.html" class="external-link">emControl</a></code>
function. Logical variable indicating whether or not the mixing
proportions are equal in the model. Default: equalPro = FALSE.</p></dd>


<dt>eps, tol</dt>
<dd><p>Arguments to pass to <code><a href="https://mclust-org.github.io/mclust/reference/emControl.html" class="external-link">emControl</a></code> function.</p></dd>


<dt>usepoints</dt>
<dd><p>Integer. Computation by function
<code><a href="https://mclust-org.github.io/mclust/reference/Mclust.html" class="external-link">Mclust</a></code> could take long time when the sample size is
about &gt;= 10000. This number can be used to extract a random sample of
size 'usepoints' and to do the estimation with it.</p></dd>


<dt>iter.max, nstart, algorithm</dt>
<dd><p>Same as in <code><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans</a></code>.</p></dd>


<dt>seed</dt>
<dd><p>Seed for random number generation.</p></dd>


<dt>verbose</dt>
<dd><p>if TRUE, prints the function log to stdout and a progress bar</p></dd>


<dt>...</dt>
<dd><p>Further arguments to pass to other functions like
<code><a href="https://mclust-org.github.io/mclust/reference/Mclust.html" class="external-link">Mclust</a></code> and <code><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></code>.</p></dd>


<dt>arg</dt>
<dd><p>A list of named vectors with the corresponding named distribution
    parameters values. The names of the vector of parameters and the
    parameter names must correspond to defined functions. For example, if
    one of the involved distributions is the gamma density (see
    <code><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">GammaDist</a></code>), then the corresponding vector of
    parameters must be gamma = c(shape = 'some value', scale = 'some value').
    For the following distributions, the arguments can be provided with NULL
    values:</p><ul><li><p>"norm" <a href="https://goo.gl/xaEAdT" class="external-link">(Wikipedia)</a></p></li>
<li><p>"hnorm" <a href="https://goo.gl/yxMF6T" class="external-link">(Wikipedia)</a>.</p></li>
<li><p>"lnorm" <a href="https://is.gd/A5EJFi" class="external-link">(Wikipedia)</a></p></li>
<li><p>"gnorm" <a href="https://goo.gl/EPk8mH" class="external-link">(Wikipedia)</a></p></li>
<li><p>"gamma" <a href="https://goo.gl/cYkvar" class="external-link">(Wikipedia)</a></p></li>
<li><p>"ggamma" <a href="https://is.gd/oPHfX7" class="external-link">(Wikipedia)</a></p></li>
<li><p>"beta" <a href="https://goo.gl/893wzR" class="external-link">(Wikipedia)</a></p></li>
<li><p>"beta" <a href="https://goo.gl/893wzR" class="external-link">(Wikipedia)</a></p></li>
<li><p>"laplace" <a href="https://goo.gl/fCykV9" class="external-link">(Wikipedia)</a></p></li>
<li><p>"weibull" <a href="https://goo.gl/WMXmQP" class="external-link">(Wikipedia)</a></p></li>
<li><p>"rayleigh" <a href="https://goo.gl/d9b3zv" class="external-link">(Wikipedia)</a></p></li>
<li><p>"exp" <a href="https://goo.gl/stVsi7" class="external-link">(Wikipedia)</a></p></li>
</ul><p>Notice that the distribution given names correspond to the root-names as
given for R functions. For example, 'gamma' is the root-name for
functions <code><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">GammaDist</a></code>. See example, for more details. It
is necessary that any the root-name provided corresponds to a defined PDF
(if dens = TRUE) or to a defined CDF (if dens = FALSE) found in the session
`environment` (see ?environment).</p></dd>


<dt>fit.comp</dt>
<dd><p>Logical. If FALSE, then starting parameter values for each
mixture component will be estimated suing function <code><a href="fitCDF.html">fitCDF</a></code>,
which could use more computational time. Default is FALSE</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list with the model table with coefficients and goodness-of-fit
    results, the fitted model returned by function</p>
<p></p>
<p><code><a href="https://rdrr.io/pkg/minpack.lm/man/nls.lm.html" class="external-link">nls.lm</a></code>, and a named list of fitted arguments.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The approch tries to fit the proposed mixture distributions using a
    modification of Levenberg-Marquardt algorithm implemented in function
    <code><a href="https://rdrr.io/pkg/minpack.lm/man/nls.lm.html" class="external-link">nls.lm</a></code> from <em>minpack.lm</em> package that is
    used to perform the nonlinear fit. Cross-validations for the nonlinear
    regressions (R.Cross.val) are performed as described in reference [1]. In
    addition, Stein's formula for adjusted R squared (rho) was used as an
    estimator of the average cross-validation predictive power [1]. Notice
    that the parameter values must be given in way <em>understandable</em>
    by the set of functions <code><a href="mixtdistr.html">mixtdistr</a></code> (see the example below).
    It is user responsability to provide `X` values that belong the
    definition domain of the functions from mixture distribution.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>1. Stevens JP. Applied Multivariate Statistics for the Social
    Sciences. Fifth Edit. Routledge Academic; 2009.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/MASS/man/fitdistr.html" class="external-link">fitdistr</a></code>, <code><a href="fitCDF.html">fitCDF</a></code>,
    <code><a href="mixtdistr.html">mixtdistr</a></code>, and <code><a href="mcgoftest.html">mcgoftest</a></code>.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Robersy Sanchez (<a href="https://genomaths.com" class="external-link">https://genomaths.com</a>).</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#'</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co"># set a seed for random generation</span></span></span>
<span class="r-in"><span><span class="co">## ========= A mixture of three distributions =========</span></span></span>
<span class="r-in"><span><span class="va">phi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span> <span class="op">/</span> <span class="fl">10</span>, <span class="fl">4</span> <span class="op">/</span> <span class="fl">10</span><span class="op">)</span> <span class="co">#' Mixture proportions</span></span></span>
<span class="r-in"><span><span class="co">## ---------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## === Named vector of the corresponding distribution function parameters</span></span></span>
<span class="r-in"><span><span class="co">## must be provided</span></span></span>
<span class="r-in"><span><span class="va">args</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    gamma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">2</span>, scale <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    weibull <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">3</span>, scale <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ===== Sampling from the specified mixture distribution ====</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="mixtdistr.html">rmixtdistr</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1e5</span>, phi <span class="op">=</span> <span class="va">phi</span>, arg <span class="op">=</span> <span class="va">args</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ===== Nonlinear fit of the specified mixture distribution ====</span></span></span>
<span class="r-in"><span><span class="va">FIT</span> <span class="op">&lt;-</span> <span class="fu">fitMixDist</span><span class="op">(</span><span class="va">X</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    gamma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="cn">NA</span>, scale <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    weibull <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="cn">NA</span>, scale <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fitting ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Performing nonlinear regression model  crossvalidation...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## === The graphics for the simulated dataset and the corresponding</span></span></span>
<span class="r-in"><span><span class="co">## theoretical mixture distribution.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>bg <span class="op">=</span> <span class="st">"gray98"</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">X</span>, <span class="fl">90</span>,</span></span>
<span class="r-in"><span>    freq <span class="op">=</span> <span class="cn">FALSE</span>, las <span class="op">=</span> <span class="fl">1</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    panel.first <span class="op">=</span> <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, pch <span class="op">=</span> <span class="fl">16</span>, cex <span class="op">=</span> <span class="fl">1e6</span>, col <span class="op">=</span> <span class="st">"grey95"</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"white"</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span>,</span></span>
<span class="r-in"><span>    family <span class="op">=</span> <span class="st">"serif"</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    border <span class="op">=</span> <span class="st">"deepskyblue"</span>, main <span class="op">=</span> <span class="st">"Histogram of Mixture Distribution"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x1</span>, <span class="fu"><a href="mixtdistr.html">dmixtdistr</a></span><span class="op">(</span><span class="va">x1</span>, phi <span class="op">=</span> <span class="va">phi</span>, arg <span class="op">=</span> <span class="va">args</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x1</span>, <span class="fu"><a href="mixtdistr.html">dmixtdistr</a></span><span class="op">(</span><span class="va">x1</span>, phi <span class="op">=</span> <span class="va">FIT</span><span class="op">$</span><span class="va">phi</span>, arg <span class="op">=</span> <span class="va">FIT</span><span class="op">$</span><span class="va">args</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">4</span>,</span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="st">"Theoretical Mixture PDF"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"Estimated Mixture PDF"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"Gamma distribution component"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"Weibull distribution component"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"magenta"</span>, <span class="st">"brown"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span>, cex <span class="op">=</span> <span class="fl">0.8</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The standard definition of dgamma function (see ?dgamma)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x1</span>, <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">x1</span>,</span></span>
<span class="r-in"><span>    shape <span class="op">=</span> <span class="va">FIT</span><span class="op">$</span><span class="va">args</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    scale <span class="op">=</span> <span class="va">FIT</span><span class="op">$</span><span class="va">args</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"magenta"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## The standard definition of dgamma function (see ?dgamma)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x1</span>, <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">x1</span>,</span></span>
<span class="r-in"><span>    shape <span class="op">=</span> <span class="va">args</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    scale <span class="op">=</span> <span class="va">args</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"brown"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitMixDist-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The accuracy of the fitting depends on the the starting values</span></span></span>
<span class="r-in"><span><span class="va">FIT</span> <span class="op">&lt;-</span> <span class="fu">fitMixDist</span><span class="op">(</span><span class="va">X</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    gamma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">2.3</span>, scale <span class="op">=</span> <span class="fl">0.12</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    weibull <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">2.5</span>, scale <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Performing nonlinear regression model  crossvalidation...</span>
<span class="r-in"><span><span class="va">FIT</span><span class="op">$</span><span class="va">args</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $gamma</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       shape       scale </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 127.5137262   0.0460745 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $weibull</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    shape    scale </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.784467 0.231441 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">FIT</span><span class="op">$</span><span class="va">phi</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.61701 0.38299</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Robersy Sanchez.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

