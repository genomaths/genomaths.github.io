<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fisher's exact test for read counts on GRanges objects — FisherTest • MethylIT</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fisher's exact test for read counts on GRanges objects — FisherTest"><meta property="og:description" content="Given a GRanges object with the methylated and unmethylated
read counts for control and treatment in its metacolumn, Fisher's exact
test is performed for each cytosine site."><meta property="og:image" content="https://genomaths.github.io/methylit/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MethylIT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.2.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/MethylIT.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Package functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/MethylIT.html">MethylIT</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/Methylation_analysis_with_Methyl-IT.html">Methylation analysis with Methyl-IT</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/cancer_example.html">Example of Methylome Analysis with MethylIT using Cancer Datasets</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/Cutpoint_estimation_with_Methyl-IT.html">Optimal cutpoint for the methylation signal</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/pca_lda_with_methylit.html">Principal Components and Linear Discriminant Analyses with Methyl-IT</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/GenExp_Methylation_association_hyper_down-regulated.html">Association Between Gene Expression and Cytosine DNA Methylation at gene-body</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/dmr_at_memory.html">DMR detection with Methyl-IT</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/some_tips_for_methylit_r_scripts.html">Some tips for Methyl-IT R scripts</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/genomaths/MethylIT/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fisher's exact test for read counts on GRanges objects</h1>
    <small class="dont-index">Source: <a href="https://github.com/genomaths/MethylIT/blob/HEAD/R/FisherTest.R" class="external-link"><code>R/FisherTest.R</code></a></small>
    <div class="hidden name"><code>FisherTest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Given a GRanges object with the methylated and unmethylated
read counts for control and treatment in its metacolumn, Fisher's exact
test is performed for each cytosine site.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">FisherTest</span><span class="op">(</span></span>
<span>  <span class="va">LR</span>,</span>
<span>  count.col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  control.names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  treatment.names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pooling.stat <span class="op">=</span> <span class="st">"sum"</span>,</span>
<span>  tv.cut <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hdiv.cut <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hdiv.col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pAdjustMethod <span class="op">=</span> <span class="st">"BH"</span>,</span>
<span>  pvalCutOff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  saveAll <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  num.cores <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  tasks <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  progressbar <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>LR</dt>
<dd><p>A list of GRanges, a GRangesList, a CompressedGRangesList object,
or an object from Methyl-IT downstream analyses: 'InfDiv' or 'pDMP'
object. Each GRanges object from the list must have two columns:
methylated (mC) and unmethylated (uC) counts. The name of each element
from the list must coincide with a control or a treatment name.</p></dd>


<dt>count.col</dt>
<dd><p>2d-vector of integers with the indexes of the read count
columns. If not given, then it is assumed that the methylated and
unmethylated read counts are located in columns 1 and 2 of each GRanges
metacolumns. If object LR is the output of Methyl-IT function
<code><a href="estimateDivergence.html">estimateDivergence</a></code>, then columns 1:4 are the read
count columns: columns 1 and 2 are methylated and unmethylated read
counts from the reference group, while columns 3 and 4 are methylated and
unmethylated read counts from the treatment group, respectively. In this
case, if the requested comparison is reference versus treatment, then no
specification is needed for count.col. The comparison control versus
treatment can be obtained by setting count.col = 3:4 and providing
control.names and treatment.names.</p></dd>


<dt>control.names, treatment.names</dt>
<dd><p>Names/IDs of control and treatment
samples, which must be included in the variable GR at the metacolumn.
Default NULL. If provided the Fisher's exact test control versus
treatment is performed. Default is NULL. If NULL, then it is assumed that
each GRanges object in LR has four columns of counts. The first two
columns correspond to the methylated and unmethylated counts from
control/reference and the other two columns are the methylated and
unmethylated counts from treatment, respectively.</p></dd>


<dt>pooling.stat</dt>
<dd><p>statistic used to estimate the methylation pool: row sum,
row mean or row median of methylated and unmethylated read counts across
individuals. If the number of control samples is greater than 2 and
pooling.stat is not NULL, then they will pooled. The same for treatment.
Otherwise, all the pairwise comparisons will be done.</p></dd>


<dt>tv.cut</dt>
<dd><p>A cutoff for the total variation distance (TVD; absolute value
of methylation levels differences) estimated at each site/range as the
difference of the group means of methylation levels. If tv.cut is
provided, then sites/ranges k with \(|TV_k| &lt; tv.cut\) are removed
before performing the regression analysis. Its value must be NULL or a
number \(0 &lt; tv.cut &lt; 1\).</p></dd>


<dt>hdiv.cut</dt>
<dd><p>An optional cutoff for the Hellinger divergence (<em>hdiv</em>). If
the LR object derives from the previous application of function
<code><a href="estimateDivergence.html">estimateDivergence</a></code>, then a column with the <em>hdiv</em> values is
provided. If combined with tv.cut, this permits a more effective
filtering of the signal from the noise. Default is NULL.</p></dd>


<dt>hdiv.col</dt>
<dd><p>Optional. Columns where <em>hdiv</em> values are located in each
GRanges object from LR. It must be provided if together with <em>hdiv.cut</em>.
Default is NULL.</p></dd>


<dt>pAdjustMethod</dt>
<dd><p>method used to adjust the results; default: BH</p></dd>


<dt>pvalCutOff</dt>
<dd><p>cutoff used then a p-value adjustment is performed</p></dd>


<dt>saveAll</dt>
<dd><p>if TRUE all the temporal results are returned</p></dd>


<dt>num.cores</dt>
<dd><p>The number of cores to use, i.e. at most how many child
processes will be run simultaneously (see bpapply function from
BiocParallel).</p></dd>


<dt>tasks</dt>
<dd><p>integer(1). The number of tasks per job. value must be a scalar
integer &gt;= 0L. In this documentation a job is defined as a single call
to a function, such as bplapply, bpmapply etc. A task is the division of
the X argument into chunks. When tasks == 0 (default), X is divided as
evenly as possible over the number of workers (see MulticoreParam from
BiocParallel package).</p></dd>


<dt>verbose</dt>
<dd><p>if TRUE, prints the function log to stdout</p></dd>


<dt>progressbar</dt>
<dd><p>logical(1). Enable progress bar</p></dd>


<dt>...</dt>
<dd><p>Additional parameters for function
<code><a href="uniqueGRanges.html">uniqueGRanges</a></code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The input GRanges object with the columns of Fisher's exact test
p-value, total variation (difference of methylation levels), and
p-value adjustment.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Samples from each group are pooled according to the statistic
selected (see parameter pooling.stat) and a unique GRanges object is
created with the methylated and unmethylated read counts for each group
(control and treatment) in the metacolumn. So, a contingency table can be
built for range from GRanges object.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/MethylIT.utils/man/rmstGR.html" class="external-link">rmstGR</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Get a dataset of Hellinger divergency of methylation levels</span></span></span>
<span class="r-in"><span><span class="co">## from the package</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">HD</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### --- To get the read counts</span></span></span>
<span class="r-in"><span><span class="va">hd</span> <span class="op">&lt;-</span> <span class="fu"><a href="lapply.html">lapply</a></span><span class="op">(</span><span class="va">HD</span>, <span class="kw">function</span><span class="op">(</span><span class="va">hd</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">hd</span> <span class="op">=</span> <span class="va">hd</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="fu">mcols</span><span class="op">(</span><span class="va">hd</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'mC'</span>, <span class="st">'uC'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">hd</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">FisherTest</span><span class="op">(</span>LR <span class="op">=</span> <span class="va">hd</span>, pooling.stat <span class="op">=</span> <span class="cn">NULL</span>, control.names <span class="op">=</span> <span class="st">'C1'</span>,</span></span>
<span class="r-in"><span>treatment.names <span class="op">=</span> <span class="st">'T1'</span>, pAdjustMethod<span class="op">=</span><span class="st">'BH'</span>, pvalCutOff <span class="op">=</span> <span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>num.cores <span class="op">=</span> <span class="fl">1L</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |======                                                                |   8%  |                                                                              |============                                                          |  17%  |                                                                              |==================                                                    |  25%  |                                                                              |=======================                                               |  33%  |                                                                              |=============================                                         |  42%  |                                                                              |===================================                                   |  50%  |                                                                              |=========================================                             |  58%  |                                                                              |===============================================                       |  67%  |                                                                              |====================================================                  |  75%  |                                                                              |==========================================================            |  83%  |                                                                              |================================================================      |  92%  |                                                                              |======================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> list object of length: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $C1.T1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GRanges object with 4 ranges and 7 metadata columns:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       seqnames    ranges strand |        c1        t1        c2        t2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]        1         1      + |        57         7        43        21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [2]        1         6      - |        64        49         0       113</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [3]        1         7      - |        41         0        10        31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [4]        1         9      - |         0       165       162         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              TV      pvalue    adj.pval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &lt;numeric&gt;   &lt;numeric&gt;   &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1] -0.218750 4.84887e-03 1.45466e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [2] -0.566372 3.16957e-25 1.90174e-24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [3] -0.756098 6.01609e-14 2.40644e-13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [4]  0.981818 1.61719e-92 1.94062e-91</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;0 more GRanges elements&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------- </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Robersy Sanchez.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

