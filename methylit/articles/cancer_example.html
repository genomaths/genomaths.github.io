<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Example of Methylome Analysis with MethylIT using Cancer Datasets • MethylIT</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Example of Methylome Analysis with MethylIT using Cancer Datasets">
<meta property="og:description" content="MethylIT">
<meta property="og:image" content="https://genomaths.github.io/methylit/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MethylIT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/MethylIT.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Package functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/MethylIT.html">MethylIT</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/Methylation_analysis_with_Methyl-IT.html">Methylation analysis with Methyl-IT</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/cancer_example.html">Example of Methylome Analysis with MethylIT using Cancer Datasets</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/Cutpoint_estimation_with_Methyl-IT.html">Optimal cutpoint for the methylation signal</a>
    </li>
        <li class="divider">
    <li>
      <a href="../articles/GenExp_Methylation_association_hyper_down-regulated.html">Association Between Gene Expression and Cytosine DNA Methylation at gene-body</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://github.com/genomaths/MethylIT/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://twitter.com/robersysr">
    <span class="fab fa fab fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Example of Methylome Analysis with MethylIT using Cancer Datasets</h1>
            <h3 class="subtitle"><h1>
A <a href="https://github.com/genomaths/%20MethylIT">Methyl-IT</a> user guide. A guide for users</h1></h3>
                        <h4 class="author"><div class="line-block">Robersy Sanchez<span class="math inline">\(^1\)</span><br><a href="mailto:rus547@psu.edu" class="email">rus547@psu.edu</a><br><br>
Sally Mackenzie<span class="math inline">\(^{1,2}\)</span><br><a href="mailto:sam795@psu.edu" class="email">sam795@psu.edu</a><br><br><span class="math inline">\(^1\)</span>Department of Biology.<br>
Pennsylvania State University, University Park, PA 16802<br><br><span class="math inline">\(^2\)</span>Department of Plant Science.<br>
Pennsylvania State University, University Park, PA 16802</div></h4>
            
            <h4 class="date">05 April 2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/genomaths/MethylIT/blob/master/vignettes/cancer_example.Rmd"><code>vignettes/cancer_example.Rmd</code></a></small>
      <div class="hidden name"><code>cancer_example.Rmd</code></div>

    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      An example of methylation analysis with Methyl-IT, a novel methylome analysis procedure based on a signal-detection and machine- learning approach, is provided here. Methylation analysis involves a signal detection problem, and the method was designed to discriminate methylation regulatory signal from background noise induced by thermal fluctuations. Methyl-IT enhances the resolution of genome methylation behavior to reveal network-associated responses, offering resolution of gene pathway influences not attainable with previous methods. Herein, an example of MethylIT application to the analysis of breast cancer methylomes is presented.
    </div>
    
<style type="text/css">

.list-group-item.active, .list-group-item.active:focus,
.list-group-item.active:hover {
    z-index: 2;
    color: #fff;
    background-color: #337ab7;
    border-color: #337ab7;
}

.tocify-subheader .tocify-item {
    font-size: 0.80em;
    padding-left: 25px;
    text-indent: 0;
}

.tocify-header .tocify-item {
    font-size: 0.85em;
    padding-left: 20px;
    text-indent: 0;
}

body{ /* Normal */
    font-size: 18px;
    font-family: "Times New Roman", Times, serif;
    text-align: justify
}
td { /* Table */
    font-size: 8px;
}

h1.title {
    font-size: 38px;
    font-family: "Times New Roman", Times, serif;
    color: DarkRed;
    .subTitle {
        font-size: 24px;
        font-family: "Times New Roman", Times, serif;
        color: DarkRed;
    }
}

h1 { /* Header 1 */
    font-size: 28px;
    font-family: "Times New Roman", Times, serif;
    color: DarkBlue;
}
h2 { /* Header 2 */
    font-size: 22px;
    color: DarkBlue;
    font-family: "Times New Roman", Times, serif;
}
h3 { /* Header 3 */
    font-size: 18px;
    color: DarkBlue;
    font-family: "Times New Roman", Times, serif;
}
code.r{ /* Code block */
    font-size: 12px;
}
pre { /* Code block - determines code spacing between lines */
    font-size: 14px;
}
</style>
<div id="methyl-it" class="section level1">
<h1 class="hasAnchor">
<a href="#methyl-it" class="anchor"></a><a href="https://github.com/genomaths/MethylIT">Methyl-IT</a>
</h1>
<p>MethylIT is an R package for methylome analysis based on a signal-detection machine learning approach (SD-ML). This approach is postulated to provide greater sensitivity for resolving true signal from the methylation background within the methylome <span class="citation">(Sanchez and Mackenzie 2016; Sanchez et al. 2019)</span>. Because the biological signal created within the dynamic methylome environment characteristic of plants is not free from background noise, the approach, designated Methyl-IT, includes the application of signal detection theory <span class="citation">(Greiner, Pfeiffer, and Smith 2000; Carter et al. 2016; Harpaz et al. 2013; Kruspe et al. 2017)</span>.</p>
<p>A basic requirement for the application of signal detection is the knowledge of the probability distribution of the background noise, which is used as null hypothesis in the detection of the methylation signal. This probability distribution is, in general, a member of generalized gamma distribution family, and it can be deduced on a statistical mechanical/thermodynamics basis from DNA methylation induced by thermal fluctuations <span class="citation">(Sanchez and Mackenzie 2016)</span>. Herein, we provide an example of Methyl-IT application to the analysis of breast cancer methylomes. Due to the size of human methylome the current example only covers the analysis of chromosome 13. A full description of Methyl-IT application of methylome analysis in plants is given in the manuscript <span class="citation">(Sanchez et al. 2019)</span>.</p>
<p>The R packages required in this example are:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>({
        <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">MethylIT</span>)
        <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>) <span class="co"># graphic</span>
        <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">reshape2</span>) <span class="co"># To reshape the data frame</span>
        <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">grid</span>) <span class="co"># For multiple plots</span>
        <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">gridExtra</span>) <span class="co"># For multiple plots</span>
        <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">VennDiagram</span>)
        <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">rtracklayer</span>) <span class="co"># To import gene annotation</span>
    }
)</pre></body></html></div>
<div id="available-datasets-and-reading" class="section level2">
<h2 class="hasAnchor">
<a href="#available-datasets-and-reading" class="anchor"></a>Available datasets and reading</h2>
<p>Methylome datasets of whole-genome bisulfite sequencing (WGBS) are available at Gene Expression Omnibus (GEO DataSets). For the current example, datasets from breast tissues (normal and cancer) and embryonic stem cells will be downloaded from GEO. The data set are downloaded providing the GEO accession numbers for each data set to the function ‘getGEOSuppFiles’ (see the function <a href="https://is.gd/JodM5G">getGEOSuppFiles</a> help). Some times the ftp site is not available and the information must be manually downloaded from GEO database.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co"># Embryonic stem cells datasets</span>
<span class="no">esc.files</span> <span class="kw">=</span> <span class="fu"><a href="../reference/getGEOSuppFiles.html">getGEOSuppFiles</a></span>(<span class="kw">GEO</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"GSM2041690"</span>, <span class="st">"GSM2041691"</span>, <span class="st">"GSM2041692"</span>),
                            <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="co"># Breast tissues (normal, cancer, metastasis)</span>
<span class="no">cancer.files</span> <span class="kw">=</span> <span class="fu"><a href="../reference/getGEOSuppFiles.html">getGEOSuppFiles</a></span>(<span class="kw">GEO</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"GSM1279517"</span>,<span class="st">"GSM1279514"</span>,
                                        <span class="st">"GSM1279513"</span>), <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
<p>The file path and name of each downloaded dataset is found in the output variables ‘esc.files’ and ‘cancer.files’.</p>
</div>
<div id="reading-datasets" class="section level2">
<h2 class="hasAnchor">
<a href="#reading-datasets" class="anchor"></a><em>Reading datasets</em>
</h2>
<p>Datasets for our example can be read with function <a href="https://is.gd/5pyk1N">readCounts2GRangesList</a>. To specify the reading of only chromosome 13, we can specify the parameter ‘chromosomes = “Chr13”’. The symbol chromosome 13, in this case “Chr13”, must be consistent with the annotation provided in the given GEO dataset. Each file is wholly read with the setting ‘chromosomes = “Chr13”’ and then the GRanges are built only with chromosome 13, which could be time consuming. However, users working on Linux OS can specify the reading of specific lines from each file by using regular expressions. For example, if only chromosomes 1 and 3 are required, then we can set chromosomes = NULL (default) and ‘chromosome.pattern = “^Chr[1,3]”’. This will read all the lines in the downloaded files starting with the words “Chr1” or “Chr3”. If we are interested in chromosomes 1 and 2, then we can set ‘chromosome.pattern = “^Chr[1-2]”’. If all the chromosomes are required, then set chromosomes = NULL and chromosome.pattern = NULL (default). Obviously, before read the files, user must check them to see which annotation was used by the experimenters to denote the chromosomes, e.g., “chr13” or just “13”, etc.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># Embryonic stem cells datasets</span>
<span class="no">ref</span> <span class="kw">=</span> <span class="fu"><a href="../reference/readCounts2GRangesList.html">readCounts2GRangesList</a></span>(<span class="kw">filenames</span> <span class="kw">=</span> <span class="no">esc.files</span>,
                            <span class="kw">sample.id</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"ESC1"</span>,<span class="st">"ESC2"</span>, <span class="st">"ESC3"</span>),
                            <span class="kw">columns</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">seqnames</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">start</span> <span class="kw">=</span> <span class="fl">2</span>,
                                        <span class="kw">mC</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">uC</span> <span class="kw">=</span> <span class="fl">5</span>), <span class="kw">pattern</span> <span class="kw">=</span> <span class="st">"^chr13"</span>,
                            <span class="kw">remove</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="co"># Breast tissues (normal, cancer, metastasis)</span>
<span class="no">LR</span> <span class="kw">=</span> <span class="fu"><a href="../reference/readCounts2GRangesList.html">readCounts2GRangesList</a></span>(<span class="kw">filenames</span> <span class="kw">=</span> <span class="no">cancer.files</span>,
                            <span class="kw">sample.id</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Breast_normal"</span>, <span class="st">"Breast_cancer"</span>,
                                            <span class="st">"Breast_metastasis"</span>),
                            <span class="kw">columns</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">seqnames</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">start</span> <span class="kw">=</span> <span class="fl">2</span>,
                                        <span class="kw">mC</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">uC</span> <span class="kw">=</span> <span class="fl">4</span>),
                            <span class="kw">remove</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">pattern</span> <span class="kw">=</span> <span class="st">"^13"</span>,
                            <span class="kw">chromosome.names</span> <span class="kw">=</span> <span class="st">"chr13"</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
<p>In real data analysis, a bigger sample size must be used. For the purpose of this example, to illustrate the application of methylation analysis with Methyl-IT, we will just add an artificial normal sample.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">LR</span>$<span class="no">Breast_normal1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/poolFromGRlist.html">poolFromGRlist</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">ref</span>[<span class="fl">1</span>], <span class="no">LR</span>$<span class="no">Breast_normal</span>,
                                        <span class="no">LR</span>$<span class="no">Breast_normal</span>, <span class="no">LR</span>$<span class="no">Breast_normal</span>,
                                        <span class="no">LR</span>$<span class="no">Breast_normal</span>, <span class="no">LR</span>$<span class="no">Breast_normal</span>),
                                    <span class="kw">stat</span> <span class="kw">=</span> <span class="st">"mean"</span>, <span class="kw">num.cores</span> <span class="kw">=</span> <span class="fl">6L</span>,
                                    <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
<p>In the metacolumn of the last GRanges object, mC and uC stand for the methylated and unmethylated read counts, respectively. Notice that option ‘remove = TRUE’ remove the decompressed files (default: FALSE, see ? readCounts2GRangesList for more details about this function).</p>
</div>
<div id="the-reference-individual" class="section level2">
<h2 class="hasAnchor">
<a href="#the-reference-individual" class="anchor"></a>The reference individual</h2>
<p>Any two objects can be compared based on some measured variable if, and only if, the measurements where taken in the same metric space, the same coordinate system, in respect to the same origin of coordinates. Usually, in our daily 3D experience, our brain automatically sets up the origin of coordinates equal to zero. The differences found in the comparison depend on the reference used to perform the measurements and from the metric system. The space where the objects are located (or the set of objects) together with the metric is called metric space.</p>
<p>Unfortunately, this is not the case for the methylation process. Each individual from the same population and even each chromosome follows an independent stochastic methylation process. This is not a surprise, since cytosine methylation affect the mechanical properties of DNA molecule with strong dependence of the DNA sequence context (until, at least. 6 bases at both sides of each cytosine site) <span class="citation">(Severin et al. 2011; Ngo et al. 2016)</span>.</p>
<p>To evaluate the methylation differences between individuals from control and treatment we introduce a metric in the bidimensional space of methylation levels <span class="math inline">\(P_i = (p_i, 1-p_i)\)</span>. Vectors <span class="math inline">\(P_i\)</span> provide a measurement of the uncertainty of methylation levels <span class="citation">(Sanchez et al. 2019)</span>. However, to perform the comparison between the uncertainty of methylation levels from each group of individuals, control <span class="math inline">\((c)\)</span> and treatment <span class="math inline">\((t)\)</span>, we should estimate the uncertainty variation with respect to the same individual reference on the mentioned metric space. The reason to measure the uncertainty variation with respect to the same reference resides in that even sibling individuals follow an independent ontogenetic development and, consequently, their developments follow independent stochastic processes. This a consequence of the “omnipresent” action of the second law of thermodynamics in living organisms. In the current example, we will create the reference individual by pooling the methylation counts from the embryonic stem cells.</p>
<p>It should be noticed that the results are sensitive to the reference used. The statistics mean, median, or sum of the read counts at each cytosine site of some control samples can be used to create a virtual reference sample. A virtual reference individual can be built with function <a href="https://is.gd/qR79kW">poolFromGRlist</a>. It is up to the user whether to apply the ‘row sum’, ‘row mean’ or ‘row median’ of methylated and unmethylated read counts at each cytosine site across individuals. Notice that when “<em>mean</em>” is selected the virtual reference individual is the group centroid, which play a fundamental role in multivariate statistic.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">Ref</span> <span class="kw">=</span> <span class="fu"><a href="../reference/poolFromGRlist.html">poolFromGRlist</a></span>(<span class="no">ref</span>, <span class="kw">stat</span> <span class="kw">=</span> <span class="st">"mean"</span>, <span class="kw">num.cores</span> <span class="kw">=</span> <span class="fl">6L</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)

<span class="no">Ref</span></pre></body></html></div>
<pre><code>## GRanges object with 1560637 ranges and 2 metadata columns:
##             seqnames    ranges strand |        mC        uC
##                &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;numeric&gt; &lt;numeric&gt;
##         [1]    chr13  19020631      * |         1         1
##         [2]    chr13  19020633      * |         2         2
##         [3]    chr13  19020642      * |         1         1
##         [4]    chr13  19020643      * |         2         2
##         [5]    chr13  19020679      * |         1         1
##         ...      ...       ...    ... .       ...       ...
##   [1560633]    chr13 115108993      * |         1         3
##   [1560634]    chr13 115109022      * |         1         1
##   [1560635]    chr13 115109023      * |         3         4
##   [1560636]    chr13 115109523      * |         2         2
##   [1560637]    chr13 115109524      * |         1         1
##   -------
##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</code></pre>
<p>Only direct lab experiments can reveal whether differences detected with distinct references outside the experimental conditions for control and treatment groups are real. The best reference would be estimated using a subset of individuals from control group. Such a reference will contribute to remove the intragroup variation, in control and in treatment groups, induced by environmental changes external to or not controlled by the experimental conditions.</p>
<p>Methylation analysis for each cytosine position is frequently performed in the bidimensional space of <span class="math inline">\((methylated, unmethylated)\)</span> read counts. Frequently, Fisher’s exact test is applied to a single cytosine position, under the null hypothesis that the proportions <span class="math inline">\(p_{ct}=methylated_{ct}/(methylated_{ct}+unmethylated_{ct})\)</span> and <span class="math inline">\(p_{tt}=methylated_{tt}/(methylated_{tt}+unmethylated_{tt})\)</span> are the same for control and treatment, respectively. In this case, the implicit reference point for the counts at every cytosine positions is <span class="math inline">\((methylated = 0,unmethylated = 0)\)</span>, which corresponds to the point <span class="math inline">\(P_i = (0, 1)\)</span>.</p>
<p>In our case, the Hellinger divergence (one of the metric used, here) of each individual in respect to the reference is the variable to test in place of <span class="math inline">\((methylated, unmethylated)\)</span> read counts or the methylation levels <span class="math inline">\(P_i = (p_i, 1-p_i)\)</span>.</p>
<p>The use of references is restricted by the thermodynamics basis of the theory. The current information-thermodynamics based approach is supported on the following postulate: <em>“High changes of Hellinger divergences are less frequent than low changes, provided that the divergence is proportional to the amount of energy required to process the change of information in the methylation system”</em>.</p>
<p>The last postulate acknowledges the action of the second law of thermodynamics on the biomolecular methylation system. For the methylation system, it implies that the frequencies of the information divergences between methylation levels must be proportional to a Boltzmann factor (see supplementary information from reference <span class="citation">(Sanchez and Mackenzie 2016)</span>). In other words, the frequencies of information divergences values should follow a trend proportional to an exponential decay.</p>
<p>If we do not observe such a behavior, then either the reference is too far from experimental condition or we are dealing with an extreme situation where the methylation machinery in the cell is dysfunctional. The last situation is found, for example, in the silencing mutation at the gene of cytosine-DNA-methyltransferase in Arabidopsis <em>thaliana</em>. Methylation of 5-methylcytosine at CpG dinucleotides is maintained by MET1 in plants.</p>
</div>
<div id="hellinger-divergence-estimation" class="section level2">
<h2 class="hasAnchor">
<a href="#hellinger-divergence-estimation" class="anchor"></a>Hellinger divergence estimation</h2>
<p>To perform the comparison between the uncertainty of methylation levels from each group of individuals, control <span class="math inline">\((c)\)</span> and treatment $(t) $, the divergence between the methylation levels of each individual is estimated with respect to the same reference on the metric space formed by the vector set <span class="math inline">\(P_i = (p_i, 1-p_i)\)</span> and the Hellinger divergence <span class="math inline">\(H\)</span>. Basically, the information divergence between the methylation levels of an individual <span class="math inline">\(j\)</span> and reference sample <span class="math inline">\(r\)</span> is estimated according to the Hellinger divergence given by the formula:</p>
<p><span class="math display">\[H(\hat p_{ij},\hat p_{ir}) = w_i[(\sqrt{\hat p_{ij}} - \sqrt{\hat
p_{ir}})^2+(\sqrt{1-\hat p_{ij}} - \sqrt{1-\hat p_{ir}})^2]\]</span> where $w_i = 2</p>
<p>$, <span class="math inline">\(m_{ij} = {n_i}^{mC_j}+{n_i}^{uC_j}+1\)</span>, <span class="math inline">\(m_{ir} = {n_i}^{mC_r}+ {n_i}^{uC_r}+1\)</span> and <span class="math inline">\(j \in {\{c,t}\}\)</span>.</p>
<p>This equation for Hellinger divergence is given in reference <span class="citation">(Basu, Mandal, and Pardo 2010)</span>, but other information theoretical divergences can be used as well. Next, the information divergence for control (Breast_normal) and treatment (Breast_cancer and Breast_metastasis) samples are estimated with respect to the reference virtual individual. A Bayesian correction of counts can be selected or not. In a Bayesian framework, methylated read counts are modeled by a beta-binomial distribution, which accounts for both the biological and sampling variations <span class="citation">(Hebestreit, Dugas, and Klein 2013; Robinson et al. 2014; Dolzhenko and Smith 2014)</span>.</p>
<p>In our case we adopted the Bayesian approach suggested in reference <span class="citation">(Baldi and Brunak 2001)</span> (Chapter 3). In a Bayesian framework with uniform priors, the methylation level can be defined as: <span class="math inline">\(p = (mC + 1)/ (mC + uC + 2)\)</span>. However, the most natural statistical model for replicated BS-seq DNA methylation measurements is beta-binomial (the beta distribution is a prior conjugate of binomial distribution). We consider the parameter <span class="math inline">\(p\)</span> (methylation level) in the binomial distribution as randomly drawn from a beta distribution. The hyper-parameters <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> from the beta-binomial distribution are interpreted as pseudo-counts. The information divergence is estimated here using the function <a href="https://is.gd/0ViBO9">estimateDivergence</a>:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">HD</span> <span class="kw">=</span> <span class="fu"><a href="../reference/estimateDivergence.html">estimateDivergence</a></span>(<span class="kw">ref</span> <span class="kw">=</span> <span class="no">Ref</span>, <span class="kw">indiv</span> <span class="kw">=</span> <span class="no">LR</span>, <span class="kw">Bayesian</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                        <span class="kw">min.coverage</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">high.coverage</span> <span class="kw">=</span> <span class="fl">300</span>,
                        <span class="kw">percentile</span> <span class="kw">=</span> <span class="fl">0.999</span>, <span class="kw">num.cores</span> <span class="kw">=</span> <span class="fl">6L</span>, <span class="kw">tasks</span> <span class="kw">=</span> <span class="fl">0L</span>,
                        <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)

<span class="no">HD</span>$<span class="no">Breast_cancer</span></pre></body></html></div>
<pre><code>## GRanges object with 584538 ranges and 9 metadata columns:
##            seqnames    ranges strand |        c1        t1        c2        t2
##               &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;
##        [1]    chr13  19020631      * |         1         1        14        24
##        [2]    chr13  19020633      * |         2         2        14        25
##        [3]    chr13  19020643      * |         2         2         7        38
##        [4]    chr13  19020782      * |         1         1         6        56
##        [5]    chr13  19020786      * |         1         1        10        53
##        ...      ...       ...    ... .       ...       ...       ...       ...
##   [584534]    chr13 115108776      * |         1         1        52        20
##   [584535]    chr13 115108789      * |         2         2        27        43
##   [584536]    chr13 115108993      * |         1         3        72         5
##   [584537]    chr13 115109023      * |         3         4        56        36
##   [584538]    chr13 115109524      * |         1         1        31         9
##                           p1                p2                 TV
##                    &lt;numeric&gt;         &lt;numeric&gt;          &lt;numeric&gt;
##        [1] 0.454104856214051 0.390938141872359 -0.131578947368421
##        [2]  0.45434070807688 0.381536829997737 -0.141025641025641
##        [3]  0.45434070807688 0.186316886276701 -0.344444444444444
##        [4] 0.454104856214051 0.121789629914384 -0.403225806451613
##        [5] 0.454104856214051 0.180923689744828 -0.341269841269841
##        ...               ...               ...                ...
##   [584534] 0.454104856214051 0.722219851021173  0.222222222222222
##   [584535]  0.45434070807688 0.397688717430985 -0.114285714285714
##   [584536] 0.451771243822349 0.928153611792893  0.685064935064935
##   [584537] 0.453415070880135 0.611794539917136  0.180124223602485
##   [584538] 0.454104856214051 0.771794032169105              0.275
##                         bay.TV               hdiv
##                      &lt;numeric&gt;          &lt;numeric&gt;
##        [1] -0.0631667143416917 0.0228027372314754
##        [2] -0.0728038780791427 0.0484924086963633
##        [3]  -0.268023821800179  0.770678496718866
##        [4]  -0.332315226299667  0.829702372928104
##        [5]  -0.273181166469223  0.512263189402768
##        ...                 ...                ...
##   [584534]   0.268114994807123  0.436970408874593
##   [584535] -0.0566519906458947 0.0306816345240809
##   [584536]   0.476382367970543   2.89429516403061
##   [584537]   0.158379469037002  0.373542098318946
##   [584538]   0.317689175955054  0.615406476163056
##   -------
##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</code></pre>
<p>Function ‘estimateDivergence’ returns a list of GRanges objects with the four columns of counts, the information divergence, and additional columns:</p>
<pre><code>1. The original matrix of methylated ($c_i$) and unmethylated
    ($t_i$) read counts from control ($i=1$) and treatment ($i=2$) samples.
2. "p1" and "p2": methylation levels for control and treatment,
    respectively.
3. "bay.TV": total variation TV = p2 - p1.
4. "TV": total variation based on simple counts: $TV=c1/(c1+t1)-
    c2/(c2+t2)$.
5. "hdiv": Hellinger divergence.</code></pre>
<p>If Bayesian = TRUE, results are based on the posterior estimations of methylation levels <span class="math inline">\(p1\)</span> and <span class="math inline">\(p2\)</span>. Filtering by coverage is provided at this step which would be used unless previous filtering by coverage had been applied. This is a pairwise filtering. Cytosine sites with ‘coverage’ &gt; ‘min.coverage’ and ‘coverage’ &lt; ‘percentile’ (e.g., 99.9 coverage percentile) in at least one of the samples are preserved. The coverage percentile used is the maximum estimated from both samples: reference and individual.</p>
<p>For some GEO datasets only the methylation levels for each cytosine site are provided. In this case, Hellinger divergence can be estimated as given in reference <span class="citation">(Sanchez and Mackenzie 2016)</span>:</p>
<p><span class="math display">\[H(\hat p_{ij},\hat p_{ir}) = 2 \Big[(\sqrt{\hat p_{ij}} - \sqrt{\hat
p_{ir}})^2+(\sqrt{1-\hat p_{ij}} - \sqrt{1-\hat p_{ir}})^2\Big]\]</span></p>
</div>
<div id="descriptive-statistical-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#descriptive-statistical-analysis" class="anchor"></a><em>Descriptive statistical analysis</em>
</h2>
<p>A descriptive analysis on the distribution of Hellinger divergences of methylation levels is recommended. Like in any other statistical analysis, descriptive statistical analysis help us to detect potential issues in the raw data. It is the user responsibility to perform quality check of his/her dataset before start to apply Methyl-IT. Nevertheless, the quality checking of the raw data is not perfect. So, it is healthy to sees for potential issues.</p>
<div id="histogram-and-boxplots-of-divergences-estimated-in-each-sample" class="section level3">
<h3 class="hasAnchor">
<a href="#histogram-and-boxplots-of-divergences-estimated-in-each-sample" class="anchor"></a><em>Histogram and boxplots of divergences estimated in each sample</em>
</h3>
<p>First, the data of interest (Hellinger divergences, “hdiv”) are selected from the GRanges objects:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">normal</span> <span class="kw">=</span> <span class="no">HD</span>$<span class="no">Breast_normal</span>[, <span class="st">"hdiv"</span>]
<span class="no">normal1</span> <span class="kw">=</span> <span class="no">HD</span>$<span class="no">Breast_normal1</span>[, <span class="st">"hdiv"</span>]
<span class="no">cancer</span> <span class="kw">=</span> <span class="no">HD</span>$<span class="no">Breast_cancer</span>[, <span class="st">"hdiv"</span>]
<span class="no">metastasis</span> <span class="kw">=</span> <span class="no">HD</span>$<span class="no">Breast_metastasis</span>[, <span class="st">"hdiv"</span>]</pre></body></html></div>
<p>Next, a single GRanges object is built from the above set of GRanges objects using the function <a href="https://is.gd/S6e4br">uniqueGRanges</a>. Notice that the number of cores to use for parallel computation can be specified.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">hd</span> <span class="kw">=</span> <span class="fu"><a href="../reference/uniqueGRanges.html">uniqueGRanges</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">normal</span>, <span class="no">normal1</span>, <span class="no">cancer</span>, <span class="no">metastasis</span>),
                    <span class="kw">missing</span> <span class="kw">=</span> <span class="fl">NA</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">num.cores</span> <span class="kw">=</span> <span class="fl">6L</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="fu">mcols</span>(<span class="no">hd</span>)) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"normal"</span>, <span class="st">"normal1"</span>, <span class="st">"cancer"</span>, <span class="st">"metastasis"</span>)
<span class="no">hd</span></pre></body></html></div>
<pre><code>## GRanges object with 793551 ranges and 4 metadata columns:
##            seqnames    ranges strand |               normal             normal1
##               &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; |            &lt;numeric&gt;           &lt;numeric&gt;
##        [1]    chr13  19020631      * |    0.288068219746143    0.28767862804324
##        [2]    chr13  19020633      * |    0.869230665921108   0.714188285613248
##        [3]    chr13  19020643      * |    0.555862275706214   0.560689033273912
##        [4]    chr13  19020680      * |    0.023720232658528  0.0281645245579912
##        [5]    chr13  19020687      * | 7.79397480586338e-05 0.00200990552411886
##        ...      ...       ...    ... .                  ...                 ...
##   [793547]    chr13 115108776      * |    0.575490027087112   0.571096253172782
##   [793548]    chr13 115108789      * |    0.519826661201187   0.491408506478641
##   [793549]    chr13 115108993      * |     2.52414786540235    2.25137133006846
##   [793550]    chr13 115109023      * |     3.03241003774626    2.95959362743878
##   [793551]    chr13 115109524      * |    0.946527350542327   0.920987828967544
##                        cancer           metastasis
##                     &lt;numeric&gt;            &lt;numeric&gt;
##        [1] 0.0228027372314754     2.07603549250268
##        [2] 0.0484924086963633      3.1812220976813
##        [3]  0.770678496718866 0.000733475976828028
##        [4]               &lt;NA&gt;                 &lt;NA&gt;
##        [5]               &lt;NA&gt;                 &lt;NA&gt;
##        ...                ...                  ...
##   [793547]  0.436970408874593                 &lt;NA&gt;
##   [793548] 0.0306816345240809                 &lt;NA&gt;
##   [793549]   2.89429516403061     3.28533077952636
##   [793550]  0.373542098318946    0.671734167824807
##   [793551]  0.615406476163056                 &lt;NA&gt;
##   -------
##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</code></pre>
<p>Now, the Hellinger divergences estimated for each sample are in a single matrix on the metacolumn of the GRanges object and we can proceed to build the histogram and boxplot graphics for these data. Finally, the data included in the graphic are:</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="co"># Define an auxiliar function</span>
<span class="no">fun_length</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>){
    <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(<span class="no">x</span>) + <span class="fl">1</span>, <span class="kw">label</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"n = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">x</span>))))
}

<span class="no">data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">normal</span> <span class="kw">=</span> <span class="no">hd</span>$<span class="no">normal</span>, <span class="kw">normal1</span> <span class="kw">=</span> <span class="no">hd</span>$<span class="no">normal1</span>,
                    <span class="kw">cancer</span> <span class="kw">=</span> <span class="no">hd</span>$<span class="no">cancer</span>, <span class="kw">metastasis</span> <span class="kw">=</span> <span class="no">hd</span>$<span class="no">metastasis</span>)
<span class="no">data</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span>(<span class="no">data</span>))
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">data</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Breast.tissue"</span>, <span class="st">"HD"</span>)
<span class="no">data</span> <span class="kw">=</span> <span class="no">data</span>[<span class="no">data</span>$<span class="no">HD</span> <span class="kw">&gt;</span> <span class="fl">0</span>, ]
<span class="fu">DataFrame</span>(<span class="no">data</span>)</pre></body></html></div>
<pre><code>## DataFrame with 3174204 rows and 2 columns
##           Breast.tissue                   HD
##                &lt;factor&gt;            &lt;numeric&gt;
## 1                normal    0.288068219746143
## 2                normal    0.869230665921108
## 3                normal    0.555862275706214
## 4                normal    0.023720232658528
## 5                normal 7.79397480586338e-05
## ...                 ...                  ...
## NA.617427            NA                   NA
## NA.617428            NA                   NA
## 3174202      metastasis     3.28533077952636
## 3174203      metastasis    0.671734167824807
## NA.617429            NA                   NA</code></pre>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">p1</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">HD</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="no">Breast.tissue</span>, <span class="kw">colour</span> <span class="kw">=</span> <span class="no">Breast.tissue</span>)) +
        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span>(<span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">binwidth</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">position</span> <span class="kw">=</span> <span class="st">"identity"</span>,
                <span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">0.7</span>) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span>(-<span class="fl">0.4</span>,<span class="fl">20</span>) +
        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">axis.title.x</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>),
                <span class="kw">axis.text.x</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>,
                                        <span class="kw">color</span> <span class="kw">=</span>  <span class="st">"black"</span>, <span class="kw">hjust</span> <span class="kw">=</span> <span class="fl">0.5</span>,
                                        <span class="kw">vjust</span> <span class="kw">=</span> <span class="fl">0.75</span>),
        <span class="kw">axis.text.y</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"black"</span>),
        <span class="kw">axis.title.y</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>,<span class="kw">color</span> <span class="kw">=</span> <span class="st">"black"</span>),
        <span class="kw">legend.text</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>),
        <span class="kw">legend.title</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>)) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>( <span class="st">"Counts"</span> ) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Histogram of Hellinger Divergence"</span>)

<span class="co"># For visualization purposes HD is limited to the interval 0 to 50</span>
<span class="no">dt</span> <span class="kw">=</span> <span class="no">data</span>[ <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">data</span>$<span class="no">HD</span> <span class="kw">&lt;</span> <span class="fl">50</span>), ]
<span class="no">p2</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">dt</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">Breast.tissue</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">HD</span> , <span class="kw">fill</span> <span class="kw">=</span> <span class="no">Breast.tissue</span>)) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span>(<span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span>(-<span class="fl">0.1</span>, <span class="fl">20</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span>(<span class="kw">fun.data</span> <span class="kw">=</span> <span class="no">fun_length</span>, <span class="kw">geom</span> <span class="kw">=</span> <span class="st">"text"</span>,
                <span class="kw">position</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span>(<span class="kw">width</span> <span class="kw">=</span> <span class="fl">0.9</span>), <span class="kw">vjust</span> <span class="kw">=</span> <span class="fl">1</span>,
                <span class="kw">size</span> <span class="kw">=</span> <span class="fl">6</span>, <span class="kw">fontface</span> <span class="kw">=</span> <span class="st">"bold"</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">axis.title.x</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>),
        <span class="kw">axis.text.x</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"black"</span>,
                                    <span class="kw">hjust</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">vjust</span> <span class="kw">=</span> <span class="fl">0.75</span>),
        <span class="kw">axis.text.y</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"black"</span>),
        <span class="kw">axis.title.y</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>,<span class="kw">color</span> <span class="kw">=</span> <span class="st">"black"</span>),
        <span class="kw">legend.position</span> <span class="kw">=</span> <span class="st">"none"</span> ) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Boxplot of Hellinger Divergence"</span>)

<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span>(<span class="no">p1</span>, <span class="no">p2</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<pre><code>## Warning: Removed 7 rows containing non-finite values (stat_summary).</code></pre>
<p><img src="cancer_example_files/figure-html/fig1-1.png" width="1920"></p>
<p>Except for the tail, most of the methylation changes occurred under the area covered by the density curve corresponding to the normal breast tissue. This is theoretically expected. This area is explainable in statistical physical terms and, theoretically, it should fit a Weibull distribution. The tails regions cover the methylation changes that, with high probability, are not induced by thermal fluctuation and are not addressed to stabilize the DNA molecule. These changes are methylation signal. Professor David J. Miller (Department of Electrical Engineering, Penn State) proposed modeling the distribution as a mixed Weibull distribution to simultaneously describe the background methylation noise and the methylation signal (personal communication, January, 2018). This model approach seems to be supported by the above histogram, but it must be studied before being incorporated in a future version of Methyl-IT.</p>
</div>
<div id="checking-cytosine-read-counts" class="section level3">
<h3 class="hasAnchor">
<a href="#checking-cytosine-read-counts" class="anchor"></a><em>Checking cytosine read counts</em>
</h3>
<p>According to the parameter values set for the function <a href="https://is.gd/0ViBO9">estimateDivergence</a>, for each cytosine site, at least one individual must have a 10 reads or more, and the maximum coverage must be 500 or less.</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="co"># Maximum coverage at each cytosine site</span>
<span class="no">covr</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/lapply.html">lapply</a></span>(<span class="no">HD</span>, <span class="kw">function</span>(<span class="no">x</span>) {
    <span class="no">cov1</span> <span class="kw">&lt;-</span> <span class="no">x</span>$<span class="no">c1</span> + <span class="no">x</span>$<span class="no">t1</span>
    <span class="no">cov2</span> <span class="kw">&lt;-</span> <span class="no">x</span>$<span class="no">c2</span> + <span class="no">x</span>$<span class="no">t2</span>
    <span class="no">cov</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">cov1</span>, <span class="no">cov2</span>), <span class="fl">1</span>, <span class="no">max</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">cov</span>)
})

<span class="co"># Quantiles</span>
<span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="no">rbind</span>, <span class="fu"><a href="../reference/lapply.html">lapply</a></span>(<span class="no">covr</span>, <span class="kw">function</span>(<span class="no">x</span>) {
    <span class="no">q60</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">x</span>, <span class="fl">0.6</span>)
    <span class="no">q9999</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">x</span>, <span class="fl">0.9999</span>)
    <span class="no">idx1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">x</span> <span class="kw">&gt;=</span> <span class="no">q60</span>)
    <span class="no">idx2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">x</span> <span class="kw">&lt;=</span> <span class="fl">500</span>)
    <span class="no">q95</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">x</span>, <span class="fl">0.95</span>)

    <span class="no">idx</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html">intersect</a></span>(<span class="no">idx1</span>, <span class="no">idx2</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">x</span>)), <span class="no">q60</span>,
            <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.95</span>, <span class="fl">0.99</span>, <span class="fl">0.999</span>, <span class="fl">0.9999</span>)),
            <span class="kw">num.siteGreater_8</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">x</span> <span class="kw">&gt;=</span> <span class="fl">8</span>),
            <span class="kw">q60_to_500</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>((<span class="no">x</span> <span class="kw">&gt;=</span> <span class="no">q60</span>) <span class="kw">&amp;</span> (<span class="no">x</span> <span class="kw">&lt;=</span> <span class="fl">500</span>)),
            <span class="kw">num.siteGreater_500</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">x</span> <span class="kw">&gt;</span> <span class="fl">500</span>)))})
)</pre></body></html></div>
<pre><code>##                   Min. 1st Qu. Median Mean 3rd Qu. Max. 60% 95% 99% 99.9%
## Breast_normal        5      19     30   31      41  291  34  57  69    81
## Breast_cancer        5      18     31   37      51  266  38  88 112   137
## Breast_metastasis    5      14     27   31      43  281  32  70  91   115
## Breast_normal1       5      17     26   27      35  279  29  48  58    68
##                     99.99% num.siteGreater_8 q60_to_500 num.siteGreater_500
## Breast_normal      94.0000            747005     319227                   0
## Breast_cancer     165.0000            569474     234247                   0
## Breast_metastasis 158.8469            435153     187884                   0
## Breast_normal1     80.0000            738787     318786                   0</code></pre>
<p>The quantiles indicates acceptable values for the coverages. Descriptive statistics for methylated reads can be checked as well.</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="co"># Maximum coverage at each cytosine site</span>
<span class="no">methc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/lapply.html">lapply</a></span>(<span class="no">HD</span>, <span class="kw">function</span>(<span class="no">x</span>) {
    <span class="no">r</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">x</span>$<span class="no">c1</span>, <span class="no">x</span>$<span class="no">c2</span>), <span class="fl">1</span>, <span class="no">max</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">r</span>)
})

<span class="co"># Quantiles</span>
<span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="no">rbind</span>, <span class="fu"><a href="../reference/lapply.html">lapply</a></span>(<span class="no">methc</span>, <span class="kw">function</span>(<span class="no">x</span>) {
    <span class="no">q10</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">x</span>, <span class="fl">0.1</span>)
    <span class="no">q60</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">x</span>, <span class="fl">0.6</span>)
    <span class="no">q9999</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">x</span>, <span class="fl">0.9999</span>)
    <span class="no">idx1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">x</span> <span class="kw">&gt;=</span> <span class="no">q60</span>)
    <span class="no">idx2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">x</span> <span class="kw">&lt;=</span> <span class="fl">500</span>)
    <span class="no">q95</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">x</span>, <span class="fl">0.95</span>)

    <span class="no">idx</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html">intersect</a></span>(<span class="no">idx1</span>, <span class="no">idx2</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">x</span>)), <span class="no">q10</span>, <span class="no">q60</span>,
            <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.95</span>, <span class="fl">0.99</span>, <span class="fl">0.999</span>, <span class="fl">0.9999</span>)),
            <span class="kw">num.siteGreater_8</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">x</span> <span class="kw">&gt;=</span> <span class="fl">8</span>),
            <span class="kw">q60_to_500</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>((<span class="no">x</span> <span class="kw">&gt;=</span> <span class="no">q60</span>) <span class="kw">&amp;</span> (<span class="no">x</span> <span class="kw">&lt;=</span> <span class="fl">500</span>)),
            <span class="kw">num.siteGreater_500</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">x</span> <span class="kw">&gt;</span> <span class="fl">500</span>)))})
)</pre></body></html></div>
<pre><code>##                   Min. 1st Qu. Median Mean 3rd Qu. Max. 10% 60% 95% 99% 99.9%
## Breast_normal        4      14     24   25      34  265   7  28  49  60    72
## Breast_cancer        4      10     21   27      38  252   5  27  74  98   123
## Breast_metastasis    4       7     16   21      30  234   4  21  56  75    98
## Breast_normal1       4      12     20   21      29  258   6  24  41  50    60
##                     99.99% num.siteGreater_8 q60_to_500 num.siteGreater_500
## Breast_normal      84.0000            677552     309300                   0
## Breast_cancer     149.5463            472596     237092                   0
## Breast_metastasis 121.0000            328544     184064                   0
## Breast_normal1     70.0000            664530     304195                   0</code></pre>
<p>The critical values from empirical cumulative probability distributions will be used in the downstream analysis.</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="no">critical.val</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="no">rbind</span>, <span class="fu"><a href="../reference/lapply.html">lapply</a></span>(<span class="no">HD</span>, <span class="kw">function</span>(<span class="no">x</span>) {
    <span class="no">hd.95</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">x</span>$<span class="no">hdiv</span>, <span class="fl">0.95</span>)
    <span class="no">tv.95</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="no">x</span>$<span class="no">bay.TV</span>), <span class="fl">0.95</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">tv</span> <span class="kw">=</span> <span class="no">tv.95</span>, <span class="kw">hd</span> <span class="kw">=</span> <span class="no">hd.95</span>))
}))

<span class="no">critical.val</span></pre></body></html></div>
<pre><code>##                      tv.95%   hd.95%
## Breast_normal     0.5044770 3.787033
## Breast_cancer     0.5186583 4.385264
## Breast_metastasis 0.5106559 4.030725
## Breast_normal1    0.4903243 3.278097</code></pre>
</div>
</div>
<div id="nonlinear-fit-of-probability-distribution-models" class="section level2">
<h2 class="hasAnchor">
<a href="#nonlinear-fit-of-probability-distribution-models" class="anchor"></a>Nonlinear fit of probability distribution models</h2>
<p>A basic requirement for the application of signal detection is the knowledge of the probability distribution of the background noise. Probability distribution, as a Weibull distribution model, can be deduced on a statistical mechanical/thermodynamics basis for DNA methylation induced by thermal fluctuations <span class="citation">(Sanchez and Mackenzie 2016)</span>.</p>
<p>Assuming that this background methylation variation is consistent with a Poisson process, it can be distinguished from variation associated with methylation regulatory machinery, which is non-independent for all genomic regions <span class="citation">(Sanchez and Mackenzie 2016)</span>. An information-theoretic divergence to express the variation in methylation induced by background thermal fluctuations will follow a Weibull distribution model, provided that it is proportional to the minimum energy dissipated per bit of information associated with the methylation change.</p>
<p>The nonlinear fit to a Weibull distribution model is performed by the function <a href="https://is.gd/0BLLkT">nonlinearFitDist</a>. In general, an information divergence of methylation levels will follow a probability distribution from the family of generalized gamma distribution. Next, the best fitted model will be selected from one of the following distributions: two- and three-parameter Weibull distributions, gamma with two- and three-parameters (“Gamma2P” or “Gamma3P”), and generalized gamma with three-parameter (“GGamma3P”).</p>
<p>The best model is selected on the basis of Akaike’s information criterion and the correlation coefficient of cross-validations for the nonlinear regressions (R.Cross.val). These criteria evaluate different information inferred from the models. AIC deals with the trade-off between the goodness of fit (GOF) of the model and the complexity of the model, while R.Cross.val provides information on the prediction power/performance of the model when confronted with external dataset. Cross-validations for the nonlinear regressions (R.Cross.val) were performed as described in reference <span class="citation">(Stevens 2009)</span>. In addition, Stein’s formula for adjusted R squared (<span class="math inline">\(\rho\)</span>) was used as an estimator of the average cross-validation predictive power <span class="citation">(Stevens 2009)</span>.</p>
<p>In general, the best fitted model yields the best DMP classification performance (see below). However, on special dataset, as the used in the current example. Function <a href="https://is.gd/W7dlP0">gofReport</a> search for the best fitted model between the set of models requested by the user.</p>
<p>The best model including “GGamma3P” model:</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="no">d</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Weibull2P"</span>, <span class="st">"Weibull3P"</span>, <span class="st">"Gamma2P"</span>, <span class="st">"Gamma3P"</span>, <span class="st">"GGamma3P"</span>)
<span class="no">gof_1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/gofReport.html">gofReport</a></span>(<span class="kw">HD</span> <span class="kw">=</span> <span class="no">HD</span>, <span class="kw">column</span> <span class="kw">=</span> <span class="fl">9L</span>, <span class="kw">model</span> <span class="kw">=</span> <span class="no">d</span>, <span class="kw">num.cores</span> <span class="kw">=</span> <span class="fl">6L</span>,
                    <span class="kw">output</span> <span class="kw">=</span> <span class="st">"all"</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
<pre><code>## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |======================================================================| 100%
## 
##  *** Creating report ...</code></pre>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="no">gof_1</span>$<span class="no">bestModel</span></pre></body></html></div>
<pre><code>##     Breast_normal     Breast_cancer Breast_metastasis    Breast_normal1 
##        "GGamma3P"        "GGamma3P"        "GGamma3P"        "GGamma3P"</code></pre>
<p>The best model excluding “GGamma3P” model:</p>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="no">d</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Weibull2P"</span>, <span class="st">"Weibull3P"</span>, <span class="st">"Gamma2P"</span>, <span class="st">"Gamma3P"</span>)
<span class="no">gof_2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/gofReport.html">gofReport</a></span>(<span class="kw">HD</span> <span class="kw">=</span> <span class="no">HD</span>, <span class="kw">column</span> <span class="kw">=</span> <span class="fl">9L</span>, <span class="kw">model</span> <span class="kw">=</span> <span class="no">d</span>, <span class="kw">num.cores</span> <span class="kw">=</span> <span class="fl">6L</span>,
                    <span class="kw">output</span> <span class="kw">=</span> <span class="st">"all"</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
<pre><code>## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |======================================================================| 100%
## 
##  *** Creating report ...</code></pre>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="no">gof_2</span>$<span class="no">bestModel</span></pre></body></html></div>
<pre><code>##     Breast_normal     Breast_cancer Breast_metastasis    Breast_normal1 
##       "Weibull2P"         "Gamma2P"         "Gamma2P"       "Weibull2P"</code></pre>
<p>When “GGamma3P” model is included, the goodness-of-fit indicators used here suggest that it is best fitted model. However, a final decision must take into account the DMP classification performance as well (see below), which is accomplished after a signal detection step. The reader must keep in mind that we are dealing here with numerical algorithms, which are not perfect. Depending on dataset, the numerical computation will confront different challengers. The difference between g3p_R.Cross.val and gg3p_R.Cross.val suggests that model predictions powers for “GGamma3P” and “Gamma3P” are close.</p>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="no">gof_1</span>$<span class="no">stats</span></pre></body></html></div>
<pre><code>##                    w2p_AIC w2p_R.Cross.val w3p_AIC w3p_R.Cross.val  g2p_AIC
## Breast_normal     -3083858       0.9950587      NA              NA -3000096
## Breast_cancer     -1846819       0.9878989      NA              NA -1967840
## Breast_metastasis -1465762       0.9871201      NA              NA -1643581
## Breast_normal1    -3630240       0.9974563      NA              NA -3478122
##                   g2p_R.Cross.val g3p_AIC g3p_R.Cross.val gg3p_AIC
## Breast_normal           0.9932869     Inf               0 -4102368
## Breast_cancer           0.9883060     Inf               0 -2597724
## Breast_metastasis       0.9906769     Inf               0 -2150421
## Breast_normal1          0.9967128     Inf               0 -5253037
##                   gg3p_R.Cross.val bestModel
## Breast_normal            0.9983766      gg3p
## Breast_cancer            0.9959062      gg3p
## Breast_metastasis        0.9969623      gg3p
## Breast_normal1           0.9996704      gg3p</code></pre>
<p>It is worthy to observe that although in the current example we successfully performed the nonlinear fit for GGamma3P model, this is not the general case when the number of cytosine sites goes close or above <span class="math inline">\(10^6\)</span>, for which the computational cost is very high. The nonlinear fit of GGamma3P or GGamma4P is, in general, difficult since two different set of estimated parameters could produce very close distribution curves. Also, it is important to check the value of the scaling parameter from each distribution. The numerical algorithms could find the best fitted model with scaling parameter values close to zero, say e.g. <span class="math inline">\(10^{-8}\)</span>, and with the highest GOFs. Situations like this are biologically meaningless and the fitted models must be discarded <span class="citation">(Sanchez and Mackenzie 2016)</span>.</p>
</div>
<div id="signal-detection" class="section level2">
<h2 class="hasAnchor">
<a href="#signal-detection" class="anchor"></a>Signal detection</h2>
<p>The information thermodynamics-based approach is postulated to provide greater sensitivity for resolving true signal from the thermodynamic background within the methylome <span class="citation">(Sanchez and Mackenzie 2016)</span>. Since the biological signal created within the dynamic methylome environment characteristic of living organisms is not free from background noise, the approach, designated Methyl-IT, includes the application of signal detection theory <span class="citation">(Greiner, Pfeiffer, and Smith 2000; Carter et al. 2016; Harpaz et al. 2013; Kruspe et al. 2017)</span>. Signal detection is a critical step to increase sensitivity and resolution of methylation signal by reducing the signal-to-noise ratio and objectively controlling the false positive rate and prediction accuracy/risk.</p>
</div>
<div id="potential-methylation-signal" class="section level2">
<h2 class="hasAnchor">
<a href="#potential-methylation-signal" class="anchor"></a><em>Potential methylation signal</em>
</h2>
<p>The first estimation in our signal detection step is the identification of the cytosine sites carrying potential methylation signal <span class="math inline">\(PS\)</span>. The methylation regulatory signal does not hold the theoretical distribution and, consequently, for a given level of significance <span class="math inline">\(\alpha\)</span> (Type I error probability, e.g. <span class="math inline">\(\alpha = 0.05\)</span>), cytosine positions <span class="math inline">\(k\)</span> with information divergence <span class="math inline">\(H_k &gt;= H_{\alpha = 0.05}\)</span> can be selected as sites carrying potential signals <span class="math inline">\(PS\)</span>. The value of <span class="math inline">\(\alpha\)</span> can be specified.</p>
<p>For example, potential signals with <span class="math inline">\(H_k &gt; H_{\alpha = 0.01}\)</span> can be selected. For each sample, cytosine sites are selected based on the corresponding fitted theoretical distribution model estimated in the previous step. Additionally, since cytosine with <span class="math inline">\(|TV_{d_k}| &lt; 0.1\)</span> are the most abundant sites, depending on the sample (experiment), cytosine positions <span class="math inline">\(k\)</span> with <span class="math inline">\(H_k &gt;= H_{\alpha = 0.05}\)</span> and <span class="math inline">\(|TV_{d_k}| &lt; 0.1\)</span> can be observed. To prevent the last situation we can select the <span class="math inline">\(PS\)</span> with the additional constraint <span class="math inline">\(|TV_{d_k}| &gt; TV_0\)</span>, where <span class="math inline">\(TV_0\)</span> (‘tv.cut’) is a user specified value. The <span class="math inline">\(PS\)</span> is detected with the function <a href="https://is.gd/yGORtg">getPotentialDIMP</a>:</p>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="no">PS1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/getPotentialDIMP.html">getPotentialDIMP</a></span>(<span class="kw">LR</span> <span class="kw">=</span> <span class="no">HD</span>, <span class="kw">dist.name</span> <span class="kw">=</span> <span class="no">gof_1</span>$<span class="no">bestModel</span>, <span class="kw">nlms</span> <span class="kw">=</span> <span class="no">gof_1</span>$<span class="no">nlms</span>,
                        <span class="kw">div.col</span> <span class="kw">=</span> <span class="fl">9</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.05</span>, <span class="kw">tv.col</span> <span class="kw">=</span> <span class="fl">8</span>, <span class="kw">tv.cut</span> <span class="kw">=</span> <span class="fl">0.5</span>)
<span class="no">PS2</span> <span class="kw">=</span> <span class="fu"><a href="../reference/getPotentialDIMP.html">getPotentialDIMP</a></span>(<span class="kw">LR</span> <span class="kw">=</span> <span class="no">HD</span>, <span class="kw">dist.name</span> <span class="kw">=</span> <span class="no">gof_2</span>$<span class="no">bestModel</span>, <span class="kw">nlms</span> <span class="kw">=</span> <span class="no">gof_2</span>$<span class="no">nlms</span>,
                        <span class="kw">div.col</span> <span class="kw">=</span> <span class="fl">9</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.05</span>, <span class="kw">tv.col</span> <span class="kw">=</span> <span class="fl">8</span>, <span class="kw">tv.cut</span> <span class="kw">=</span> <span class="fl">0.5</span>)
<span class="no">PS1</span>$<span class="no">Breast_normal</span></pre></body></html></div>
<pre><code>## GRanges object with 20170 ranges and 10 metadata columns:
##           seqnames    ranges strand |        c1        t1        c2        t2
##              &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;
##       [1]    chr13  19082356      * |         2         3        32         0
##       [2]    chr13  19177615      * |         4         4        23         0
##       [3]    chr13  19240007      * |         2         2        47         0
##       [4]    chr13  19240932      * |         3         3        32         0
##       [5]    chr13  19296278      * |         3         3        28         0
##       ...      ...       ...    ... .       ...       ...       ...       ...
##   [20166]    chr13 115096223      * |         2         2        44         0
##   [20167]    chr13 115096666      * |         3         3        34         0
##   [20168]    chr13 115097021      * |         3         3        21         0
##   [20169]    chr13 115097976      * |         2         2        42         0
##   [20170]    chr13 115098695      * |         5         6        27         0
##                          p1                p2                TV
##                   &lt;numeric&gt;         &lt;numeric&gt;         &lt;numeric&gt;
##       [1] 0.451273311018461 0.966917401618622               0.6
##       [2]  0.45304420669874 0.956663168622331               0.5
##       [3] 0.452523760640444 0.976274020307531               0.5
##       [4]  0.45278541784448 0.966917401618622               0.5
##       [5]  0.45278541784448  0.96302946432176               0.5
##       ...               ...               ...               ...
##   [20166] 0.452523760640444 0.974851489843536               0.5
##   [20167]  0.45278541784448 0.968570038217104               0.5
##   [20168]  0.45278541784448 0.953457324516072               0.5
##   [20169] 0.452523760640444 0.973804423693521               0.5
##   [20170] 0.452068007958716 0.961910370769917 0.545454545454545
##                      bay.TV             hdiv                wprob
##                   &lt;numeric&gt;        &lt;numeric&gt;            &lt;numeric&gt;
##       [1]  0.51564409060016 4.15703316933603   0.0123894226716491
##       [2]  0.50361896192359 4.91437397287391 0.000710758152019684
##       [3] 0.523750259667087  4.0095064341879    0.018433872546532
##       [4] 0.514131983774142 4.70737325955354  0.00182094549570408
##       [5]  0.51024404647728 4.45308383566372  0.00485450539495913
##       ...               ...              ...                  ...
##   [20166] 0.522327729203092  3.9325618899715   0.0223160365851342
##   [20167] 0.515784620372624 4.82115443364787   0.0011045175272428
##   [20168] 0.500671906671593 3.89487903785825   0.0244132962250764
##   [20169] 0.521280663053077 3.87742927411522   0.0254294742316257
##   [20170] 0.509842362811201 6.58905765063053 1.85491151602445e-10
##   -------
##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</code></pre>
<div class="sourceCode" id="cb35"><html><body><pre class="r"><span class="no">PS2</span>$<span class="no">Breast_normal</span></pre></body></html></div>
<pre><code>## GRanges object with 8919 ranges and 10 metadata columns:
##          seqnames    ranges strand |        c1        t1        c2        t2
##             &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;
##      [1]    chr13  19177615      * |         4         4        23         0
##      [2]    chr13  19240932      * |         3         3        32         0
##      [3]    chr13  19366559      * |         3         3        41         0
##      [4]    chr13  19377594      * |         3         5        40         1
##      [5]    chr13  19403993      * |         4         4        26         0
##      ...      ...       ...    ... .       ...       ...       ...       ...
##   [8915]    chr13 115090609      * |         4         4        60         1
##   [8916]    chr13 115090684      * |         4         4        76         2
##   [8917]    chr13 115094605      * |         3         3        38         0
##   [8918]    chr13 115096666      * |         3         3        34         0
##   [8919]    chr13 115098695      * |         5         6        27         0
##                         p1                p2                TV
##                  &lt;numeric&gt;         &lt;numeric&gt;         &lt;numeric&gt;
##      [1]  0.45304420669874 0.956663168622331               0.5
##      [2]  0.45278541784448 0.966917401618622               0.5
##      [3]  0.45278541784448 0.973247499292334               0.5
##      [4] 0.450303646023985 0.951987253109134 0.600609756097561
##      [5]  0.45304420669874 0.960721412782865               0.5
##      ...               ...               ...               ...
##   [8915]  0.45304420669874 0.966311688871077 0.483606557377049
##   [8916]  0.45304420669874 0.961226987328427 0.474358974358974
##   [8917]  0.45278541784448 0.971424962282638               0.5
##   [8918]  0.45278541784448 0.968570038217104               0.5
##   [8919] 0.452068007958716 0.961910370769917 0.545454545454545
##                     bay.TV             hdiv              wprob
##                  &lt;numeric&gt;        &lt;numeric&gt;          &lt;numeric&gt;
##      [1]  0.50361896192359 4.91437397287391 0.0391864397601092
##      [2] 0.514131983774142 4.70737325955354 0.0453083217221566
##      [3] 0.520462081447855  5.1642065228043 0.0328714151704236
##      [4] 0.501683607085148 5.41958287747074 0.0274509788905275
##      [5] 0.507677206084125 5.22970386210739 0.0313884759937581
##      ...               ...              ...                ...
##   [8915] 0.513267482172336 6.36926774422415 0.0139793042162816
##   [8916] 0.508182780629686 6.28477237221604 0.0148485285739722
##   [8917] 0.518639544438159 5.02660979748285  0.036214397027718
##   [8918] 0.515784620372624 4.82115443364787 0.0418357714100688
##   [8919] 0.509842362811201 6.58905765063053 0.0119463110012273
##   -------
##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</code></pre>
<p>Model “GGamma3P” reported 20263 - 11314 = 8949 more DMPs in the normal tissue than model “Gamma3P”.</p>
<p>Notice that the total variation distance <span class="math inline">\(TV_d=|TV|\)</span> is an information divergence as well and that it can be used in place of Hellinger divergence <span class="citation">(Sanchez and Mackenzie 2016)</span>. The set of vectors <span class="math inline">\(P_i = (p_i, 1-p_i)\)</span> and distance function <span class="math inline">\(TV_d\)</span> integrate a metric space <span class="citation">(Sanchez et al. 2019)</span>. In particular, after takes the Manhattan distance between healthy individuals and patients methylation levels we have:</p>
<p><span class="math display">\[M_d(p_{ij}, p_{ir})=\frac{1}{2}(|\hat p_{ij} - \hat p_{ir}| + |
(1-\hat p_{ij}) - (1-\hat p_{ir})|)=|\hat p_{ij} - \hat p_{ir}|=TV_d(p_{ij},
p_{ir})\]</span>.</p>
<p>That is, the absolute difference of methylation levels is a particular case of Manhattan distance, which is named total variation distance <span class="math inline">\(TV_d\)</span>. The quantitative effect of the vector components <span class="math inline">\(1-\hat p_{ij}\)</span> and <span class="math inline">\(1-\hat p_{ir}\)</span> (in our case, the effect of unmethylated read counts) is not present in <span class="math inline">\(TV_d\)</span> as in <span class="math inline">\(H(\hat p_{ij},\hat p_{ir})\)</span>.</p>
</div>
<div id="histogram-and-boxplots-of-methylation-potential-signals" class="section level2">
<h2 class="hasAnchor">
<a href="#histogram-and-boxplots-of-methylation-potential-signals" class="anchor"></a><em>Histogram and boxplots of methylation potential signals</em>
</h2>
<p>As before, a single GRanges object is built from the above set GRanges objects using the function <a href="https://is.gd/S6e4br">uniqueGRanges</a>, and the Hellinger divergences of the cytosine sites carrying <span class="math inline">\(PS\)</span> (for each sample) are located in a single matrix on the metacolumn of the GRanges object.</p>
<div class="sourceCode" id="cb37"><html><body><pre class="r"><span class="co"># Define an auxiliar function</span>
<span class="no">fun_length</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>){
    <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(<span class="no">x</span>) + <span class="fl">1.5</span>, <span class="kw">label</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"n = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">x</span>))))
}

<span class="co"># The data to be used in the boxplot</span>
<span class="no">ps1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/uniqueGRanges.html">uniqueGRanges</a></span>(<span class="no">PS1</span>, <span class="kw">missing</span> <span class="kw">=</span> <span class="fl">NA</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">9</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
                    <span class="kw">num.cores</span> <span class="kw">=</span> <span class="fl">6L</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="fu">mcols</span>(<span class="no">ps1</span>)) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"normal"</span>, <span class="st">"cancer"</span>, <span class="st">"metastasis"</span>, <span class="st">"normal1"</span>)
<span class="no">dat1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">normal</span> <span class="kw">=</span> <span class="no">ps1</span>$<span class="no">normal</span>, <span class="kw">normal1</span> <span class="kw">=</span> <span class="no">ps1</span>$<span class="no">normal1</span>,
                <span class="kw">cancer</span> <span class="kw">=</span> <span class="no">ps1</span>$<span class="no">cancer</span>, <span class="kw">metastasis</span> <span class="kw">=</span> <span class="no">ps1</span>$<span class="no">metastasis</span>)
<span class="no">dat1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span>(<span class="no">dat1</span>))
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">dat1</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Breast.tissue"</span>, <span class="st">"HD"</span>)
<span class="no">idx</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">dat1</span>$<span class="no">HD</span>))
<span class="no">dat1</span> <span class="kw">&lt;-</span> <span class="no">dat1</span>[-<span class="no">idx</span>, ] <span class="co"># To remove missing data</span>

<span class="no">ps2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/uniqueGRanges.html">uniqueGRanges</a></span>(<span class="no">PS2</span>, <span class="kw">missing</span> <span class="kw">=</span> <span class="fl">NA</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">9</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
                    <span class="kw">num.cores</span> <span class="kw">=</span> <span class="fl">6L</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="fu">mcols</span>(<span class="no">ps2</span>)) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"normal"</span>, <span class="st">"cancer"</span>, <span class="st">"metastasis"</span>, <span class="st">"normal1"</span>)
<span class="no">dat2</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">normal</span> <span class="kw">=</span> <span class="no">ps2</span>$<span class="no">normal</span>, <span class="kw">normal1</span> <span class="kw">=</span> <span class="no">ps2</span>$<span class="no">normal1</span>,
        <span class="kw">cancer</span> <span class="kw">=</span> <span class="no">ps2</span>$<span class="no">cancer</span>, <span class="kw">metastasis</span> <span class="kw">=</span> <span class="no">ps2</span>$<span class="no">metastasis</span>)
<span class="no">dat2</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span>(<span class="no">dat2</span>))
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">dat2</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Breast.tissue"</span>, <span class="st">"HD"</span>)
<span class="no">idx</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">dat2</span>$<span class="no">HD</span>))
<span class="no">dat2</span> <span class="kw">&lt;-</span> <span class="no">dat2</span>[-<span class="no">idx</span>, ] <span class="co"># To remove missing data</span>

<span class="no">p1</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">dat1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">HD</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="no">Breast.tissue</span>, <span class="kw">colour</span> <span class="kw">=</span> <span class="no">Breast.tissue</span>)) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span>(<span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">bins</span> <span class="kw">=</span> <span class="fl">50</span>, <span class="kw">position</span> <span class="kw">=</span> <span class="st">"identity"</span>,
        <span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">0.7</span>) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="st">"Counts"</span>) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span>(<span class="fl">0</span>,<span class="fl">30</span>) +
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">axis.title.x</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>),
        <span class="kw">axis.text.x</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"black"</span>,
                                <span class="kw">hjust</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">vjust</span> <span class="kw">=</span> <span class="fl">0.75</span>),
        <span class="kw">axis.text.y</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"black"</span>),
        <span class="kw">axis.title.y</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>,<span class="kw">color</span> <span class="kw">=</span> <span class="st">"black"</span>),
        <span class="kw">legend.text</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>),
        <span class="kw">legend.title</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>) ) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Histogram for Potential methylation signal. GGamma3P"</span>)

<span class="no">p2</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">dat1</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">Breast.tissue</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">HD</span> , <span class="kw">fill</span> <span class="kw">=</span> <span class="no">Breast.tissue</span>)) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span>(<span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span>(<span class="fl">0</span>, <span class="fl">15</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span>(<span class="kw">fun.data</span> <span class="kw">=</span> <span class="no">fun_length</span>, <span class="kw">geom</span> <span class="kw">=</span> <span class="st">"text"</span>, <span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                <span class="kw">position</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span>(<span class="kw">width</span> <span class="kw">=</span> <span class="fl">0.9</span>), <span class="kw">vjust</span> <span class="kw">=</span> <span class="fl">1</span>,
                <span class="kw">size</span> <span class="kw">=</span> <span class="fl">6</span>, <span class="kw">fontface</span> <span class="kw">=</span> <span class="st">"bold"</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span>(<span class="kw">yintercept</span> <span class="kw">=</span> <span class="fl">6</span>, <span class="kw">linetype</span><span class="kw">=</span><span class="st">"dashed"</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"red"</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">axis.title.x</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>),
        <span class="kw">axis.text.x</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"black"</span>,
                                    <span class="kw">hjust</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">vjust</span> <span class="kw">=</span> <span class="fl">0.75</span>),
        <span class="kw">axis.text.y</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"black"</span>),
        <span class="kw">axis.title.y</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>,<span class="kw">color</span> <span class="kw">=</span> <span class="st">"black"</span>),
        <span class="kw">legend.position</span> <span class="kw">=</span> <span class="st">"none"</span> ) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Boxplot for Potential methylation signal. GGamma3P"</span>)


<span class="no">p3</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">dat2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">HD</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="no">Breast.tissue</span>, <span class="kw">colour</span> <span class="kw">=</span> <span class="no">Breast.tissue</span>)) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span>(<span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">bins</span> <span class="kw">=</span> <span class="fl">50</span>, <span class="kw">position</span> <span class="kw">=</span> <span class="st">"identity"</span>,
        <span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">0.7</span>) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="st">"Counts"</span>) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span>(<span class="fl">0</span>,<span class="fl">30</span>) +
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">axis.title.x</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>),
        <span class="kw">axis.text.x</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"black"</span>,
                                    <span class="kw">hjust</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">vjust</span> <span class="kw">=</span> <span class="fl">0.75</span>),
        <span class="kw">axis.text.y</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"black"</span>),
        <span class="kw">axis.title.y</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>,<span class="kw">color</span> <span class="kw">=</span> <span class="st">"black"</span>),
        <span class="kw">legend.text</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>),
        <span class="kw">legend.title</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>)) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Histogram for Potential methylation signal. Gamma3P"</span>)

<span class="no">p4</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">dat2</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">Breast.tissue</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">HD</span> , <span class="kw">fill</span> <span class="kw">=</span> <span class="no">Breast.tissue</span>)) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span>(<span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span>(<span class="fl">0</span>, <span class="fl">15</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span>(<span class="kw">fun.data</span> <span class="kw">=</span> <span class="no">fun_length</span>, <span class="kw">geom</span> <span class="kw">=</span> <span class="st">"text"</span>, <span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                <span class="kw">position</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span>(<span class="kw">width</span> <span class="kw">=</span> <span class="fl">0.9</span>), <span class="kw">vjust</span> <span class="kw">=</span> <span class="fl">1</span>,
                <span class="kw">size</span> <span class="kw">=</span> <span class="fl">6</span>, <span class="kw">fontface</span> <span class="kw">=</span> <span class="st">"bold"</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span>(<span class="kw">yintercept</span> <span class="kw">=</span> <span class="fl">6</span>, <span class="kw">linetype</span><span class="kw">=</span><span class="st">"dashed"</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"red"</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">axis.title.x</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>),
        <span class="kw">axis.text.x</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"black"</span>,
                                    <span class="kw">hjust</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">vjust</span> <span class="kw">=</span> <span class="fl">0.75</span>),
        <span class="kw">axis.text.y</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"black"</span>),
        <span class="kw">axis.title.y</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>,<span class="kw">color</span> <span class="kw">=</span> <span class="st">"black"</span>),
        <span class="kw">legend.position</span> <span class="kw">=</span> <span class="st">"none"</span> ) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Boxplot for Potential methylation signal. Gamma3P"</span>)

<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span>(<span class="no">p1</span>, <span class="no">p2</span>, <span class="no">p3</span>, <span class="no">p4</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<p><img src="cancer_example_files/figure-html/fig2-1.png" width="1920"></p>
<p>The graphics show that “Gamma3P” provides more information on the discrimination of treatment potential DMPs from the control.</p>
</div>
<div id="cutpoint-estimation-laws-of-statistical-physics-can-account-for-background" class="section level2">
<h2 class="hasAnchor">
<a href="#cutpoint-estimation-laws-of-statistical-physics-can-account-for-background" class="anchor"></a>Cutpoint estimation Laws of statistical physics can account for background</h2>
<p>methylation, a response to thermal fluctuations that presumably functions in DNA stability <span class="citation">(Sanchez and Mackenzie 2016; Sanchez et al. 2019)</span>. True signal is detected based on the optimal cutpoint <span class="citation">(López-Ratón et al. 2014)</span>, which can be estimated from the area under the curve (AUC) of a receiver operating characteristic (ROC) curve built from a logistic regression performed with the potential signals from controls and treatments. The ROC AUC is equivalent to the probability that a randomly- chosen positive instance is ranked more highly than a randomly-chosen negative instance <span class="citation">(Fawcett 2005)</span>. In the current context, the AUC is equivalent to the probability to distinguish a randomly-chosen methylation regulatory signal induced by the treatment from a randomly-chosen signal in the control.</p>
<p>The need for the application of (what is now known as) signal detection in cancer research was pointed out by Youden in the midst of the last century <span class="citation">(Youden 1950)</span>. In the next example, the simple cutpoint estimation available in Methyl-IT is based on the application of <a href="https://is.gd/t8UKvK">Youden index</a> <span class="citation">(Youden 1950)</span>. Although cutpoints are estimated for a single variable, the classification performance can be evaluated for several variables and applying different model classifiers. A optimal cutpoint distinguishes disease stages from healthy individual. The performance of this classification is given in the output of function <a href="https://is.gd/RR9iWY">estimateCutPoint</a>.</p>
<p>A model classifier can be requested for further predictions and its classification performance is also provided. Below, the selected model classifier is a quadratic discriminant analysis (QDA) (<em>classifier1</em> = “qda”, <em>clas.perf</em> = TRUE). Four predictor variables are available: the Hellinger divergence of methylation levels (<em>hdiv</em>), total variation distance (<em>TV</em>, absolute difference of methylation levels), relative position of cytosine site in the chromosome (<em>pos</em>), and the logarithm base two of the probability to observe a Hellinger divergence value <span class="math inline">\(H\)</span> greater than the critical value <span class="math inline">\(H_{\alpha = 0.05}\)</span> (values given as probabilities in object PS, <em>wprob</em>).</p>
<p>Notice that the cutpoint can be estimated for any of the two currently available information divergences: <em>Hellinger divergence</em> (<em>div.col</em> = 9) or the <em>total</em> <em>variation distance</em> (with Bayesian correction, <em>div.col</em> = 8).</p>
<div id="cutpoint-based-on-youden-index" class="section level3">
<h3 class="hasAnchor">
<a href="#cutpoint-based-on-youden-index" class="anchor"></a><em>Cutpoint based on <em>Youden index</em></em>
</h3>
<p>Null distribution “GGamma3P”:</p>
<div class="sourceCode" id="cb38"><html><body><pre class="r"><span class="no">cutpoint1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/estimateCutPoint.html">estimateCutPoint</a></span>(<span class="kw">LR</span> <span class="kw">=</span> <span class="no">PS1</span>,
                    <span class="kw">control.names</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Breast_normal"</span>,<span class="st">"Breast_normal1"</span>),
                    <span class="kw">treatment.names</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Breast_cancer"</span>, <span class="st">"Breast_metastasis"</span>),
                    <span class="kw">simple</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                    <span class="kw">classifier1</span> <span class="kw">=</span> <span class="st">"pca.logistic"</span>,
                    <span class="kw">column</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">hdiv</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">bay.TV</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                                <span class="kw">wprob</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">pos</span> <span class="kw">=</span> <span class="fl">TRUE</span>),
                    <span class="kw">n.pc</span> <span class="kw">=</span> <span class="fl">4</span> , <span class="kw">center</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">scale</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                    <span class="kw">div.col</span> <span class="kw">=</span> <span class="fl">9</span>, <span class="kw">clas.perf</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">cutpoint1</span>$<span class="no">cutpoint</span></pre></body></html></div>
<pre><code>## [1] 4.383196</code></pre>
<div class="sourceCode" id="cb40"><html><body><pre class="r"><span class="no">cutpoint1</span>$<span class="no">testSetPerformance</span></pre></body></html></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction   CT   TT
##         CT 1123 1076
##         TT 4031 9874
##                                           
##                Accuracy : 0.6829          
##                  95% CI : (0.6756, 0.6901)
##     No Information Rate : 0.68            
##     P-Value [Acc &gt; NIR] : 0.2162          
##                                           
##                   Kappa : 0.141           
##                                           
##  Mcnemar's Test P-Value : &lt;2e-16          
##                                           
##             Sensitivity : 0.9017          
##             Specificity : 0.2179          
##          Pos Pred Value : 0.7101          
##          Neg Pred Value : 0.5107          
##              Prevalence : 0.6800          
##          Detection Rate : 0.6131          
##    Detection Prevalence : 0.8635          
##       Balanced Accuracy : 0.5598          
##                                           
##        'Positive' Class : TT              
## </code></pre>
<div class="sourceCode" id="cb42"><html><body><pre class="r"><span class="no">cutpoint1</span>$<span class="no">testSetModel.FDR</span></pre></body></html></div>
<pre><code>## [1] 0.2898957</code></pre>
<p>Null distribution “Gamma3P”:</p>
<div class="sourceCode" id="cb44"><html><body><pre class="r"><span class="no">cutpoint2</span> <span class="kw">=</span> <span class="fu"><a href="../reference/estimateCutPoint.html">estimateCutPoint</a></span>(<span class="kw">LR</span> <span class="kw">=</span> <span class="no">PS2</span>,
                    <span class="kw">control.names</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Breast_normal"</span>,<span class="st">"Breast_normal1"</span>),
                    <span class="kw">treatment.names</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Breast_cancer"</span>, <span class="st">"Breast_metastasis"</span>),
                    <span class="kw">simple</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                    <span class="kw">classifier1</span> <span class="kw">=</span> <span class="st">"pca.logistic"</span>,
                    <span class="kw">column</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">hdiv</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">bay.TV</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                                <span class="kw">wprob</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">pos</span> <span class="kw">=</span> <span class="fl">TRUE</span>),
                    <span class="kw">n.pc</span> <span class="kw">=</span> <span class="fl">4</span> , <span class="kw">center</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">scale</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                    <span class="kw">div.col</span> <span class="kw">=</span> <span class="fl">9</span>, <span class="kw">clas.perf</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">cutpoint2</span>$<span class="no">cutpoint</span></pre></body></html></div>
<pre><code>## [1] 6.189402</code></pre>
<div class="sourceCode" id="cb46"><html><body><pre class="r"><span class="no">cutpoint2</span>$<span class="no">testSetPerformance</span></pre></body></html></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction   CT   TT
##         CT  657    0
##         TT    0 1551
##                                      
##                Accuracy : 1          
##                  95% CI : (0.9983, 1)
##     No Information Rate : 0.7024     
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16  
##                                      
##                   Kappa : 1          
##                                      
##  Mcnemar's Test P-Value : NA         
##                                      
##             Sensitivity : 1.0000     
##             Specificity : 1.0000     
##          Pos Pred Value : 1.0000     
##          Neg Pred Value : 1.0000     
##              Prevalence : 0.7024     
##          Detection Rate : 0.7024     
##    Detection Prevalence : 0.7024     
##       Balanced Accuracy : 1.0000     
##                                      
##        'Positive' Class : TT         
## </code></pre>
<div class="sourceCode" id="cb48"><html><body><pre class="r"><span class="no">cutpoint2</span>$<span class="no">testSetModel.FDR</span></pre></body></html></div>
<pre><code>## [1] 0</code></pre>
<p>The cutpoint estimated based “GGamma3P” model is lower than the value based on “Gamma3P” model. Often, this is a good detail, since it permits the identification of more sites with high probability to carry methylation signal. However, the evaluation of the classification performance has the last word on model selection. In the current case, the DMP classification performance is much better for “Gamma3P” model than for “GGamma3P”.</p>
<p>In particular, the probabilities derived from each distribution model provide fundamental information to the model classifier. Hence, the probability that a potential DMP could carry a methylation signal estimated using “Gamma3P” model is more informative (for the model classifier) than the probability estimated using “GGamma3P” model.</p>
</div>
<div id="cutpoint-estimated-using-a-model-classifier" class="section level3">
<h3 class="hasAnchor">
<a href="#cutpoint-estimated-using-a-model-classifier" class="anchor"></a><em>Cutpoint estimated using a model classifier</em>
</h3>
<p>In the current case, the DMP classification performance for the signal derived with null distribution “Gamma3P” can be improved searching for an optimal cutpoint with a model classifier and using the total variation distance ( with Bayesian correction, bay.TV).</p>
<div class="sourceCode" id="cb50"><html><body><pre class="r"><span class="no">cutpoint2</span> <span class="kw">=</span> <span class="fu"><a href="../reference/estimateCutPoint.html">estimateCutPoint</a></span>(<span class="kw">LR</span> <span class="kw">=</span> <span class="no">PS2</span>,
                    <span class="kw">control.names</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Breast_normal"</span>,<span class="st">"Breast_normal1"</span>),
                    <span class="kw">treatment.names</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Breast_cancer"</span>, <span class="st">"Breast_metastasis"</span>),
                    <span class="kw">simple</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
                    <span class="kw">classifier1</span> <span class="kw">=</span> <span class="st">"pca.logistic"</span>,
                    <span class="kw">classifier2</span> <span class="kw">=</span> <span class="st">"pca.qda"</span>,
                    <span class="kw">column</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">hdiv</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">bay.TV</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                                <span class="kw">wprob</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">pos</span> <span class="kw">=</span> <span class="fl">TRUE</span>),
                    <span class="kw">n.pc</span> <span class="kw">=</span> <span class="fl">4</span> , <span class="kw">center</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">scale</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                    <span class="kw">div.col</span> <span class="kw">=</span> <span class="fl">8</span>)
<span class="no">cutpoint2</span>$<span class="no">cutpoint</span></pre></body></html></div>
<pre><code>## [1] 0.5000034</code></pre>
<div class="sourceCode" id="cb52"><html><body><pre class="r"><span class="no">cutpoint2</span>$<span class="no">testSetPerformance</span></pre></body></html></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction   CT   TT
##         CT 5220    0
##         TT    0 1550
##                                      
##                Accuracy : 1          
##                  95% CI : (0.9995, 1)
##     No Information Rate : 0.771      
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16  
##                                      
##                   Kappa : 1          
##                                      
##  Mcnemar's Test P-Value : NA         
##                                      
##             Sensitivity : 1.000      
##             Specificity : 1.000      
##          Pos Pred Value : 1.000      
##          Neg Pred Value : 1.000      
##              Prevalence : 0.229      
##          Detection Rate : 0.229      
##    Detection Prevalence : 0.229      
##       Balanced Accuracy : 1.000      
##                                      
##        'Positive' Class : TT         
## </code></pre>
<div class="sourceCode" id="cb54"><html><body><pre class="r"><span class="no">cutpoint2</span>$<span class="no">testSetModel.FDR</span></pre></body></html></div>
<pre><code>## [1] 0</code></pre>
<p>The good DMP classification performance was kept at lower cutpoint value.</p>
</div>
</div>
<div id="dmps" class="section level2">
<h2 class="hasAnchor">
<a href="#dmps" class="anchor"></a>DMPs</h2>
<p>Cytosine sites carrying a methylation signal are designated differentially informative methylated positions (DMPs). The probability that a DMP is not induced by the treatment is given by the probability of false alarm (P_FA, false positive, Sanchez et al. 2019). That is, the biological signal is naturally present in the control as well as in the treatment. According to the classical view in the epigenomic field, a DMP is a cytosine position carrying a significant methylation signal, which might be identified as differentially methylated cytosine site by Fisher’s exact test (or other current tests).</p>
<p>In Methyl-IT, a DMP is a DNA cytosine position with high probability to be differentially hyper-methylated or hypo-methylated in the treatment with respect to a given control (reference individual)<em><em>. Notice that Methyl- IT definition of DMP is not deterministic in an ordinary sense, but stochastic- deterministic in physico-mathematical terms. In other words, if a given cytosine position is identified as a hyper-methylated DMP in the treatment, then with high probability such a site will be found more frequently hyper- methylated than hypo-methylated in the </em></em>treatment population*_. Observe that it does not mean that, for all arbitrary subset of samples, the assumed cytosine position will be hypermethylated.</p>
<p>DMPs are selected with the function <a href="https://is.gd/%207cVEEd">selectDIMP</a></p>
<div class="sourceCode" id="cb56"><html><body><pre class="r"><span class="no">DMPs</span> <span class="kw">=</span> <span class="fu"><a href="../reference/selectDIMP.html">selectDIMP</a></span>(<span class="no">PS2</span>, <span class="kw">div.col</span> <span class="kw">=</span> <span class="fl">8</span>, <span class="kw">cutpoint</span> <span class="kw">=</span> <span class="no">cutpoint2</span>$<span class="no">cutpoint</span>)</pre></body></html></div>
<div id="the-descriptive-statistic-of-the-read-counts-at-dmps" class="section level3">
<h3 class="hasAnchor">
<a href="#the-descriptive-statistic-of-the-read-counts-at-dmps" class="anchor"></a>The descriptive statistic of the read counts at DMPs</h3>
<p>After the signal detection step the read counts at DMPs is notable greater than at the general methylated cytosine background:</p>
<div class="sourceCode" id="cb57"><html><body><pre class="r"><span class="co"># Maximum coverage at each cytosine site</span>
<span class="no">methc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/lapply.html">lapply</a></span>(<span class="no">DMPs</span>, <span class="kw">function</span>(<span class="no">x</span>) {
                        <span class="no">r</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">x</span>$<span class="no">c1</span>, <span class="no">x</span>$<span class="no">c2</span>), <span class="fl">1</span>, <span class="no">max</span>)
                        <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">r</span>)
})

<span class="co"># Quantiles</span>
<span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="no">rbind</span>, <span class="fu"><a href="../reference/lapply.html">lapply</a></span>(<span class="no">methc</span>, <span class="kw">function</span>(<span class="no">x</span>) {
    <span class="no">q10</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">x</span>, <span class="fl">0.1</span>)
    <span class="no">q60</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">x</span>, <span class="fl">0.6</span>)
    <span class="no">q9999</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">x</span>, <span class="fl">0.9999</span>)
    <span class="no">idx1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">x</span> <span class="kw">&gt;=</span> <span class="no">q60</span>)
    <span class="no">idx2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">x</span> <span class="kw">&lt;=</span> <span class="fl">500</span>)
    <span class="no">q95</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">x</span>, <span class="fl">0.95</span>)

    <span class="no">idx</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html">intersect</a></span>(<span class="no">idx1</span>, <span class="no">idx2</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">x</span>)), <span class="no">q10</span>, <span class="no">q60</span>,
            <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.95</span>, <span class="fl">0.99</span>, <span class="fl">0.999</span>, <span class="fl">0.9999</span>)),
            <span class="kw">num.siteGreater_8</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">x</span> <span class="kw">&gt;=</span> <span class="fl">8</span>),
            <span class="kw">q60_to_500</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>((<span class="no">x</span> <span class="kw">&gt;=</span> <span class="no">q60</span>) <span class="kw">&amp;</span> (<span class="no">x</span> <span class="kw">&lt;=</span> <span class="fl">500</span>)),
            <span class="kw">num.siteGreater_500</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">x</span> <span class="kw">&gt;</span> <span class="fl">500</span>)))})
)</pre></body></html></div>
<pre><code>##                   Min. 1st Qu. Median Mean 3rd Qu. Max.  10% 60% 95%   99%
## Breast_normal       18      32     42   41      48   91 27.0  44  62  70.0
## Breast_cancer       19      41     57   61      80  228 33.3  64 106 123.0
## Breast_metastasis   17      38     47   50      61  146 30.0  52  83 101.5
## Breast_normal1      23      29     34   37      45   76 26.0  38  53  60.0
##                     99.9%   99.99% num.siteGreater_8 q60_to_500
## Breast_normal      83.000  90.1082              8919       3872
## Breast_cancer     157.677 212.2036              2324        942
## Breast_metastasis 116.800 141.8150              1551        643
## Breast_normal1     71.000  74.3480              4131       1656
##                   num.siteGreater_500
## Breast_normal                       0
## Breast_cancer                       0
## Breast_metastasis                   0
## Breast_normal1                      0</code></pre>
<p>The minimum amount of methylated read counts is observed “Breast_metastasis” (15 reads) and for any the samples the tenth percent of DMPs is 26 or more reads.</p>
</div>
<div id="venn-diagram-of-dmps" class="section level3">
<h3 class="hasAnchor">
<a href="#venn-diagram-of-dmps" class="anchor"></a><em>Venn Diagram of DMPs</em>
</h3>
<p>The Venn diagram of DMPs reveals that the number cytosine site carrying methylation signal with a divergence level comparable to that observed in breast tissues with cancer and metastasis is relatively small (2797 DMPs). The number of DMPs decreased in the breast tissue with metastasis, but, as shown in the last boxplot, the intensity of the signal increased.</p>
<div class="sourceCode" id="cb59"><html><body><pre class="r"><span class="no">n12</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw pkg">GenomicRanges</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/setops-methods.html">intersect</a></span>(<span class="no">DMPs</span>$<span class="no">Breast_normal</span>,
                                    <span class="no">DMPs</span>$<span class="no">Breast_cancer</span>))
<span class="no">n13</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw pkg">GenomicRanges</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/setops-methods.html">intersect</a></span>(<span class="no">DMPs</span>$<span class="no">Breast_normal</span>,
                                    <span class="no">DMPs</span>$<span class="no">Breast_metastasis</span>))
<span class="no">n23</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw pkg">GenomicRanges</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/setops-methods.html">intersect</a></span>(<span class="no">DMPs</span>$<span class="no">Breast_cancer</span>,
                                    <span class="no">DMPs</span>$<span class="no">Breast_metastasis</span>))
<span class="no">n123</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span>(<span class="kw pkg">GenomicRanges</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/GenomicRanges/man/setops-methods.html">intersect</a></span>,
                    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">DMPs</span>$<span class="no">Breast_normal</span>, <span class="no">DMPs</span>$<span class="no">Breast_cancer</span>,
                        <span class="no">DMPs</span>$<span class="no">Breast_metastasis</span>)))

<span class="fu"><a href="https://rdrr.io/r/grid/grid.newpage.html">grid.newpage</a></span>()
<span class="no">v</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/VennDiagram/man/draw.triple.venn.html">draw.triple.venn</a></span>(<span class="kw">area1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">DMPs</span>$<span class="no">Breast_normal</span>),
                    <span class="kw">area2</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">DMPs</span>$<span class="no">Breast_cancer</span>),
                    <span class="kw">area3</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">DMPs</span>$<span class="no">Breast_metastasis</span>),
                    <span class="kw">n12</span> <span class="kw">=</span> <span class="no">n12</span>, <span class="kw">n23</span> <span class="kw">=</span> <span class="no">n23</span>, <span class="kw">n13</span> <span class="kw">=</span> <span class="no">n13</span>, <span class="kw">n123</span> <span class="kw">=</span> <span class="no">n123</span>,
                    <span class="kw">category</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Breast_normal"</span>, <span class="st">"Breast_cancer"</span>,
                                <span class="st">"Breast_metastasis"</span>),
                    <span class="kw">lty</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"blank"</span>, <span class="fl">3</span>), <span class="kw">fill</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"blue"</span>, <span class="st">"yellow"</span>,
                                                    <span class="st">"magenta"</span>),
                    <span class="kw">alpha</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>),
                    <span class="kw">cat.pos</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">80</span>, <span class="fl">90</span>, <span class="fl">0</span>),
                    <span class="kw">cat.col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"blue"</span>, <span class="st">"darkorange"</span>, <span class="st">"red"</span>),
                    <span class="kw">cat.dist</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>( -<span class="fl">0.1</span>, -<span class="fl">0.08</span>, -<span class="fl">0.26</span>),
                    <span class="kw">cex</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1.7</span>, <span class="fl">7</span>),
                    <span class="kw">cat.cex</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>( <span class="fl">1.5</span>, <span class="fl">1.5</span>, <span class="fl">1.5</span>),
                    <span class="kw">label.col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>( <span class="st">"blue"</span>, <span class="st">"darkorange"</span>, <span class="st">"darkorange"</span>,
                                <span class="st">"red"</span>, <span class="st">"white"</span>, <span class="st">"red"</span>, <span class="st">"red"</span>),
                    <span class="kw">scaled</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/grid/grid.draw.html">grid.draw</a></span>(<span class="no">v</span>)</pre></body></html></div>
<p><img src="cancer_example_files/figure-html/fig4-1.png" width="672"></p>
<p>Notice that natural methylation regulatory signals (not induced by the treatment) are present in both groups, control and treatment. The signal detection step permits us to discriminate the “ordinary” signals observed in the control from those induced by the treatment (a disease in the current case). In addition, this diagram reflects a classification of DMPs only based on the cytosine positions. That is, this Venn diagram cannot tell us whether DMPs at the same position can be distinguishable or not. For example, DMPs at the same positions in control and treatment can happen with different probabilities estimated from their corresponding fitted Weibull distributions (see below).</p>
</div>
<div id="monte-carlo-evaluation-of-the-model-classification" class="section level3">
<h3 class="hasAnchor">
<a href="#monte-carlo-evaluation-of-the-model-classification" class="anchor"></a>Monte Carlo Evaluation of the Model Classification</h3>
<p>Performance The regulatory methylation signal is an output from a natural process that continuously takes place across the ontogenetic development of the organism. Therefore, we expect to see methylation signal in natural, ordinary conditions. Function ‘evaluateDIMPclass’ can be used to perform a classification of DMPs into two classes: DMPS from control and DMPs from treatment samples, as well as an evaluation of the classification performance (for more details see <a href="https://is.gd/nzy9j3">evaluateDIMPclass</a>).</p>
<p>As a matter of fact this function is called by function <a href="https://is.gd/RR9iWY">estimateCutPoint</a>. Additional feature not used before is the possibility to perform Monte Carlo evaluation of the model classifier performance. In above split of the sample into two subsets, training and test datasets, we would be just lucky getting the right proportion that yields the best classification performance. What about is the random split is repeat 300 times?</p>
<p>The performance of the “pca.qda” classifier is:</p>
<div class="sourceCode" id="cb60"><html><body><pre class="r"><span class="no">performance</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/evaluateDIMPclass.html">evaluateDIMPclass</a></span>(<span class="kw">LR</span> <span class="kw">=</span> <span class="no">DMPs</span>,
                    <span class="kw">control.names</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Breast_normal"</span>, <span class="st">"Breast_normal1"</span>),
                    <span class="kw">treatment.names</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Breast_cancer"</span>, <span class="st">"Breast_metastasis"</span>),
                    <span class="kw">column</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">hdiv</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">bay.TV</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                                <span class="kw">wprob</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">pos</span> <span class="kw">=</span> <span class="fl">TRUE</span>),
                    <span class="kw">classifier</span> <span class="kw">=</span> <span class="st">"pca.qda"</span>, <span class="kw">prop</span> <span class="kw">=</span> <span class="fl">0.6</span>,
                    <span class="kw">n.pc</span> <span class="kw">=</span> <span class="fl">4</span> , <span class="kw">center</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">scale</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                    <span class="kw">num.boot</span> <span class="kw">=</span> <span class="fl">300</span>, <span class="kw">output</span> <span class="kw">=</span> <span class="st">"mc.val"</span>,
                    <span class="kw">num.cores</span> <span class="kw">=</span> <span class="fl">6L</span>, <span class="kw">tasks</span> <span class="kw">=</span> <span class="fl">2L</span>)
<span class="no">performance</span></pre></body></html></div>
<pre><code>##     Accuracy     Kappa   AccuracyLower    AccuracyUpper  AccuracyNull  
##  Min.   :1   Min.   :1   Min.   :0.9995   Min.   :1     Min.   :0.771  
##  1st Qu.:1   1st Qu.:1   1st Qu.:0.9995   1st Qu.:1     1st Qu.:0.771  
##  Median :1   Median :1   Median :0.9995   Median :1     Median :0.771  
##  Mean   :1   Mean   :1   Mean   :0.9995   Mean   :1     Mean   :0.771  
##  3rd Qu.:1   3rd Qu.:1   3rd Qu.:0.9995   3rd Qu.:1     3rd Qu.:0.771  
##  Max.   :1   Max.   :1   Max.   :0.9995   Max.   :1     Max.   :0.771  
##                                                                        
##  AccuracyPValue McnemarPValue  Sensitivity  Specificity Pos Pred Value
##  Min.   :0      Min.   : NA   Min.   :1    Min.   :1    Min.   :1     
##  1st Qu.:0      1st Qu.: NA   1st Qu.:1    1st Qu.:1    1st Qu.:1     
##  Median :0      Median : NA   Median :1    Median :1    Median :1     
##  Mean   :0      Mean   :NaN   Mean   :1    Mean   :1    Mean   :1     
##  3rd Qu.:0      3rd Qu.: NA   3rd Qu.:1    3rd Qu.:1    3rd Qu.:1     
##  Max.   :0      Max.   : NA   Max.   :1    Max.   :1    Max.   :1     
##                 NA's   :300                                           
##  Neg Pred Value   Precision     Recall        F1      Prevalence   
##  Min.   :1      Min.   :1   Min.   :1   Min.   :1   Min.   :0.229  
##  1st Qu.:1      1st Qu.:1   1st Qu.:1   1st Qu.:1   1st Qu.:0.229  
##  Median :1      Median :1   Median :1   Median :1   Median :0.229  
##  Mean   :1      Mean   :1   Mean   :1   Mean   :1   Mean   :0.229  
##  3rd Qu.:1      3rd Qu.:1   3rd Qu.:1   3rd Qu.:1   3rd Qu.:0.229  
##  Max.   :1      Max.   :1   Max.   :1   Max.   :1   Max.   :0.229  
##                                                                    
##  Detection Rate  Detection Prevalence Balanced Accuracy
##  Min.   :0.229   Min.   :0.229        Min.   :1        
##  1st Qu.:0.229   1st Qu.:0.229        1st Qu.:1        
##  Median :0.229   Median :0.229        Median :1        
##  Mean   :0.229   Mean   :0.229        Mean   :1        
##  3rd Qu.:0.229   3rd Qu.:0.229        3rd Qu.:1        
##  Max.   :0.229   Max.   :0.229        Max.   :1        
## </code></pre>
</div>
</div>
<div id="differentially-methylated-genomic-regions-dmrs" class="section level2">
<h2 class="hasAnchor">
<a href="#differentially-methylated-genomic-regions-dmrs" class="anchor"></a>Differentially methylated genomic regions (DMRs)</h2>
<p>Our degree of confidence in whether DMP counts in both groups of samples, control and treatment, represent true biological signal was determined in the signal detection step. To estimate DIMRs, we followed similar steps to those proposed in Bioconductor R package DESeq2 <span class="citation">(Love, Huber, and Anders 2014)</span>, but our GLM test looks for statistical difference between the groups based on gene-body DMP counts overlapping a given genomic region rather than read counts. The regression analysis of the generalized linear model (GLM) with logarithmic link was applied to test the difference between group counts.</p>
<p>The fitting algorithmic approaches provided by ‘glm’ and ‘glm.nb’ functions from the R packages stat and MASS, respectively, were used for Poisson (PR), Quasi-Poisson (QPR) and Negative Binomial (NBR) linear regression analyses, respectively.</p>
<p>In Methyl-IT, the concept of DMR is generalized and it is not limited to any particular genomic region found with specific clustering algorithm. It can be applied to any naturally or algorithmically defined genomic region. For example, an exon region identified statistically to be differentially methylated by using generalized linear regression model (GLM) is a DMR. Differentially methylated genes (DMGs) are estimated from group comparisons for the number of DMPs on gene-body regions between control and treatment. This permits the extension of the concept of DMR by considering a differentially methylated gene as a particular case of DMRs.</p>
<div id="differentially-methylated-genes-dmgs" class="section level3">
<h3 class="hasAnchor">
<a href="#differentially-methylated-genes-dmgs" class="anchor"></a><em>Differentially methylated genes (DMGs)</em>
</h3>
<p>We shall call DMGs those DIMRs restricted to gene-body regions. DMGs are detected using function <a href="https://is.gd/kltCXl">countTest2</a>. Gene annotation is taken from <a href="https://www.ensembl.org/">Ensembl</a></p>
<div class="sourceCode" id="cb62"><html><body><pre class="r"># To load human gene annotation
# AG = import(con = paste0("ftp://ftp.ensembl.org/pub/release-91/gff3/",
# "homo_sapiens/Homo_sapiens.GRCh38.91.gff3.gz"))
# genes = AG[ AG$type == "gene", c( "gene_id", "biotype", "Name" ) ]
# genes = genes[ genes$biotype == "protein_coding", "gene_id" ]
# seqlevels(genes, "coarse") </pre></body></html></div>
<p>Here, for the sake of brevity, we just load the “RData” compressed file containing only the gene annotation:</p>
<div class="sourceCode" id="cb63"><html><body><pre class="r"><span class="no">con</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/connections.html">url</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"https://git.psu.edu/genomath/MethylIT_examples/raw/master/"</span>,
                <span class="st">"Homo_sapiens_GRCh38.91_genes.RData"</span>))
<span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span>(<span class="no">con</span>)
<span class="no">genes</span> <span class="kw">=</span> <span class="no">genes</span>[ <span class="no">genes</span>$<span class="no">biotype</span> <span class="kw">==</span> <span class="st">"protein_coding"</span>, ]
<span class="fu">seqlevels</span>(<span class="no">genes</span>, <span class="st">"coarse"</span>) <span class="kw">&lt;-</span> <span class="st">"13"</span> <span class="co"># To keep a consistent chromosome annotation</span>
<span class="fu">seqlevels</span>(<span class="no">genes</span>) <span class="kw">&lt;-</span> <span class="st">"chr13"</span>
<span class="no">genes</span></pre></body></html></div>
<pre><code>## GRanges object with 323 ranges and 3 metadata columns:
##         seqnames              ranges strand |         gene_id        biotype
##            &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt; |     &lt;character&gt;    &lt;character&gt;
##     [1]    chr13   19173770-19181852      - | ENSG00000198033 protein_coding
##     [2]    chr13   19422877-19536762      - | ENSG00000132958 protein_coding
##     [3]    chr13   19633681-19673459      + | ENSG00000196199 protein_coding
##     [4]    chr13   19674752-19783019      - | ENSG00000121390 protein_coding
##     [5]    chr13   19823482-19863636      - | ENSG00000132950 protein_coding
##     ...      ...                 ...    ... .             ...            ...
##   [319]    chr13 113977783-114132611      - | ENSG00000185989 protein_coding
##   [320]    chr13 114179238-114223084      + | ENSG00000283361 protein_coding
##   [321]    chr13 114234887-114272723      + | ENSG00000130177 protein_coding
##   [322]    chr13 114281584-114305817      + | ENSG00000169062 protein_coding
##   [323]    chr13 114314513-114327328      + | ENSG00000198824 protein_coding
##                Name
##         &lt;character&gt;
##     [1]      TUBA3C
##     [2]       TPTE2
##     [3]    MPHOSPH8
##     [4]       PSPC1
##     [5]       ZMYM5
##     ...         ...
##   [319]       RASA3
##   [320]  AL160396.2
##   [321]       CDC16
##   [322]       UPF3A
##   [323]      CHAMP1
##   -------
##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</code></pre>
<p>Function <a href="https://is.gd/WQzX5I">getDIMPatGenes</a> is used to count the number of DMPs at gene-body. Nevertheless, it can be used for any arbitrary specified genomic region as well. The operation of this function is based on the ‘<em>findOverlaps</em>’ function from the ‘<em>GenomicRanges</em>’ Bioconductor R package. The ‘<em>findOverlaps</em>’ function has several critical parameters like, for example, ‘<em>maxgap</em>’, ‘<em>minoverlap</em>’, and ‘<em>ignore.strand</em>’. In our function <a href="https://is.gd/WQzX5I">getDIMPatGenes</a>, except for setting ignore.strand = TRUE and <em>type = “within”</em>, we preserve the rest of default ‘findOverlaps’ parameters.</p>
<p>In this case, these are important parameter settings because the local mechanical effect of methylation changes on a DNA region where a gene is located is independent of the strand where the gene is encoded. That is, methylation changes located in any of the two DNA strands inside the gene-body region will affect the flexibility of the DNA molecule <span class="citation">(Choy et al. 2010; Severin et al. 2011)</span>.</p>
<div class="sourceCode" id="cb65"><html><body><pre class="r"><span class="no">DMPsBN</span> <span class="kw">=</span> <span class="fu"><a href="../reference/getDIMPatGenes.html">getDIMPatGenes</a></span>(<span class="kw">GR</span> <span class="kw">=</span> <span class="no">DMPs</span>$<span class="no">Breast_normal</span>, <span class="kw">GENES</span> <span class="kw">=</span> <span class="no">genes</span>)
<span class="no">DMPsBN1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/getDIMPatGenes.html">getDIMPatGenes</a></span>(<span class="kw">GR</span> <span class="kw">=</span> <span class="no">DMPs</span>$<span class="no">Breast_normal1</span>, <span class="kw">GENES</span> <span class="kw">=</span> <span class="no">genes</span>)
<span class="no">DMPsBC</span> <span class="kw">=</span> <span class="fu"><a href="../reference/getDIMPatGenes.html">getDIMPatGenes</a></span>(<span class="kw">GR</span> <span class="kw">=</span> <span class="no">DMPs</span>$<span class="no">Breast_cancer</span>, <span class="kw">GENES</span> <span class="kw">=</span> <span class="no">genes</span>)
<span class="no">DMPsBM</span> <span class="kw">=</span> <span class="fu"><a href="../reference/getDIMPatGenes.html">getDIMPatGenes</a></span>(<span class="kw">GR</span> <span class="kw">=</span> <span class="no">DMPs</span>$<span class="no">Breast_metastasis</span>, <span class="kw">GENES</span> <span class="kw">=</span>
        <span class="no">genes</span>)</pre></body></html></div>
<p>The number of DMPs on the strand where a gene is encoded is obtained by setting ignore.strand = FALSE. However, for the current example results will be the same since the datasets downloaded from GEO do not have strand information. Next, the above GRanges objects carrying the DMP counts from each sample are grouped into a single GRanges object. Since we have only one control, to perform group comparison and to move forward with this example, we duplicated ‘Breast_normal’ sample. Obviously, the confidence on the results increases with the number of sample replications per group (in this case, it is only an illustrative example on how to perform the analysis, since a fair comparison requires for more than one replicate in the control group).</p>
<div class="sourceCode" id="cb66"><html><body><pre class="r"><span class="no">Genes.DMPs</span> <span class="kw">=</span> <span class="fu"><a href="../reference/uniqueGRanges.html">uniqueGRanges</a></span>( <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">DMPsBN</span>[, <span class="fl">2</span>], <span class="no">DMPsBN1</span>[, <span class="fl">2</span>],
                                <span class="no">DMPsBC</span>[, <span class="fl">2</span>], <span class="no">DMPsBM</span>[, <span class="fl">2</span>]),
                            <span class="kw">type</span> <span class="kw">=</span> <span class="st">"equal"</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
                            <span class="kw">ignore.strand</span> <span class="kw">=</span> <span class="fl">TRUE</span> )
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>( <span class="fu">mcols</span>(<span class="no">Genes.DMPs</span>)) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Breast_normal"</span>, <span class="st">"Breast_normal1"</span>,
                                    <span class="st">"Breast_cancer"</span>, <span class="st">"Breast_metastasis"</span>)</pre></body></html></div>
<p>Next, the set of mapped genes are annotated</p>
<div class="sourceCode" id="cb67"><html><body><pre class="r"><span class="no">GeneID</span> <span class="kw">=</span> <span class="fu">subsetByOverlaps</span>(<span class="no">genes</span>, <span class="no">Genes.DMPs</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"equal"</span>,
                            <span class="kw">ignore.strand</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>( <span class="no">Genes.DMPs</span> ) <span class="kw">&lt;-</span> <span class="no">GeneID</span>$<span class="no">gene_id</span>
<span class="no">Genes.DMPs</span></pre></body></html></div>
<pre><code>## GRanges object with 270 ranges and 4 metadata columns:
##                   seqnames              ranges strand | Breast_normal
##                      &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt; |     &lt;numeric&gt;
##   ENSG00000198033    chr13   19173770-19181852      * |             1
##   ENSG00000132958    chr13   19422877-19536762      * |             1
##   ENSG00000196199    chr13   19633681-19673459      * |             2
##   ENSG00000121390    chr13   19674752-19783019      * |             5
##   ENSG00000132950    chr13   19823482-19863636      * |             1
##               ...      ...                 ...    ... .           ...
##   ENSG00000185989    chr13 113977783-114132611      * |            65
##   ENSG00000283361    chr13 114179238-114223084      * |            27
##   ENSG00000130177    chr13 114234887-114272723      * |            22
##   ENSG00000169062    chr13 114281584-114305817      * |            16
##   ENSG00000198824    chr13 114314513-114327328      * |             0
##                   Breast_normal1 Breast_cancer Breast_metastasis
##                        &lt;numeric&gt;     &lt;numeric&gt;         &lt;numeric&gt;
##   ENSG00000198033              0             0                 0
##   ENSG00000132958              2             0                 0
##   ENSG00000196199              1             0                 0
##   ENSG00000121390              2             0                 3
##   ENSG00000132950              0             0                 0
##               ...            ...           ...               ...
##   ENSG00000185989             34            45                14
##   ENSG00000283361              7            21                14
##   ENSG00000130177              7            13                 6
##   ENSG00000169062              7            10                 5
##   ENSG00000198824              0             0                 1
##   -------
##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</code></pre>
<p>Now, we build a <a href="https://is.gd/VZaazz">glmDataSet</a> object.</p>
<div class="sourceCode" id="cb69"><html><body><pre class="r"><span class="co">## An experiment design is set.</span>
<span class="no">colData</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">condition</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"BN"</span>,<span class="st">"BN"</span>,<span class="st">"BC"</span>,<span class="st">"BC"</span>),
                                        <span class="kw">levels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"BN"</span>, <span class="st">"BC"</span>)),
                        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Breast_normal"</span>,<span class="st">"Breast_normal1"</span>,
                            <span class="st">"Breast_cancer"</span>,<span class="st">"Breast_metastasis"</span>),
                        <span class="kw">row.names</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="co">## A RangedGlmDataSet is created</span>
<span class="no">ds</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/glmDataSet.html">glmDataSet</a></span>(<span class="kw">GR</span> <span class="kw">=</span> <span class="no">Genes.DMPs</span>, <span class="kw">colData</span> <span class="kw">=</span> <span class="no">colData</span>)</pre></body></html></div>
<p>DMG analysis is performed with the function <a href="https://%20is.gd/kltCXl">countTest2</a></p>
<div class="sourceCode" id="cb70"><html><body><pre class="r"><span class="no">DMGs</span> <span class="kw">=</span> <span class="fu"><a href="../reference/countTest2.html">countTest2</a></span>(<span class="kw">DS</span> <span class="kw">=</span> <span class="no">ds</span>, <span class="kw">num.cores</span> <span class="kw">=</span> <span class="fl">4L</span>, <span class="kw">minCountPerIndv</span> <span class="kw">=</span> <span class="fl">8</span>,
                <span class="kw">countFilter</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">maxGrpCV</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">1</span>),
                <span class="kw">Minlog2FC</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">pvalCutOff</span> <span class="kw">=</span> <span class="fl">0.05</span>,
                <span class="kw">MVrate</span> <span class="kw">=</span> <span class="fl">.95</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="no">DMGs</span></pre></body></html></div>
<pre><code>## GRanges object with 64 ranges and 12 metadata columns:
##                   seqnames              ranges strand | Breast_normal
##                      &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt; |     &lt;numeric&gt;
##   ENSG00000165475    chr13   20403667-20525857      * |            41
##   ENSG00000150457    chr13   20973032-21061547      * |            29
##   ENSG00000165487    chr13   21492691-21604214      * |            31
##   ENSG00000102699    chr13   24420926-24512810      * |            15
##   ENSG00000139505    chr13   25246201-25288009      * |            10
##               ...      ...                 ...    ... .           ...
##   ENSG00000204442    chr13 107163510-107866735      * |            84
##   ENSG00000041515    chr13 108596152-109208007      * |            16
##   ENSG00000126218    chr13 113122814-113149529      * |            15
##   ENSG00000185896    chr13 113297241-113323672      * |            15
##   ENSG00000184497    chr13 113759240-113816995      * |            15
##                   Breast_normal1 Breast_cancer Breast_metastasis
##                        &lt;numeric&gt;     &lt;numeric&gt;         &lt;numeric&gt;
##   ENSG00000165475             19             9                 7
##   ENSG00000150457             16             6                 9
##   ENSG00000165487             10             4                10
##   ENSG00000102699              6             1                 2
##   ENSG00000139505              6             0                 0
##               ...            ...           ...               ...
##   ENSG00000204442             44             8                 3
##   ENSG00000041515              7             3                 1
##   ENSG00000126218              9             2                 5
##   ENSG00000185896              5             1                 2
##   ENSG00000184497              6             4                 3
##                              log2FC  scaled.deviance               pvalue
##                           &lt;numeric&gt;        &lt;numeric&gt;            &lt;numeric&gt;
##   ENSG00000165475 -1.32175583998232 4.96208101271995    0.030606129674274
##   ENSG00000150457 -1.09861228866811 4.65828980395393   0.0361102854476026
##   ENSG00000165487 -1.07451473708905 4.24757904423761   0.0397695740962727
##   ENSG00000102699 -1.94591014905531 7.54897971118099  0.00889363821746184
##   ENSG00000139505 -2.19722457733622 10.1593402974678  0.00558981768966344
##               ...               ...              ...                  ...
##   ENSG00000204442 -2.45413499112125 38.0399528175922 6.01036075344073e-09
##   ENSG00000041515 -1.74919985480926 5.45838587602237   0.0232156201855052
##   ENSG00000126218 -1.23214368129263 4.09418109306589   0.0481345693904388
##   ENSG00000185896 -1.89711998488588 6.35686440652162   0.0162045338242277
##   ENSG00000184497 -1.09861228866811 5.78113844812565   0.0222108197326888
##                            model             adj.pval     CT.SignalDensity
##                         &lt;factor&gt;            &lt;numeric&gt;            &lt;numeric&gt;
##   ENSG00000165475 Neg.Binomial.W   0.0362739314658062  0.00024551726395561
##   ENSG00000150457 Neg.Binomial.W   0.0420192412481194 0.000254191332640427
##   ENSG00000165487   Neg.Binomial   0.0442973653695546  0.00018381693626484
##   ENSG00000102699 Neg.Binomial.W   0.0167409660563987 0.000114273276378081
##   ENSG00000139505 Neg.Binomial.W   0.0143099332855384   0.0001913463608314
##               ...            ...                  ...                  ...
##   ENSG00000204442   Neg.Binomial 3.84663088220207e-07 9.10091492635369e-05
##   ENSG00000041515 Neg.Binomial.W   0.0309541602473402  1.8795272090165e-05
##   ENSG00000126218 Neg.Binomial.W   0.0487745441069833  0.00044916903728103
##   ENSG00000185896 Neg.Binomial.W   0.0246926229702518 0.000378329297820823
##   ENSG00000184497   Neg.Binomial   0.0302445204870656 0.000181799293579888
##                       TT.SignalDensity SignalDensityVariation
##                              &lt;numeric&gt;              &lt;numeric&gt;
##   ENSG00000165475 6.54712703881628e-05  -0.000180045993567448
##   ENSG00000150457 8.47304442134755e-05  -0.000169460888426951
##   ENSG00000165487 6.27667587245795e-05   -0.00012105017754026
##   ENSG00000102699 1.63247537682973e-05   -9.7948522609784e-05
##   ENSG00000139505                    0    -0.0001913463608314
##               ...                  ...                    ...
##   ENSG00000204442  7.8210987648352e-06  -8.31880504987017e-05
##   ENSG00000041515 3.26874297220261e-06  -1.55265291179624e-05
##   ENSG00000126218 0.000131007635873634  -0.000318161401407396
##   ENSG00000185896 5.67493946731235e-05    -0.0003215799031477
##   ENSG00000184497 6.05997645266293e-05  -0.000121199529053259
##   -------
##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</code></pre>
<p>Here, we adds the gene alias:</p>
<div class="sourceCode" id="cb72"><html><body><pre class="r"><span class="no">hits</span> <span class="kw">=</span> <span class="fu">findOverlaps</span>(<span class="no">DMGs</span>, <span class="no">genes</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"equal"</span>)
<span class="no">DMGs</span> <span class="kw">=</span> <span class="no">DMGs</span>[<span class="fu">queryHits</span>(<span class="no">hits</span>)]
<span class="no">DMGs</span>$<span class="no">alias</span> <span class="kw">&lt;-</span> <span class="no">genes</span>$<span class="no">Name</span>[<span class="fu">subjectHits</span>(<span class="no">hits</span>)]</pre></body></html></div>
<p><em><strong>BRCA2, a breast cancer associated risk gene, is found between the DMG</strong>s</em></p>
<div class="sourceCode" id="cb73"><html><body><pre class="r"><span class="co"># DMGs</span>
<span class="no">DMGs</span>[ <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span>( <span class="st">"ENSG00000139618"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">DMGs</span>) ) ]</pre></body></html></div>
<pre><code>## GRanges object with 1 range and 13 metadata columns:
##                   seqnames            ranges strand | Breast_normal
##                      &lt;Rle&gt;         &lt;IRanges&gt;  &lt;Rle&gt; |     &lt;numeric&gt;
##   ENSG00000139618    chr13 32315474-32400266      * |            22
##                   Breast_normal1 Breast_cancer Breast_metastasis
##                        &lt;numeric&gt;     &lt;numeric&gt;         &lt;numeric&gt;
##   ENSG00000139618             11             0                 0
##                              log2FC  scaled.deviance               pvalue
##                           &lt;numeric&gt;        &lt;numeric&gt;            &lt;numeric&gt;
##   ENSG00000139618 -2.86220088092947 18.3766614005661 0.000363516387975643
##                            model            adj.pval    CT.SignalDensity
##                         &lt;factor&gt;           &lt;numeric&gt;           &lt;numeric&gt;
##   ENSG00000139618 Neg.Binomial.W 0.00290813110380514 0.00019459153467857
##                   TT.SignalDensity SignalDensityVariation       alias
##                          &lt;numeric&gt;              &lt;numeric&gt; &lt;character&gt;
##   ENSG00000139618                0   -0.00019459153467857       BRCA2
##   -------
##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</code></pre>
</div>
</div>
<div id="concluding-remarks" class="section level2">
<h2 class="hasAnchor">
<a href="#concluding-remarks" class="anchor"></a>Concluding remarks</h2>
<p>Results fundamentally depend on the use of the proper reference samples. If there is not enough control samples to create an independent reference virtual individual, then the centroid from the control group can be used instead, which can be built with function <a href="https://is.gd/qR79kW">poolFromGRlist</a>.</p>
<p>The <em>reference</em> is used to put individuals from control and patients in the same <em>system of reference</em>. The information divergences of methylation levels with respect to the reference individual are estimated for each cytosine site for each individual, from control and treatment. As a result, the information on the natural spontaneous variation in the control and treatment populations is carried in the probability distributions of the information divergences, estimated for each individual. <em>It does not matter how statistically</em> <em>significant a DMP would be in the group of patients</em>.</p>
<p><em>What really matter is how big is the probability to observe the same methylation event in the control group in respect to the patient group</em>. Decisions are ultimately made on the basis of such classification probabilities at single cytosine positions. The signal detection based approach implemented in Methyl-IT is addressed to confront the mentioned issue and, in consequence, the level of resolution of Methyl-IT approach reach the single cytosine site.</p>
</div>
<div id="acknowledgments" class="section level2">
<h2 class="hasAnchor">
<a href="#acknowledgments" class="anchor"></a>Acknowledgments</h2>
<p>We thank Professor David J Miller for valuable conversations and suggestions on our mathematical modeling.</p>
</div>
<div id="funding-the-work-was-supported-by-funding-from-nsf-sbir" class="section level2">
<h2 class="hasAnchor">
<a href="#funding-the-work-was-supported-by-funding-from-nsf-sbir" class="anchor"></a>Funding The work was supported by funding from NSF-SBIR</h2>
<p>(2015-33610-23428-UNL) and the Bill and Melinda Gates Foundation (OPP1088661).</p>
</div>
<div id="s2--session-information" class="section level2">
<h2 class="hasAnchor">
<a href="#s2--session-information" class="anchor"></a>S2. Session Information</h2>
<pre><code>## R version 3.6.3 (2020-02-29)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 18.04.4 LTS
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.7.1
## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.7.1
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
##  [1] grid      parallel  stats4    stats     graphics  grDevices utils    
##  [8] datasets  methods   base     
## 
## other attached packages:
##  [1] VennDiagram_1.6.20   futile.logger_1.4.3  gridExtra_2.3       
##  [4] reshape2_1.4.3       ggplot2_3.3.0        MethylIT_0.3.2      
##  [7] rtracklayer_1.44.4   GenomicRanges_1.36.1 GenomeInfoDb_1.20.0 
## [10] IRanges_2.18.3       S4Vectors_0.22.1     BiocGenerics_0.30.0 
## [13] knitr_1.28          
## 
## loaded via a namespace (and not attached):
##  [1] colorspace_1.4-1            ellipsis_0.3.0             
##  [3] class_7.3-16                rprojroot_1.3-2            
##  [5] XVector_0.24.0              ArgumentCheck_0.10.2       
##  [7] fs_1.4.0                    rstudioapi_0.11            
##  [9] farver_2.0.3                bit64_0.9-7                
## [11] AnnotationDbi_1.46.1        prodlim_2019.11.13         
## [13] fansi_0.4.1                 lubridate_1.7.4            
## [15] codetools_0.2-16            splines_3.6.3              
## [17] pROC_1.16.2                 Rsamtools_2.0.3            
## [19] caret_6.0-86                annotate_1.56.1            
## [21] compiler_3.6.3              backports_1.1.5            
## [23] assertthat_0.2.1            Matrix_1.2-18              
## [25] cli_2.0.2                   formatR_1.7                
## [27] htmltools_0.4.0             tools_3.6.3                
## [29] gtable_0.3.0                glue_1.3.2                 
## [31] GenomeInfoDbData_1.2.1      dplyr_0.8.5                
## [33] Rcpp_1.0.4                  Biobase_2.44.0             
## [35] pkgdown_1.5.0               vctrs_0.2.4                
## [37] Biostrings_2.52.0           nlme_3.1-145               
## [39] iterators_1.0.12            timeDate_3043.102          
## [41] gower_0.2.1                 xfun_0.12                  
## [43] stringr_1.4.0               lifecycle_0.2.0            
## [45] XML_3.99-0.3                zlibbioc_1.30.0            
## [47] MASS_7.3-51.5               scales_1.1.0               
## [49] ipred_0.9-9                 SummarizedExperiment_1.14.1
## [51] lambda.r_1.2.4              yaml_2.2.1                 
## [53] memoise_1.1.0               rpart_4.1-15               
## [55] stringi_1.4.6               RSQLite_2.2.0              
## [57] genefilter_1.66.0           desc_1.2.0                 
## [59] foreach_1.5.0               e1071_1.7-3                
## [61] BiocParallel_1.18.1         lava_1.6.7                 
## [63] rlang_0.4.5                 pkgconfig_2.0.3            
## [65] matrixStats_0.56.0          bitops_1.0-6               
## [67] evaluate_0.14               lattice_0.20-40            
## [69] purrr_0.3.3                 GenomicAlignments_1.20.1   
## [71] recipes_0.1.10              labeling_0.3               
## [73] bit_1.1-15.2                tidyselect_1.0.0           
## [75] plyr_1.8.6                  magrittr_1.5               
## [77] nls2_0.2                    R6_2.4.1                   
## [79] generics_0.0.2              DelayedArray_0.10.0        
## [81] DBI_1.1.0                   pillar_1.4.3               
## [83] withr_2.1.2                 survival_3.1-11            
## [85] RCurl_1.98-1.1              nnet_7.3-13                
## [87] tibble_3.0.0                crayon_1.3.4               
## [89] futile.options_1.0.1        rmarkdown_2.1.1            
## [91] minpack.lm_1.2-1            data.table_1.12.8          
## [93] blob_1.2.1                  ModelMetrics_1.2.2.2       
## [95] digest_0.6.25               xtable_1.8-4               
## [97] munsell_0.5.0</code></pre>
</div>
<div id="references-" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references-" class="anchor"></a>References.</h2>
<div id="refs" class="references">
<div id="ref-Baldi2001">
<p>Baldi, Pierre, and Soren Brunak. 2001. <em>Bioinformatics: the machine learning approach</em>. Second. Cambridge: MIT Press.</p>
</div>
<div id="ref-Basu2010">
<p>Basu, A., A. Mandal, and L. Pardo. 2010. “Hypothesis testing for two discrete populations based on the Hellinger distance.” <em>Statistics &amp; Probability Letters</em> 80 (3-4). Elsevier B.V.: 206–14. <a href="https://doi.org/10.1016/j.spl.2009.10.008">https://doi.org/10.1016/j.spl.2009.10.008</a>.</p>
</div>
<div id="ref-Carter2016">
<p>Carter, Jane V., Jianmin Pan, Shesh N. Rai, and Susan Galandiuk. 2016. “ROC-ing along: Evaluation and interpretation of receiver operating characteristic curves.” <em>Surgery</em> 159 (6). Mosby: 1638–45. <a href="https://doi.org/10.1016/j.surg.2015.12.029">https://doi.org/10.1016/j.surg.2015.12.029</a>.</p>
</div>
<div id="ref-Choy2010">
<p>Choy, John S., Sijie Wei, Ju Yeon Lee, Song Tan, Steven Chu, and Tae Hee Lee. 2010. “DNA methylation increases nucleosome compaction and rigidity.” <em>Journal of the American Chemical Society</em> 132 (6). American Chemical Society: 1782–3. <a href="https://doi.org/10.1021/ja910264z">https://doi.org/10.1021/ja910264z</a>.</p>
</div>
<div id="ref-Dolzhenko2014">
<p>Dolzhenko, Egor, and Andrew D Smith. 2014. “Using beta-binomial regression for high-precision differential methylation analysis in multifactor whole-genome bisulfite sequencing experiments.” <em>BMC Bioinformatics</em> 15 (1). BioMed Central: 215. <a href="https://doi.org/10.1186/1471-2105-15-215">https://doi.org/10.1186/1471-2105-15-215</a>.</p>
</div>
<div id="ref-Fawcett2005">
<p>Fawcett, Tom. 2005. “An introduction to ROC analysis.” <a href="https://doi.org/10.1016/j.patrec.2005.10.010">https://doi.org/10.1016/j.patrec.2005.10.010</a>.</p>
</div>
<div id="ref-Greiner2000">
<p>Greiner, M, D Pfeiffer, and R D Smith. 2000. “Principles and practical application of the receiver-operating characteristic analysis for diagnostic tests.” <em>Preventive Veterinary Medicine</em> 45 (1-2): 23–41. <a href="https://doi.org/10.1016/S0167-5877(00)00115-X">https://doi.org/10.1016/S0167-5877(00)00115-X</a>.</p>
</div>
<div id="ref-Harpaz2013">
<p>Harpaz, Rave, William DuMouchel, Paea LePendu, Anna Bauer-Mehren, Patrick Ryan, and Nigam H Shah. 2013. “Performance of Pharmacovigilance Signal Detection Algorithms for the FDA Adverse Event Reporting System.” <em>Clin Pharmacol Ther</em> 93 (6): 1–19. <a href="https://doi.org/10.1038/clpt.2013.24.Performance">https://doi.org/10.1038/clpt.2013.24.Performance</a>.</p>
</div>
<div id="ref-Hebestreit2013">
<p>Hebestreit, Katja, Martin Dugas, and Hans-Ulrich Klein. 2013. “Detection of significantly differentially methylated regions in targeted bisulfite sequencing data.” <em>Bioinformatics (Oxford, England)</em> 29 (13): 1647–53. <a href="https://doi.org/10.1093/bioinformatics/btt263">https://doi.org/10.1093/bioinformatics/btt263</a>.</p>
</div>
<div id="ref-Kruspe2017">
<p>Kruspe, Sven, David D. Dickey, Kevin T. Urak, Giselle N. Blanco, Matthew J. Miller, Karen C. Clark, Elliot Burghardt, et al. 2017. “Rapid and Sensitive Detection of Breast Cancer Cells in Patient Blood with Nuclease-Activated Probe Technology.” <em>Molecular Therapy - Nucleic Acids</em> 8 (September). Cell Press: 542–57. <a href="https://doi.org/10.1016/j.omtn.2017.08.004">https://doi.org/10.1016/j.omtn.2017.08.004</a>.</p>
</div>
<div id="ref-Love2014">
<p>Love, M I, W Huber, and S Anders. 2014. “Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2.” <em>Genome Biology</em> 15 (12): 1–34. <a href="https://doi.org/Artn%20550%5CrDoi%2010.1186/S13059-014-0550-8">https://doi.org/Artn 550\rDoi 10.1186/S13059-014-0550-8</a>.</p>
</div>
<div id="ref-lopez2014">
<p>López-Ratón, Mónica, Mar<span class="math inline">\(\backslash\)</span>’<span class="math inline">\(\backslash\)</span>ia Xosé Rodríguez-Álvarez, Carmen Cadarso-Suárez, Francisco Gude-Sampedro, and Others. 2014. “OptimalCutpoints: an R package for selecting optimal cutpoints in diagnostic tests.” <em>Journal of Statistical Software</em> 61 (8). Foundation for Open Access Statistics: 1–36. <a href="https://www.jstatsoft.org/article/view/v061i08">https://www.jstatsoft.org/article/view/v061i08</a>.</p>
</div>
<div id="ref-Ngo2016">
<p>Ngo, Thuy T.M., Jejoong Yoo, Qing Dai, Qiucen Zhang, Chuan He, Aleksei Aksimentiev, and Taekjip Ha. 2016. “Effects of cytosine modifications on DNA flexibility and nucleosome mechanical stability.” <em>Nature Communications</em> 7 (February). Nature Publishing Group: 10813. <a href="https://doi.org/10.1038/ncomms10813">https://doi.org/10.1038/ncomms10813</a>.</p>
</div>
<div id="ref-Robinson2014">
<p>Robinson, Mark D., Abdullah Kahraman, Charity W. Law, Helen Lindsay, Malgorzata Nowicka, Lukas M. Weber, and Xiaobei Zhou. 2014. “Statistical methods for detecting differentially methylated loci and regions.” <em>Frontiers in Genetics</em> 5 (SEP). Frontiers: 324. <a href="https://doi.org/10.3389/fgene.2014.00324">https://doi.org/10.3389/fgene.2014.00324</a>.</p>
</div>
<div id="ref-Sanchez2016">
<p>Sanchez, Robersy, and Sally A. Mackenzie. 2016. “Information Thermodynamics of Cytosine DNA Methylation.” Edited by Barbara Bardoni. <em>PLOS ONE</em> 11 (3). Public Library of Science: e0150427. <a href="https://doi.org/10.1371/journal.pone.0150427">https://doi.org/10.1371/journal.pone.0150427</a>.</p>
</div>
<div id="ref-Sanchez2019">
<p>Sanchez, Robersy, Xiaodong Yang, Thomas Maher, and Sally Mackenzie. 2019. “Discrimination of DNA Methylation Signal from Background Variation for Clinical Diagnostics.” <em>Int. J. Mol. Sci.</em> 20 (21): 5343. <a href="https://doi.org/https://doi.org/10.3390/ijms20215343">https://doi.org/https://doi.org/10.3390/ijms20215343</a>.</p>
</div>
<div id="ref-Severin2011">
<p>Severin, Philip M D, Xueqing Zou, Hermann E Gaub, and Klaus Schulten. 2011. “Cytosine methylation alters DNA mechanical properties.” <em>Nucleic Acids Research</em> 39 (20): 8740–51. <a href="https://doi.org/10.1093/nar/gkr578">https://doi.org/10.1093/nar/gkr578</a>.</p>
</div>
<div id="ref-Stevens2009">
<p>Stevens, James P. 2009. <em>Applied Multivariate Statistics for the Social Sciences</em>. Fifth Edit. Routledge Academic.</p>
</div>
<div id="ref-Youden1950">
<p>Youden, W. J. 1950. “Index for rating diagnostic tests.” <em>Cancer</em> 3 (1): 32–35. <a href="https://doi.org/10.1002/1097-0142(1950)3:1&lt;32::AID-CNCR2820030106&gt;3.0.CO;2-3">https://doi.org/10.1002/1097-0142(1950)3:1&lt;32::AID-CNCR2820030106&gt;3.0.CO;2-3</a>.</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Robersy Sanchez.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
